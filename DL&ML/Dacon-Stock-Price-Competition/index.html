<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0"/><style data-href="/styles.d53766664f3eaba3db40.css" id="gatsby-global-css">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}*,:after,:before{box-sizing:border-box;border:0 solid #e2e8f0}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-webkit-input-placeholder,textarea::-webkit-input-placeholder{color:#a0aec0}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#a0aec0}input::placeholder,textarea::placeholder{color:#a0aec0}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}</style><meta name="generator" content="Gatsby 2.32.13"/><style type="text/css">
    .toc-header.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .toc-header.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .toc-header svg,
    h2 .toc-header svg,
    h3 .toc-header svg,
    h4 .toc-header svg,
    h5 .toc-header svg,
    h6 .toc-header svg {
      visibility: hidden;
    }
    h1:hover .toc-header svg,
    h2:hover .toc-header svg,
    h3:hover .toc-header svg,
    h4:hover .toc-header svg,
    h5:hover .toc-header svg,
    h6:hover .toc-header svg,
    h1 .toc-header:focus svg,
    h2 .toc-header:focus svg,
    h3 .toc-header:focus svg,
    h4 .toc-header:focus svg,
    h5 .toc-header:focus svg,
    h6 .toc-header:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="icon" href="/favicon-32x32-1c5857f550ca5d27138682501fbd1e0a.png" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#3F4145"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48-1c5857f550ca5d27138682501fbd1e0a.png"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72-1c5857f550ca5d27138682501fbd1e0a.png"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96-1c5857f550ca5d27138682501fbd1e0a.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144-1c5857f550ca5d27138682501fbd1e0a.png"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192-1c5857f550ca5d27138682501fbd1e0a.png"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256-1c5857f550ca5d27138682501fbd1e0a.png"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384-1c5857f550ca5d27138682501fbd1e0a.png"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512-1c5857f550ca5d27138682501fbd1e0a.png"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><title data-react-helmet="true">Using ElasticNetCV for Stock Price Prediction | snoop2head&#x27;s blog</title><meta data-react-helmet="true" name="description" content="Purpose of participation Stock price prediction is pretty distant from the field of my interest, which is NLP. But there are several purpose that I spent time participating in no-reward competition. …"/><meta data-react-helmet="true" property="og:title" content="Using ElasticNetCV for Stock Price Prediction"/><meta data-react-helmet="true" property="og:image" content="/static/social-image-a1864c5d52ffceef83c1d6baedf4493b.png"/><meta data-react-helmet="true" property="og:description" content="Purpose of participation Stock price prediction is pretty distant from the field of my interest, which is NLP. But there are several purpose that I spent time participating in no-reward competition. …"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:image" content="/static/social-image-a1864c5d52ffceef83c1d6baedf4493b.png"/><meta data-react-helmet="true" name="twitter:creator" content="Young Jin Ahn"/><meta data-react-helmet="true" name="twitter:title" content="Using ElasticNetCV for Stock Price Prediction"/><meta data-react-helmet="true" name="twitter:description" content="Purpose of participation Stock price prediction is pretty distant from the field of my interest, which is NLP. But there are several purpose that I spent time participating in no-reward competition. …"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/webpack-runtime-a15e1610686fb2064048.js"/><link as="script" rel="preload" href="/framework-c8d3a5345e3f321d7da5.js"/><link as="script" rel="preload" href="/styles-e8fd4555a67a3390b64e.js"/><link as="script" rel="preload" href="/dc6a8720040df98778fe970bf6c000a41750d3ae-4121d07143daec1f6e61.js"/><link as="script" rel="preload" href="/app-6b37a0275bc86b56e034.js"/><link as="script" rel="preload" href="/d7eeaac4-dcbe97e7a5aa158c9d08.js"/><link as="script" rel="preload" href="/5e2a4920-da90abce4a08c86a094c.js"/><link as="script" rel="preload" href="/1bfc9850-103202d7f810115a42e7.js"/><link as="script" rel="preload" href="/commons-33df4d3f9aa201d0ec4c.js"/><link as="script" rel="preload" href="/b1bda0e5b3305dd279ac60c39e10b0f82af56c10-cca622a04473b7e5e8b2.js"/><link as="script" rel="preload" href="/7a297f752dcfe258c0b0106d89edb3a916af916e-d921dc7587d10ed55da7.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-5f317a7779dd1baa19f9.js"/><link as="fetch" rel="preload" href="/page-data/DL&amp;ML/Dacon-Stock-Price-Competition/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1081905842.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3911196313.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><noscript><style data-emotion-css="1vyo7ug">.css-1vyo7ug{position:fixed;bottom:0;left:0;margin-left:0.5rem;margin-bottom:0.5rem;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;box-shadow:0 1px 3px 0 rgba(0,0,0,0.1),0 1px 2px 0 rgba(0,0,0,0.06);-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:0.25rem;--text-opacity:1;color:rgba(255,255,255,var(--text-opacity));font-size:0.875rem;font-weight:700;padding-left:1rem;padding-right:1rem;padding-top:0.75rem;padding-bottom:0.75rem;background-color:#86a8e7;z-index:9999;}</style><div class="css-1vyo7ug"><style data-emotion-css="5x4yj0">.css-5x4yj0{fill:currentColor;width:1.5rem;height:1.5rem;margin-right:0.5rem;}</style><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 192 512" class="css-5x4yj0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 424.229h20V279.771H20c-11.046 0-20-8.954-20-20V212c0-11.046 8.954-20 20-20h112c11.046 0 20 8.954 20 20v212.229h20c11.046 0 20 8.954 20 20V492c0 11.046-8.954 20-20 20H20c-11.046 0-20-8.954-20-20v-47.771c0-11.046 8.954-20 20-20zM96 0C56.235 0 24 32.235 24 72s32.235 72 72 72 72-32.235 72-72S135.764 0 96 0z"></path></svg><style data-emotion-css="1f2k2gl">.css-1f2k2gl{margin-left:0.5rem;}</style><div class="css-1f2k2gl">Please enable JavaScript to use this site.<br/>JavaScript를 활성화 시켜주세요.</div></div></noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="f6s0ma">.css-f6s0ma{-webkit-transition:all 300ms cubic-bezier(0.4,0,0.2,1);transition:all 300ms cubic-bezier(0.4,0,0.2,1);background-color:#FFFFFF;color:#333333;}</style><style data-emotion-css="acifd">.css-acifd{min-height:100vh;-webkit-transition:all 300ms cubic-bezier(0.4,0,0.2,1);transition:all 300ms cubic-bezier(0.4,0,0.2,1);background-color:#FFFFFF;color:#333333;}</style><div class="css-acifd e60ayux0"><style data-emotion-css="8ezs2g">.css-8ezs2g{min-height:calc(100vh - 100px);}</style><div class="css-8ezs2g"><style data-emotion-css="1yxw6gp">.css-1yxw6gp{background:linear-gradient( 90deg,#7f7fd5,#86a8e7 );}</style><div class="css-1yxw6gp"><style data-emotion-css="1mqm4zt">.css-1mqm4zt{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;max-width:1280px;margin-left:auto;margin-right:auto;padding:1.25rem;}</style><nav class="css-1mqm4zt e1czdvww0"><style data-emotion-css="1usmgm5">.css-1usmgm5{font-size:1.25rem;--text-opacity:1;color:rgba(255,255,255,var(--text-opacity));font-weight:700;}</style><a class="css-1usmgm5" href="/">Young Jin Ahn&#x27;s Blog</a><a aria-label="search page" href="/search"><style data-emotion-css="47445j">.css-47445j{--text-opacity:1;color:rgba(255,255,255,var(--text-opacity));margin-top:auto;margin-bottom:auto;width:2rem;height:2rem;}</style><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="css-47445j" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0 0 11.6 0l43.6-43.5a8.2 8.2 0 0 0 0-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"></path></svg></a></nav></div><style data-emotion-css="aod07n">.css-aod07n{background:linear-gradient( 90deg,#7f7fd5,#86a8e7 );position:fixed;width:100%;box-shadow:0 1px 3px 0 rgba(0,0,0,0.1),0 1px 2px 0 rgba(0,0,0,0.06);z-index:100;-webkit-transition:all 300ms cubic-bezier(0,0,0.2,1);transition:all 300ms cubic-bezier(0,0,0.2,1);top:-100px;}</style><div class="css-aod07n"><nav class="css-1mqm4zt e1czdvww0"><a class="css-1usmgm5" href="/">Young Jin Ahn&#x27;s Blog</a><a aria-label="search page" href="/search"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="css-47445j" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0 0 11.6 0l43.6-43.5a8.2 8.2 0 0 0 0-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"></path></svg></a></nav></div><style data-emotion-css="w27u98">.css-w27u98{margin-top:1rem;padding-left:1rem;padding-right:1rem;}</style><div class="blog-post-container css-w27u98"><div class="blog-post"><style data-emotion-css="1bdwg0l">.css-1bdwg0l{width:100%;max-width:768px;margin-left:auto;margin-right:auto;}</style><div class="css-1bdwg0l eyldt480"><style data-emotion-css="1abxlfd">.css-1abxlfd{font-size:2.25rem;font-weight:700;margin-bottom:1rem;}@media (min-width:768px){.css-1abxlfd{font-size:3rem;}}</style><h1 class="blog-title css-1abxlfd">Using ElasticNetCV for Stock Price Prediction</h1><style data-emotion-css="cpn9zx">.css-cpn9zx{font-size:1rem;margin-bottom:1rem;}</style><h2 class="blog-date css-cpn9zx">2021-09-20</h2><style data-emotion-css="cet0rr">.css-cet0rr{margin-bottom:0.5rem;}</style><div class="blog-tags css-cet0rr"><style data-emotion-css="1ak4bcm">.css-1ak4bcm{white-space:nowrap;-webkit-transition:all 300ms cubic-bezier(0.4,0,0.2,1);transition:all 300ms cubic-bezier(0.4,0,0.2,1);font-size:1rem;font-weight:700;border-radius:9999px;margin-right:0.5rem;margin-top:0.25rem;margin-bottom:0.25rem;padding-top:0.25rem;padding-bottom:0.25rem;padding-left:0.75rem;padding-right:0.75rem;background-color:#edf2f7;color:#3737B9;}</style><button class="css-1ak4bcm">Quant</button><button class="css-1ak4bcm">Competition</button></div><style data-emotion-css="1l4w6pd">.css-1l4w6pd{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}</style><div class="css-1l4w6pd"><style data-emotion-css="yapsbb">.css-yapsbb{border-radius:9999px;width:100%;height:1px;--bg-opacity:1;background-color:rgba(247,250,252,var(--bg-opacity));background:linear-gradient( 270deg,#7f7fd5,#86a8e7,#91eac9 );}</style><div class="css-yapsbb"></div></div></div><div class="blog-content"><style data-emotion-css="19vk1qv">.css-19vk1qv{-webkit-scrollbar-width:thin;-moz-scrollbar-width:thin;-ms-scrollbar-width:thin;scrollbar-width:thin;-webkit-scrollbar-color:gray transparent;-moz-scrollbar-color:gray transparent;-ms-scrollbar-color:gray transparent;scrollbar-color:gray transparent;display:none;}.css-19vk1qv::-webkit-scrollbar{width:4px;}.css-19vk1qv::-webkit-scrollbar-track{background-color:transparent;}.css-19vk1qv::-webkit-scrollbar-thumb{border-radius:9999px;background-color:gray;}.css-19vk1qv::-webkit-scrollbar-button{width:0;height:0;}@media screen and (min-width:1280px){.css-19vk1qv{float:right;position:-webkit-sticky;position:sticky;top:100px;width:calc((100vw - 720px) / 2 - 80px);max-width:250px;margin-right:1rem;overflow:auto;word-break:break-word;max-height:calc(100vh - 200px);fontsize:1rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;border-left-width:4px;border-image:linear-gradient( 180deg,#7f7fd5,#86a8e7,#91eac9 );border-image-slice:1;}}</style><div class="css-19vk1qv"><style data-emotion-css="13af3fo">.css-13af3fo{margin-left:1rem;margin-right:1rem;}</style><div class="css-13af3fo"><style data-emotion-css="17i5xbf">.css-17i5xbf{font-weight:700;margin-bottom:0.5rem;font-size:1.125rem;--text-opacity:1;color:rgba(74,85,104,var(--text-opacity));}</style><h3 class="css-17i5xbf">TOC</h3><style data-emotion-css="1me4zjn">.css-1me4zjn ul{margin-left:0.5rem;}.css-1me4zjn ul > li a:hover{color:#555555;}.css-1me4zjn ul > li a{-webkit-transition:all 300ms cubic-bezier(0.4,0,0.2,1);transition:all 300ms cubic-bezier(0.4,0,0.2,1);--text-opacity:1;color:rgba(160,174,192,var(--text-opacity));font-size:0.875rem;}.css-1me4zjn ul > li a[href=""]{font-size:0.95rem;color:#555555;}</style><div class="css-1me4zjn"><ul>
<li>
<ul>
<li><a href="/DL&#x26;ML/Dacon-Stock-Price-Competition/#purpose-of-participation">Purpose of participation</a></li>
</ul>
</li>
<li>
<p><a href="/DL&#x26;ML/Dacon-Stock-Price-Competition/#using-elasticnetcv-for-stock-price-prediction">Using ElasticNetCV for stock price prediction</a></p>
<ul>
<li><a href="/DL&#x26;ML/Dacon-Stock-Price-Competition/#adding-more-data">Adding more data</a></li>
<li><a href="/DL&#x26;ML/Dacon-Stock-Price-Competition/#choosing-adaquate-model">Choosing Adaquate Model</a></li>
<li><a href="/DL&#x26;ML/Dacon-Stock-Price-Competition/#code-and-outputs">Code and Outputs</a></li>
</ul>
</li>
<li><a href="/DL&#x26;ML/Dacon-Stock-Price-Competition/#check-the-performance-for-sampled-20-companies">Check the performance for sampled 20 companies</a></li>
<li><a href="/DL&#x26;ML/Dacon-Stock-Price-Competition/#%EC%A0%84%EC%B2%B4">전체</a></li>
</ul></div></div></div><div class="css-1bdwg0l eyldt480"><div><style data-emotion-css="c0q8g3">.css-c0q8g3{font-size:1rem;word-break:break-word;}.css-c0q8g3 h1 > a > svg,.css-c0q8g3 h2 > a > svg,.css-c0q8g3 h3 > a > svg,.css-c0q8g3 h4 > a > svg,.css-c0q8g3 h5 > a > svg,.css-c0q8g3 h6 > a > svg{fill:#000;}.css-c0q8g3 h1,.css-c0q8g3 h2{font-size:1.25rem;font-weight:600;margin-top:1.5rem;margin-bottom:1.5rem;}.css-c0q8g3 h3,.css-c0q8g3 h4,.css-c0q8g3 h5,.css-c0q8g3 h6{font-size:1.125rem;margin-top:1.5rem;margin-bottom:1.5rem;font-weight:600;}@media (min-width:640px){.css-c0q8g3 h1,.css-c0q8g3 h2{font-size:1.5rem;}.css-c0q8g3 h3,.css-c0q8g3 h4,.css-c0q8g3 h5,.css-c0q8g3 h6{font-size:1.25rem;}}.css-c0q8g3 a{color:#3737B9;}.css-c0q8g3 a:hover{-webkit-text-decoration:underline;text-decoration:underline;}.css-c0q8g3 p{margin:0.3rem;margin-top:0.75rem;margin-bottom:0.75rem;}.css-c0q8g3 ul,.css-c0q8g3 ol{margin:0.3rem;margin-left:2rem;}.css-c0q8g3 li > p,.css-c0q8g3 li > ul,.css-c0q8g3 li > ol{margin-bottom:0;}.css-c0q8g3 ol{list-style-type:decimal;}.css-c0q8g3 ul{list-style-type:disc;}.css-c0q8g3 blockquote{padding:0.5rem;background-color:#eee;margin:0.3rem;margin-top:0.5rem;margin-bottom:0.5rem;border-left-width:4px;border-color:#86a8e7;}.css-c0q8g3 blockquote > p{margin:0.5rem;}.css-c0q8g3 blockquote > h1,.css-c0q8g3 blockquote > h2,.css-c0q8g3 blockquote > h3,.css-c0q8g3 blockquote > h4,.css-c0q8g3 blockquote > h5{margin-top:0.5rem;margin-bottom:0.5rem;}.css-c0q8g3 td,.css-c0q8g3 th{padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-width:1px;border-color:#86a8e7;}.css-c0q8g3 tr:nth-of-type(even){background-color:#eee;}.css-c0q8g3 th{background-color:#eee;}.css-c0q8g3 table{margin-bottom:1.5rem;display:block;max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content;margin:0 auto;overflow-x:auto;white-space:nowrap;}.css-c0q8g3 p > code,.css-c0q8g3 li > code{padding-top:0.1rem;padding-bottom:0.1rem;padding-right:0.25rem;padding-left:0.25rem;border-radius:0.25rem;color:#3737B9;background-color:#eee;white-space:pre-line;}.css-c0q8g3 pre.grvsc-container{margin-top:24px;margin-bottom:24px;}.css-c0q8g3 hr{margin-top:24px;margin-bottom:24px;height:2px;border:none;background:linear-gradient( 270deg,#7f7fd5,#86a8e7,#91eac9 );}</style><div class="markdown css-c0q8g3"><h3 id="purpose-of-participation" style="position:relative;"><a href="#purpose-of-participation" aria-label="purpose of participation permalink" class="toc-header before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Purpose of participation</h3>
<p>Stock price prediction is pretty distant from the field of my interest, which is NLP.</p>
<p>But there are several purpose that I spent time participating in no-reward competition.</p>
<ul>
<li><strong>Data wrangling practice</strong>: whatever datatype it be, I think it is important to wrangle as many data as possible. It is for the numpy &#x26; pandas practice</li>
<li><strong>Refreshing</strong>: I love studying the field of machine learning and deep learning. Although it is important to study deep enough, I think some refreshment helps the continuity of studying.</li>
<li>
<p><strong>Somehow connected!</strong></p>
<ul>
<li>The usage of cross validation</li>
<li>Markov-chain vs matrix approach</li>
<li>usage of sine, cosine function for timeseries annotation</li>
<li>Regularization at ElasticNet might be also regarded as weight decay.</li>
</ul>
</li>
</ul>
<h2 id="using-elasticnetcv-for-stock-price-prediction" style="position:relative;"><a href="#using-elasticnetcv-for-stock-price-prediction" aria-label="using elasticnetcv for stock price prediction permalink" class="toc-header before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using ElasticNetCV for stock price prediction</h2>
<h3 id="adding-more-data" style="position:relative;"><a href="#adding-more-data" aria-label="adding more data permalink" class="toc-header before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding more data</h3>
<ul>
<li>external data: WTI, NASDAQ, was tested, but it was no good</li>
<li>derivative data: after @SangHoeKim constructed derivative data, I added VWAP and SMI but didn't increase the model's performance</li>
</ul>
<h3 id="choosing-adaquate-model" style="position:relative;"><a href="#choosing-adaquate-model" aria-label="choosing adaquate model permalink" class="toc-header before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Choosing Adaquate Model</h3>
<ul>
<li>When choosing a model, it was important that the model 1) don't fluctuate its performance over periods of time, 2) has higher performance than Linear Regression.</li>
<li>
<p>The original plan was to ensemble 1) time-series forecast model with 2) regression model. Regression model ElasticNetCV turned out to be the best model, but ARIMA model's performance was too overfit for specific periods only to use. For example, ARIMA was good for predicting overall bear market / overall bull market but was bad at predicting fluctuation between the spand of 5 days.</p>
<ul>
<li>ElasticNetCV was the right choice. It was advanced version of Linear Regression, and it has provided K-fold validation structure so that it comparably had more robustness compared to ElasticNet.</li>
<li>ARIMA(0,1,1) showed pretty good performance. This was out of expectation, since (p, q, d) = (0, 1, 1) is just moving average model with constant uprise/downfall of differentiation.</li>
<li>RandomForestRegressor and pmdARIMA was selected since its criteria can be customized as MAE instead of MSE.</li>
<li>pmdARIMA is implementation of AutoARIMA from RStudio, but its performance was too low to use.</li>
</ul>
</li>
<li>XGBoostRegressor turned out to be not good. Not only this was my team's conclusion, but the general consensus over the Dacon community was similar. However @tjy3090 pointed out that XGB captured the turning point and the pattern of the graph, even though its NMAE score was low.</li>
<li>Compared between ffill vs dropna(), but concluded that ffill outperformed on more recend dates.</li>
</ul>
<table>
<thead>
<tr>
<th align="center">Model</th>
<th align="center">NMAE (2021-09-06 ~ 2021-09-10)</th>
<th align="center">NMAE (2021-09-15 ~ 2021-09-24)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">ElasticNetCV</td>
<td align="center">3.02</td>
<td align="center">2.93</td>
</tr>
<tr>
<td align="center">ARIMA(0,1,1)</td>
<td align="center">3.03</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">ElasticNet</td>
<td align="center">3.12</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">XGBoost</td>
<td align="center">3.87</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">Linear Regression</td>
<td align="center">4.03</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">RFRegressor</td>
<td align="center">4.11</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">pmdARIMA</td>
<td align="center">8.81</td>
<td align="center">-</td>
</tr>
</tbody>
</table>
<ul>
<li>Experimented with ARIMA, pmdARIMA, ElasticNetCV, RandomForestRegressor and XGBoost.</li>
<li>Competition's criteria is based on NMAE. Grading criteria function was constructed as following:</li>
</ul>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="0"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk10">def</span><span class="mtk1"> </span><span class="mtk3">NMAE</span><span class="mtk1">(</span><span class="mtk7 mtki">true_df</span><span class="mtk1">, </span><span class="mtk7 mtki">pred_df_input</span><span class="mtk1">):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk6">&quot;&quot;&quot; grading criteria for public leader board &quot;&quot;&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10 mtki">return</span><span class="mtk1"> (</span><span class="mtk8">abs</span><span class="mtk1">(true_df_copy </span><span class="mtk8">-</span><span class="mtk1"> pred_df_input) </span><span class="mtk8">/</span><span class="mtk1"> true_df_copy </span><span class="mtk8">*</span><span class="mtk1"> </span><span class="mtk7">100</span><span class="mtk1">).iloc[:</span><span class="mtk7">5</span><span class="mtk1">].values.</span><span class="mtk3">mean</span><span class="mtk1">()</span></span></span></code></pre>
<ul>
<li>Thanks for setting up grading criteria, the team was able to experiment different kinds of models without being limited by submission quota.</li>
</ul>
<h3 id="code-and-outputs" style="position:relative;"><a href="#code-and-outputs" aria-label="code and outputs permalink" class="toc-header before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Code and Outputs</h3>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="1"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># import python modules</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">import</span><span class="mtk1"> os</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">import</span><span class="mtk1"> copy</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># import data wrangling modules</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">import</span><span class="mtk1"> pandas </span><span class="mtk10 mtki">as</span><span class="mtk1"> pd</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">import</span><span class="mtk1"> numpy </span><span class="mtk10 mtki">as</span><span class="mtk1"> np</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># import visualization modules</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">from</span><span class="mtk1"> tqdm </span><span class="mtk10 mtki">import</span><span class="mtk1"> tqdm</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">import</span><span class="mtk1"> matplotlib.pyplot </span><span class="mtk10 mtki">as</span><span class="mtk1"> plt</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">import</span><span class="mtk1"> seaborn </span><span class="mtk10 mtki">as</span><span class="mtk1"> sns</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># import dataloader &amp; stock data downloader</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">import</span><span class="mtk1"> FinanceDataReader </span><span class="mtk10 mtki">as</span><span class="mtk1"> fdr</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># import machine learning modules</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">from</span><span class="mtk1"> sklearn.preprocessing </span><span class="mtk10 mtki">import</span><span class="mtk1"> MinMaxScaler, RobustScaler, StandardScaler</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">from</span><span class="mtk1"> sklearn.model_selection </span><span class="mtk10 mtki">import</span><span class="mtk1"> train_test_split</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># import machine learning models</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">from</span><span class="mtk1"> sklearn.linear_model </span><span class="mtk10 mtki">import</span><span class="mtk1"> LinearRegression, ElasticNet, ElasticNetCV</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">from</span><span class="mtk1"> xgboost </span><span class="mtk10 mtki">import</span><span class="mtk1"> XGBRegressor</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># import cell output cleaner</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">from</span><span class="mtk1"> IPython.display </span><span class="mtk10 mtki">import</span><span class="mtk1"> clear_output</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># import stock data derivatives module</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">from</span><span class="mtk1"> talib </span><span class="mtk10 mtki">import</span><span class="mtk1"> </span><span class="mtk7">RSI</span><span class="mtk1">, </span><span class="mtk7">BBANDS</span><span class="mtk1">, </span><span class="mtk7">MACD</span><span class="mtk1">, </span><span class="mtk7">ATR</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="2"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">import</span><span class="mtk1"> warnings</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">warnings.</span><span class="mtk3">filterwarnings</span><span class="mtk1">(</span><span class="mtk6">&#39;ignore&#39;</span><span class="mtk1">) </span><span class="mtk5 mtki"># remove warnings from pandas</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="3"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># set options pandas: display more columns and reduced digits of float numbers</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">pd.</span><span class="mtk3">set_option</span><span class="mtk1">(</span><span class="mtk6">&#39;display.max_columns&#39;</span><span class="mtk1">, </span><span class="mtk7">100</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">pd.options.display.float_format </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&#39;</span><span class="mtk7">{</span><span class="mtk10">:.4f</span><span class="mtk7">}</span><span class="mtk6">&#39;</span><span class="mtk1">.format</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="4"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">path </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&#39;./open&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">list_name </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&#39;Stock_List.csv&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">stock_list </span><span class="mtk8">=</span><span class="mtk1"> pd.</span><span class="mtk3">read_csv</span><span class="mtk1">(os.path.</span><span class="mtk3">join</span><span class="mtk1">(path,list_name))</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">stock_list[</span><span class="mtk6">&#39;종목코드&#39;</span><span class="mtk1">] </span><span class="mtk8">=</span><span class="mtk1"> stock_list[</span><span class="mtk6">&#39;종목코드&#39;</span><span class="mtk1">].</span><span class="mtk3">apply</span><span class="mtk1">(</span><span class="mtk10">lambda</span><span class="mtk1"> </span><span class="mtk7 mtki">x</span><span class="mtk1"> : </span><span class="mtk8">str</span><span class="mtk1">(x).</span><span class="mtk3">zfill</span><span class="mtk1">(</span><span class="mtk7">6</span><span class="mtk1">))</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">display</span><span class="mtk1">(stock_list.</span><span class="mtk3">head</span><span class="mtk1">())</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">display</span><span class="mtk1">(stock_list.</span><span class="mtk3">tail</span><span class="mtk1">())</span></span></span></code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre class="grvsc-container one-dark-pro" data-language="" data-index="5"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">.dataframe tbody tr th {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    vertical-align: top;</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">.dataframe thead th {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    text-align: right;</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span></code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목명</th>
      <th>종목코드</th>
      <th>상장시장</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>삼성전자</td>
      <td>005930</td>
      <td>KOSPI</td>
    </tr>
    <tr>
      <th>1</th>
      <td>SK하이닉스</td>
      <td>000660</td>
      <td>KOSPI</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NAVER</td>
      <td>035420</td>
      <td>KOSPI</td>
    </tr>
    <tr>
      <th>3</th>
      <td>카카오</td>
      <td>035720</td>
      <td>KOSPI</td>
    </tr>
    <tr>
      <th>4</th>
      <td>삼성바이오로직스</td>
      <td>207940</td>
      <td>KOSPI</td>
    </tr>
  </tbody>
</table>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre class="grvsc-container one-dark-pro" data-language="" data-index="6"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">.dataframe tbody tr th {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    vertical-align: top;</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">.dataframe thead th {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    text-align: right;</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span></code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목명</th>
      <th>종목코드</th>
      <th>상장시장</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>371</th>
      <td>더네이쳐홀딩스</td>
      <td>298540</td>
      <td>KOSDAQ</td>
    </tr>
    <tr>
      <th>372</th>
      <td>코엔텍</td>
      <td>029960</td>
      <td>KOSDAQ</td>
    </tr>
    <tr>
      <th>373</th>
      <td>원익홀딩스</td>
      <td>030530</td>
      <td>KOSDAQ</td>
    </tr>
    <tr>
      <th>374</th>
      <td>웹케시</td>
      <td>053580</td>
      <td>KOSDAQ</td>
    </tr>
    <tr>
      <th>375</th>
      <td>신흥에스이씨</td>
      <td>243840</td>
      <td>KOSDAQ</td>
    </tr>
  </tbody>
</table>
</div>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="7"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># define dates</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk6">&quot;&quot;&quot; Make dataset for training &amp; evaluation &quot;&quot;&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">from</span><span class="mtk1"> datetime </span><span class="mtk10 mtki">import</span><span class="mtk1"> datetime</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">import</span><span class="mtk1"> os</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># determines whether it is public leaderboard period or new_public period</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">BOOL_PUBLIC_PERIOD</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">False</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># Determines whether to use public way or private way to utilize data</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">BOOL_PUBLIC</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">False</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># set data window range</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">start_date </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">None</span><span class="mtk1"> </span><span class="mtk5 mtki"># if this was set to 2021-01-04, then the mae shoots up to from 3.0 to 4.7</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">today </span><span class="mtk8">=</span><span class="mtk1"> datetime.</span><span class="mtk3">now</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">data_end_date </span><span class="mtk8">=</span><span class="mtk1"> today.</span><span class="mtk3">strftime</span><span class="mtk1">(</span><span class="mtk6">&#39;%Y-%m-</span><span class="mtk7">%d</span><span class="mtk6">&#39;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># public_start_date = &#39;2021-09-10&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">public_start_4th </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&#39;2021-09-06&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">public_end_date </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&#39;2021-09-10&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">check_point </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&#39;2021-09-14&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">recent_known_date </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&#39;2021-09-24&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">private_start_4th </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&#39;2021-09-27&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">private_end_4th </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&#39;2021-10-01&#39;</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="8"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">if</span><span class="mtk1"> </span><span class="mtk7">BOOL_PUBLIC_PERIOD</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    sample_name </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&#39;sample_submission.csv&#39;</span><span class="mtk1"> </span><span class="mtk5 mtki"># week 4 submission</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    pred_df </span><span class="mtk8">=</span><span class="mtk1"> pd.</span><span class="mtk3">read_csv</span><span class="mtk1">(os.path.</span><span class="mtk3">join</span><span class="mtk1">(path,sample_name)).</span><span class="mtk3">set_index</span><span class="mtk1">(</span><span class="mtk6">&#39;Day&#39;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">else</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    new_public_name </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&quot;new_public.csv&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    pred_df </span><span class="mtk8">=</span><span class="mtk1"> pd.</span><span class="mtk3">read_csv</span><span class="mtk1">(os.path.</span><span class="mtk3">join</span><span class="mtk1">(path,new_public_name)).</span><span class="mtk3">set_index</span><span class="mtk1">(</span><span class="mtk6">&#39;Day&#39;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">pred_df</span></span></span></code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre class="grvsc-container one-dark-pro" data-language="" data-index="9"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">.dataframe tbody tr th {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    vertical-align: top;</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">.dataframe thead th {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    text-align: right;</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span></code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>000060</th>
      <th>000080</th>
      <th>000100</th>
      <th>000120</th>
      <th>000150</th>
      <th>000240</th>
      <th>000250</th>
      <th>000270</th>
      <th>000660</th>
      <th>000670</th>
      <th>000720</th>
      <th>000810</th>
      <th>000880</th>
      <th>000990</th>
      <th>001230</th>
      <th>001440</th>
      <th>001450</th>
      <th>001740</th>
      <th>002380</th>
      <th>002790</th>
      <th>003000</th>
      <th>003090</th>
      <th>003380</th>
      <th>003410</th>
      <th>003490</th>
      <th>003670</th>
      <th>003800</th>
      <th>004000</th>
      <th>004020</th>
      <th>004170</th>
      <th>004370</th>
      <th>004490</th>
      <th>004800</th>
      <th>004990</th>
      <th>005250</th>
      <th>005290</th>
      <th>005300</th>
      <th>005380</th>
      <th>005385</th>
      <th>005387</th>
      <th>005490</th>
      <th>005830</th>
      <th>005850</th>
      <th>005930</th>
      <th>005935</th>
      <th>005940</th>
      <th>006260</th>
      <th>006280</th>
      <th>006360</th>
      <th>006400</th>
      <th>...</th>
      <th>253450</th>
      <th>256840</th>
      <th>263720</th>
      <th>263750</th>
      <th>267250</th>
      <th>267980</th>
      <th>268600</th>
      <th>271560</th>
      <th>272210</th>
      <th>272290</th>
      <th>273130</th>
      <th>278280</th>
      <th>278530</th>
      <th>282330</th>
      <th>285130</th>
      <th>287410</th>
      <th>290510</th>
      <th>290650</th>
      <th>292150</th>
      <th>293490</th>
      <th>293780</th>
      <th>294090</th>
      <th>294870</th>
      <th>298000</th>
      <th>298020</th>
      <th>298050</th>
      <th>298380</th>
      <th>298540</th>
      <th>299030</th>
      <th>299660</th>
      <th>299900</th>
      <th>307950</th>
      <th>314130</th>
      <th>316140</th>
      <th>319400</th>
      <th>319660</th>
      <th>321550</th>
      <th>323990</th>
      <th>326030</th>
      <th>330590</th>
      <th>330860</th>
      <th>336260</th>
      <th>336370</th>
      <th>347860</th>
      <th>348150</th>
      <th>348210</th>
      <th>352820</th>
      <th>357780</th>
      <th>363280</th>
      <th>950130</th>
    </tr>
    <tr>
      <th>Day</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-09-15</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-09-16</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-09-17</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-09-23</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-09-24</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-09-27</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-09-28</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-09-29</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-09-30</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-10-01</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 376 columns</p>
</div>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="10"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk6">&quot;&quot;&quot; fill out ground truth stock price of the companies for the public submission period &quot;&quot;&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">if</span><span class="mtk1"> </span><span class="mtk7">BOOL_PUBLIC_PERIOD</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  blank_submission </span><span class="mtk8">=</span><span class="mtk1"> pd.</span><span class="mtk3">read_csv</span><span class="mtk1">(os.path.</span><span class="mtk3">join</span><span class="mtk1">(path,sample_name)).</span><span class="mtk3">set_index</span><span class="mtk1">(</span><span class="mtk6">&#39;Day&#39;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  true_df </span><span class="mtk8">=</span><span class="mtk1"> blank_submission.</span><span class="mtk3">copy</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  true_df_first_day </span><span class="mtk8">=</span><span class="mtk1"> public_start_4th</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  true_df_last_day </span><span class="mtk8">=</span><span class="mtk1"> public_end_date</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">else</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  df_new_public </span><span class="mtk8">=</span><span class="mtk1"> pd.</span><span class="mtk3">read_csv</span><span class="mtk1">(os.path.</span><span class="mtk3">join</span><span class="mtk1">(path,new_public_name)).</span><span class="mtk3">set_index</span><span class="mtk1">(</span><span class="mtk6">&#39;Day&#39;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  true_df </span><span class="mtk8">=</span><span class="mtk1"> df_new_public.</span><span class="mtk3">copy</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  true_df_first_day </span><span class="mtk8">=</span><span class="mtk1"> true_df.iloc[</span><span class="mtk7">0</span><span class="mtk1">].name</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  true_df_last_day </span><span class="mtk8">=</span><span class="mtk1"> true_df.iloc[</span><span class="mtk8">-</span><span class="mtk7">1</span><span class="mtk1">].name</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">print</span><span class="mtk1">(true_df_first_day, true_df_last_day)</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="" data-index="11"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">2021-09-15 2021-10-01</span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="12"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">for</span><span class="mtk1"> company_code </span><span class="mtk10">in</span><span class="mtk1"> </span><span class="mtk3">tqdm</span><span class="mtk1">(true_df.columns):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  data_raw </span><span class="mtk8">=</span><span class="mtk1"> fdr.</span><span class="mtk3">DataReader</span><span class="mtk1">(company_code, </span><span class="mtk4 mtki">start</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> start_date, </span><span class="mtk4 mtki">end</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> private_start_4th).</span><span class="mtk3">reset_index</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  data_raw </span><span class="mtk8">=</span><span class="mtk1"> data_raw.</span><span class="mtk3">drop</span><span class="mtk1">(</span><span class="mtk4 mtki">columns</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> [</span><span class="mtk6">&#39;Change&#39;</span><span class="mtk1">])</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  data_raw </span><span class="mtk8">=</span><span class="mtk1"> data_raw.</span><span class="mtk3">replace</span><span class="mtk1">(</span><span class="mtk7">0</span><span class="mtk1">, np.nan).</span><span class="mtk3">ffill</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  data_raw.index </span><span class="mtk8">=</span><span class="mtk1"> data_raw.Date</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk5 mtki"># print(data_raw.head())</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  public_true_closes </span><span class="mtk8">=</span><span class="mtk1"> data_raw.loc[true_df_first_day:true_df_last_day].Close.iloc[:]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk5 mtki"># print(public_true_closes)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  true_df.loc[:,company_code] </span><span class="mtk8">=</span><span class="mtk1"> public_true_closes.</span><span class="mtk3">to_list</span><span class="mtk1">() </span><span class="mtk8">*</span><span class="mtk1"> </span><span class="mtk7">2</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">true_df.</span><span class="mtk3">head</span><span class="mtk1">()</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="" data-index="13"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">100%|██████████| 376/376 [00:50&lt;00:00,  7.50it/s]</span></span></code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre class="grvsc-container one-dark-pro" data-language="" data-index="14"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">.dataframe tbody tr th {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    vertical-align: top;</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">.dataframe thead th {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    text-align: right;</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span></code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>000060</th>
      <th>000080</th>
      <th>000100</th>
      <th>000120</th>
      <th>000150</th>
      <th>000240</th>
      <th>000250</th>
      <th>000270</th>
      <th>000660</th>
      <th>000670</th>
      <th>000720</th>
      <th>000810</th>
      <th>000880</th>
      <th>000990</th>
      <th>001230</th>
      <th>001440</th>
      <th>001450</th>
      <th>001740</th>
      <th>002380</th>
      <th>002790</th>
      <th>003000</th>
      <th>003090</th>
      <th>003380</th>
      <th>003410</th>
      <th>003490</th>
      <th>003670</th>
      <th>003800</th>
      <th>004000</th>
      <th>004020</th>
      <th>004170</th>
      <th>004370</th>
      <th>004490</th>
      <th>004800</th>
      <th>004990</th>
      <th>005250</th>
      <th>005290</th>
      <th>005300</th>
      <th>005380</th>
      <th>005385</th>
      <th>005387</th>
      <th>005490</th>
      <th>005830</th>
      <th>005850</th>
      <th>005930</th>
      <th>005935</th>
      <th>005940</th>
      <th>006260</th>
      <th>006280</th>
      <th>006360</th>
      <th>006400</th>
      <th>...</th>
      <th>253450</th>
      <th>256840</th>
      <th>263720</th>
      <th>263750</th>
      <th>267250</th>
      <th>267980</th>
      <th>268600</th>
      <th>271560</th>
      <th>272210</th>
      <th>272290</th>
      <th>273130</th>
      <th>278280</th>
      <th>278530</th>
      <th>282330</th>
      <th>285130</th>
      <th>287410</th>
      <th>290510</th>
      <th>290650</th>
      <th>292150</th>
      <th>293490</th>
      <th>293780</th>
      <th>294090</th>
      <th>294870</th>
      <th>298000</th>
      <th>298020</th>
      <th>298050</th>
      <th>298380</th>
      <th>298540</th>
      <th>299030</th>
      <th>299660</th>
      <th>299900</th>
      <th>307950</th>
      <th>314130</th>
      <th>316140</th>
      <th>319400</th>
      <th>319660</th>
      <th>321550</th>
      <th>323990</th>
      <th>326030</th>
      <th>330590</th>
      <th>330860</th>
      <th>336260</th>
      <th>336370</th>
      <th>347860</th>
      <th>348150</th>
      <th>348210</th>
      <th>352820</th>
      <th>357780</th>
      <th>363280</th>
      <th>950130</th>
    </tr>
    <tr>
      <th>Day</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-09-15</th>
      <td>30400</td>
      <td>34700</td>
      <td>65400</td>
      <td>170500</td>
      <td>96600</td>
      <td>16800</td>
      <td>51800</td>
      <td>83300</td>
      <td>107500</td>
      <td>728000</td>
      <td>54600</td>
      <td>232000</td>
      <td>35400</td>
      <td>58500</td>
      <td>20050</td>
      <td>2770</td>
      <td>25300</td>
      <td>5470</td>
      <td>455500</td>
      <td>53200</td>
      <td>21550</td>
      <td>36200</td>
      <td>9630</td>
      <td>8480</td>
      <td>32550</td>
      <td>161500</td>
      <td>50900</td>
      <td>90500</td>
      <td>52000</td>
      <td>275000</td>
      <td>294000</td>
      <td>90600</td>
      <td>122500</td>
      <td>35400</td>
      <td>32800</td>
      <td>28350</td>
      <td>151500</td>
      <td>209500</td>
      <td>102500</td>
      <td>99700</td>
      <td>361500</td>
      <td>61800</td>
      <td>28500</td>
      <td>77000</td>
      <td>71800</td>
      <td>13400</td>
      <td>68000</td>
      <td>363000</td>
      <td>45000</td>
      <td>750000</td>
      <td>...</td>
      <td>83100</td>
      <td>43100</td>
      <td>40500</td>
      <td>84300</td>
      <td>68600</td>
      <td>73900</td>
      <td>64100</td>
      <td>129500</td>
      <td>18800</td>
      <td>39000</td>
      <td>109300</td>
      <td>279500</td>
      <td>13545</td>
      <td>179500</td>
      <td>298500</td>
      <td>7900</td>
      <td>7840</td>
      <td>38350</td>
      <td>13910</td>
      <td>72400</td>
      <td>51000</td>
      <td>52900</td>
      <td>28450</td>
      <td>401500</td>
      <td>748000</td>
      <td>753000</td>
      <td>19600</td>
      <td>32950</td>
      <td>62400</td>
      <td>108000</td>
      <td>16300</td>
      <td>107500</td>
      <td>43800</td>
      <td>11000</td>
      <td>3505</td>
      <td>35750</td>
      <td>20000</td>
      <td>78300</td>
      <td>113000</td>
      <td>5570</td>
      <td>47600</td>
      <td>51000</td>
      <td>65700</td>
      <td>33550</td>
      <td>29850</td>
      <td>59600</td>
      <td>279500</td>
      <td>302700</td>
      <td>28250</td>
      <td>17450</td>
    </tr>
    <tr>
      <th>2021-09-16</th>
      <td>30600</td>
      <td>34700</td>
      <td>64800</td>
      <td>168000</td>
      <td>102000</td>
      <td>16800</td>
      <td>50900</td>
      <td>84500</td>
      <td>104000</td>
      <td>718000</td>
      <td>55700</td>
      <td>227000</td>
      <td>35300</td>
      <td>56700</td>
      <td>20500</td>
      <td>2705</td>
      <td>24900</td>
      <td>5450</td>
      <td>458000</td>
      <td>52600</td>
      <td>21200</td>
      <td>34900</td>
      <td>9540</td>
      <td>8460</td>
      <td>32100</td>
      <td>163000</td>
      <td>51000</td>
      <td>91300</td>
      <td>51600</td>
      <td>271500</td>
      <td>293000</td>
      <td>90300</td>
      <td>124500</td>
      <td>35000</td>
      <td>32650</td>
      <td>29450</td>
      <td>151500</td>
      <td>208000</td>
      <td>102500</td>
      <td>99800</td>
      <td>364500</td>
      <td>61400</td>
      <td>27800</td>
      <td>76100</td>
      <td>71500</td>
      <td>13250</td>
      <td>68500</td>
      <td>365000</td>
      <td>46100</td>
      <td>725000</td>
      <td>...</td>
      <td>82300</td>
      <td>43600</td>
      <td>40500</td>
      <td>82000</td>
      <td>69800</td>
      <td>73300</td>
      <td>60500</td>
      <td>125000</td>
      <td>18850</td>
      <td>38900</td>
      <td>109365</td>
      <td>276300</td>
      <td>13425</td>
      <td>174500</td>
      <td>297500</td>
      <td>7760</td>
      <td>7680</td>
      <td>39700</td>
      <td>13745</td>
      <td>71300</td>
      <td>49750</td>
      <td>53000</td>
      <td>28850</td>
      <td>419500</td>
      <td>756000</td>
      <td>777000</td>
      <td>19400</td>
      <td>32600</td>
      <td>61900</td>
      <td>113500</td>
      <td>16150</td>
      <td>109000</td>
      <td>46800</td>
      <td>11000</td>
      <td>3515</td>
      <td>35000</td>
      <td>19850</td>
      <td>80300</td>
      <td>114000</td>
      <td>5530</td>
      <td>47400</td>
      <td>51100</td>
      <td>66000</td>
      <td>33200</td>
      <td>30150</td>
      <td>58400</td>
      <td>276500</td>
      <td>294700</td>
      <td>28150</td>
      <td>16850</td>
    </tr>
    <tr>
      <th>2021-09-17</th>
      <td>30350</td>
      <td>34050</td>
      <td>64500</td>
      <td>169000</td>
      <td>100000</td>
      <td>16550</td>
      <td>51700</td>
      <td>84100</td>
      <td>107000</td>
      <td>718000</td>
      <td>56200</td>
      <td>227500</td>
      <td>35050</td>
      <td>57600</td>
      <td>19950</td>
      <td>2665</td>
      <td>24750</td>
      <td>5350</td>
      <td>454000</td>
      <td>53100</td>
      <td>21100</td>
      <td>34950</td>
      <td>9570</td>
      <td>8350</td>
      <td>32950</td>
      <td>161000</td>
      <td>50900</td>
      <td>91100</td>
      <td>51500</td>
      <td>271000</td>
      <td>290000</td>
      <td>89500</td>
      <td>123000</td>
      <td>34750</td>
      <td>32950</td>
      <td>30950</td>
      <td>149000</td>
      <td>209000</td>
      <td>99600</td>
      <td>97500</td>
      <td>362500</td>
      <td>60800</td>
      <td>27600</td>
      <td>77200</td>
      <td>71800</td>
      <td>13400</td>
      <td>67400</td>
      <td>358500</td>
      <td>46150</td>
      <td>725000</td>
      <td>...</td>
      <td>82500</td>
      <td>49750</td>
      <td>39950</td>
      <td>82400</td>
      <td>65300</td>
      <td>72400</td>
      <td>61500</td>
      <td>126000</td>
      <td>19200</td>
      <td>39450</td>
      <td>109225</td>
      <td>269400</td>
      <td>13435</td>
      <td>175000</td>
      <td>288000</td>
      <td>7700</td>
      <td>7700</td>
      <td>39550</td>
      <td>13835</td>
      <td>72200</td>
      <td>50600</td>
      <td>53900</td>
      <td>28600</td>
      <td>423000</td>
      <td>733000</td>
      <td>810000</td>
      <td>19500</td>
      <td>32450</td>
      <td>61800</td>
      <td>118000</td>
      <td>16300</td>
      <td>108000</td>
      <td>46950</td>
      <td>11050</td>
      <td>3505</td>
      <td>38300</td>
      <td>19900</td>
      <td>80900</td>
      <td>113500</td>
      <td>5560</td>
      <td>47900</td>
      <td>50500</td>
      <td>65100</td>
      <td>33050</td>
      <td>30150</td>
      <td>59500</td>
      <td>276500</td>
      <td>296900</td>
      <td>28050</td>
      <td>17300</td>
    </tr>
    <tr>
      <th>2021-09-23</th>
      <td>30100</td>
      <td>33700</td>
      <td>63700</td>
      <td>167500</td>
      <td>100500</td>
      <td>16200</td>
      <td>51600</td>
      <td>84200</td>
      <td>105500</td>
      <td>699000</td>
      <td>54600</td>
      <td>227500</td>
      <td>34950</td>
      <td>56900</td>
      <td>19000</td>
      <td>2580</td>
      <td>24850</td>
      <td>5300</td>
      <td>443500</td>
      <td>51700</td>
      <td>20800</td>
      <td>34950</td>
      <td>9560</td>
      <td>8330</td>
      <td>34200</td>
      <td>158000</td>
      <td>51100</td>
      <td>94100</td>
      <td>48750</td>
      <td>269500</td>
      <td>289000</td>
      <td>87200</td>
      <td>122000</td>
      <td>34550</td>
      <td>32750</td>
      <td>30950</td>
      <td>149000</td>
      <td>208500</td>
      <td>100000</td>
      <td>98300</td>
      <td>346500</td>
      <td>63000</td>
      <td>27150</td>
      <td>77400</td>
      <td>71800</td>
      <td>13250</td>
      <td>66300</td>
      <td>354500</td>
      <td>44950</td>
      <td>731000</td>
      <td>...</td>
      <td>84100</td>
      <td>52800</td>
      <td>38700</td>
      <td>82200</td>
      <td>64400</td>
      <td>73100</td>
      <td>59000</td>
      <td>124000</td>
      <td>19000</td>
      <td>41150</td>
      <td>109125</td>
      <td>268000</td>
      <td>13410</td>
      <td>171500</td>
      <td>289500</td>
      <td>7270</td>
      <td>7590</td>
      <td>38500</td>
      <td>13850</td>
      <td>68900</td>
      <td>45900</td>
      <td>52600</td>
      <td>28050</td>
      <td>400500</td>
      <td>712000</td>
      <td>799000</td>
      <td>20200</td>
      <td>31450</td>
      <td>60500</td>
      <td>118000</td>
      <td>16800</td>
      <td>107000</td>
      <td>44850</td>
      <td>11100</td>
      <td>3395</td>
      <td>36800</td>
      <td>19100</td>
      <td>79700</td>
      <td>109500</td>
      <td>5550</td>
      <td>46750</td>
      <td>50100</td>
      <td>65400</td>
      <td>32000</td>
      <td>29250</td>
      <td>56800</td>
      <td>270500</td>
      <td>290100</td>
      <td>28150</td>
      <td>20450</td>
    </tr>
    <tr>
      <th>2021-09-24</th>
      <td>29600</td>
      <td>33400</td>
      <td>62900</td>
      <td>166500</td>
      <td>97000</td>
      <td>16300</td>
      <td>51100</td>
      <td>82600</td>
      <td>104000</td>
      <td>696000</td>
      <td>53200</td>
      <td>228500</td>
      <td>34650</td>
      <td>56700</td>
      <td>18700</td>
      <td>2525</td>
      <td>25000</td>
      <td>5300</td>
      <td>455000</td>
      <td>50800</td>
      <td>20450</td>
      <td>34300</td>
      <td>9540</td>
      <td>8250</td>
      <td>34250</td>
      <td>162000</td>
      <td>49350</td>
      <td>93000</td>
      <td>48650</td>
      <td>272000</td>
      <td>289500</td>
      <td>85400</td>
      <td>122500</td>
      <td>34600</td>
      <td>31950</td>
      <td>31000</td>
      <td>149000</td>
      <td>207000</td>
      <td>99500</td>
      <td>98200</td>
      <td>345000</td>
      <td>62700</td>
      <td>27700</td>
      <td>77300</td>
      <td>71700</td>
      <td>13150</td>
      <td>66100</td>
      <td>344500</td>
      <td>44400</td>
      <td>726000</td>
      <td>...</td>
      <td>85100</td>
      <td>54500</td>
      <td>40950</td>
      <td>87400</td>
      <td>64100</td>
      <td>72900</td>
      <td>59000</td>
      <td>122000</td>
      <td>18500</td>
      <td>41300</td>
      <td>108840</td>
      <td>272900</td>
      <td>13435</td>
      <td>172500</td>
      <td>283000</td>
      <td>7780</td>
      <td>7530</td>
      <td>38950</td>
      <td>13825</td>
      <td>68300</td>
      <td>45400</td>
      <td>51500</td>
      <td>28000</td>
      <td>400500</td>
      <td>713000</td>
      <td>860000</td>
      <td>19800</td>
      <td>31500</td>
      <td>60700</td>
      <td>110900</td>
      <td>16650</td>
      <td>105500</td>
      <td>45050</td>
      <td>11150</td>
      <td>3430</td>
      <td>36900</td>
      <td>18800</td>
      <td>76700</td>
      <td>107000</td>
      <td>5530</td>
      <td>46700</td>
      <td>49050</td>
      <td>67600</td>
      <td>31700</td>
      <td>29050</td>
      <td>56900</td>
      <td>268000</td>
      <td>291000</td>
      <td>28600</td>
      <td>20050</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 376 columns</p>
</div>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="15"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk10">def</span><span class="mtk1"> </span><span class="mtk3">makeData</span><span class="mtk1">(</span><span class="mtk7 mtki">data</span><span class="mtk1">):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk6">&quot;&quot;&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk6">    - make derivative data from the fdr dataset</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk6">    - not using external dataset which increases noise that harms the performance</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk6">    &quot;&quot;&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    data </span><span class="mtk8">=</span><span class="mtk1"> data.</span><span class="mtk3">copy</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5 mtki"># Korean won volume</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    data[</span><span class="mtk6">&#39;KRW_Vol&#39;</span><span class="mtk1">] </span><span class="mtk8">=</span><span class="mtk1"> data[[</span><span class="mtk6">&#39;Close&#39;</span><span class="mtk1">, </span><span class="mtk6">&#39;Volume&#39;</span><span class="mtk1">]].</span><span class="mtk3">prod</span><span class="mtk1">(</span><span class="mtk4 mtki">axis</span><span class="mtk8">=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    data[</span><span class="mtk6">&#39;KRW_Vol_1m&#39;</span><span class="mtk1">] </span><span class="mtk8">=</span><span class="mtk1"> data.</span><span class="mtk7">KRW_Vol</span><span class="mtk1">.</span><span class="mtk3">rolling</span><span class="mtk1">(</span><span class="mtk7">21</span><span class="mtk1">).</span><span class="mtk3">mean</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5 mtki"># RSI</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    data[</span><span class="mtk6">&#39;RSI&#39;</span><span class="mtk1">] </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">RSI</span><span class="mtk1">(data.Close)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5 mtki"># Bollinger Bands</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10">def</span><span class="mtk1"> </span><span class="mtk3">compute_bb</span><span class="mtk1">(</span><span class="mtk7 mtki">close</span><span class="mtk1">):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        high, mid, low </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">BBANDS</span><span class="mtk1">(close, </span><span class="mtk4 mtki">timeperiod</span><span class="mtk8">=</span><span class="mtk7">20</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10 mtki">return</span><span class="mtk1"> pd.</span><span class="mtk3">DataFrame</span><span class="mtk1">({</span><span class="mtk6">&#39;bb_high&#39;</span><span class="mtk1">: high, </span><span class="mtk6">&#39;bb_low&#39;</span><span class="mtk1">: low}, </span><span class="mtk4 mtki">index</span><span class="mtk8">=</span><span class="mtk1">close.index)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    data[[</span><span class="mtk6">&#39;bb_high&#39;</span><span class="mtk1">, </span><span class="mtk6">&#39;bb_low&#39;</span><span class="mtk1">]] </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">compute_bb</span><span class="mtk1">(data.Close)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    data[</span><span class="mtk6">&#39;bb_high&#39;</span><span class="mtk1">] </span><span class="mtk8">=</span><span class="mtk1"> data.bb_high.</span><span class="mtk3">sub</span><span class="mtk1">(data.Close).</span><span class="mtk3">div</span><span class="mtk1">(data.bb_high).</span><span class="mtk3">apply</span><span class="mtk1">(np.log1p)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    data[</span><span class="mtk6">&#39;bb_low&#39;</span><span class="mtk1">] </span><span class="mtk8">=</span><span class="mtk1"> data.Close.</span><span class="mtk3">sub</span><span class="mtk1">(data.bb_low).</span><span class="mtk3">div</span><span class="mtk1">(data.Close).</span><span class="mtk3">apply</span><span class="mtk1">(np.log1p)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5 mtki"># ATR</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10">def</span><span class="mtk1"> </span><span class="mtk3">compute_atr</span><span class="mtk1">(</span><span class="mtk7 mtki">stock_data</span><span class="mtk1">):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        df </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">ATR</span><span class="mtk1">(stock_data.High, stock_data.Low,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                 stock_data.Close, </span><span class="mtk4 mtki">timeperiod</span><span class="mtk8">=</span><span class="mtk7">14</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10 mtki">return</span><span class="mtk1"> df.</span><span class="mtk3">sub</span><span class="mtk1">(df.</span><span class="mtk3">mean</span><span class="mtk1">()).</span><span class="mtk3">div</span><span class="mtk1">(df.</span><span class="mtk3">std</span><span class="mtk1">())</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    data[</span><span class="mtk6">&#39;ATR&#39;</span><span class="mtk1">] </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">compute_atr</span><span class="mtk1">(data)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5 mtki">#MACD</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10">def</span><span class="mtk1"> </span><span class="mtk3">compute_macd</span><span class="mtk1">(</span><span class="mtk7 mtki">close</span><span class="mtk1">):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        macd </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">MACD</span><span class="mtk1">(close)[</span><span class="mtk7">0</span><span class="mtk1">]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10 mtki">return</span><span class="mtk1"> (macd </span><span class="mtk8">-</span><span class="mtk1"> np.</span><span class="mtk3">mean</span><span class="mtk1">(macd))</span><span class="mtk8">/</span><span class="mtk1">np.</span><span class="mtk3">std</span><span class="mtk1">(macd)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    data[</span><span class="mtk6">&#39;MACD&#39;</span><span class="mtk1">] </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">compute_macd</span><span class="mtk1">(data.Close)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5 mtki"># Lagged Returns</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    lags </span><span class="mtk8">=</span><span class="mtk1"> [</span><span class="mtk7">1</span><span class="mtk1">, </span><span class="mtk7">2</span><span class="mtk1">, </span><span class="mtk7">3</span><span class="mtk1">, </span><span class="mtk7">4</span><span class="mtk1">, </span><span class="mtk7">5</span><span class="mtk1">, </span><span class="mtk7">10</span><span class="mtk1">, </span><span class="mtk7">21</span><span class="mtk1">, </span><span class="mtk7">42</span><span class="mtk1">, </span><span class="mtk7">63</span><span class="mtk1">]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10 mtki">for</span><span class="mtk1"> lag </span><span class="mtk10">in</span><span class="mtk1"> lags:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        data[</span><span class="mtk10">f</span><span class="mtk6">&#39;return_</span><span class="mtk7">{</span><span class="mtk1">lag</span><span class="mtk7">}</span><span class="mtk6">d&#39;</span><span class="mtk1">] </span><span class="mtk8">=</span><span class="mtk1"> data.Close.</span><span class="mtk3">pct_change</span><span class="mtk1">(lag).</span><span class="mtk3">add</span><span class="mtk1">(</span><span class="mtk7">1</span><span class="mtk1">).</span><span class="mtk3">pow</span><span class="mtk1">(</span><span class="mtk7">1</span><span class="mtk1"> </span><span class="mtk8">/</span><span class="mtk1"> lag).</span><span class="mtk3">sub</span><span class="mtk1">(</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10 mtki">for</span><span class="mtk1"> t </span><span class="mtk10">in</span><span class="mtk1"> [</span><span class="mtk7">1</span><span class="mtk1">, </span><span class="mtk7">2</span><span class="mtk1">, </span><span class="mtk7">3</span><span class="mtk1">, </span><span class="mtk7">4</span><span class="mtk1">, </span><span class="mtk7">5</span><span class="mtk1">]:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10 mtki">for</span><span class="mtk1"> lag </span><span class="mtk10">in</span><span class="mtk1"> [</span><span class="mtk7">1</span><span class="mtk1">, </span><span class="mtk7">5</span><span class="mtk1">, </span><span class="mtk7">10</span><span class="mtk1">, </span><span class="mtk7">21</span><span class="mtk1">]:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            data[</span><span class="mtk10">f</span><span class="mtk6">&#39;return_</span><span class="mtk7">{</span><span class="mtk1">lag</span><span class="mtk7">}</span><span class="mtk6">d_lag</span><span class="mtk7">{</span><span class="mtk1">t</span><span class="mtk7">}</span><span class="mtk6">&#39;</span><span class="mtk1">] </span><span class="mtk8">=</span><span class="mtk1"> data[</span><span class="mtk10">f</span><span class="mtk6">&#39;return_</span><span class="mtk7">{</span><span class="mtk1">lag</span><span class="mtk7">}</span><span class="mtk6">d&#39;</span><span class="mtk1">].</span><span class="mtk3">shift</span><span class="mtk1">(t </span><span class="mtk8">*</span><span class="mtk1"> lag)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5 mtki"># target return</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10 mtki">for</span><span class="mtk1"> t </span><span class="mtk10">in</span><span class="mtk1"> [</span><span class="mtk7">1</span><span class="mtk1">, </span><span class="mtk7">2</span><span class="mtk1">, </span><span class="mtk7">3</span><span class="mtk1">, </span><span class="mtk7">4</span><span class="mtk1">, </span><span class="mtk7">5</span><span class="mtk1">]:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        data[</span><span class="mtk10">f</span><span class="mtk6">&#39;target_</span><span class="mtk7">{</span><span class="mtk1">t</span><span class="mtk7">}</span><span class="mtk6">d&#39;</span><span class="mtk1">] </span><span class="mtk8">=</span><span class="mtk1"> data[</span><span class="mtk10">f</span><span class="mtk6">&#39;return_</span><span class="mtk7">{</span><span class="mtk1">t</span><span class="mtk7">}</span><span class="mtk6">d&#39;</span><span class="mtk1">].</span><span class="mtk3">shift</span><span class="mtk1">(</span><span class="mtk8">-</span><span class="mtk1">t)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5 mtki"># volume change</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    q </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">0.01</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    data[data.</span><span class="mtk3">filter</span><span class="mtk1">(</span><span class="mtk4 mtki">like</span><span class="mtk8">=</span><span class="mtk6">&#39;Vol&#39;</span><span class="mtk1">).columns] </span><span class="mtk8">=</span><span class="mtk1"> data.</span><span class="mtk3">filter</span><span class="mtk1">(</span><span class="mtk4 mtki">like</span><span class="mtk8">=</span><span class="mtk6">&#39;Vol&#39;</span><span class="mtk1">).</span><span class="mtk3">pct_change</span><span class="mtk1">().</span><span class="mtk3">apply</span><span class="mtk1">(</span><span class="mtk10">lambda</span><span class="mtk1"> </span><span class="mtk7 mtki">x</span><span class="mtk1">: x.</span><span class="mtk3">clip</span><span class="mtk1">(</span><span class="mtk4 mtki">lower</span><span class="mtk8">=</span><span class="mtk1">x.</span><span class="mtk3">quantile</span><span class="mtk1">(q),</span><span class="mtk4 mtki">upper</span><span class="mtk8">=</span><span class="mtk1">x.</span><span class="mtk3">quantile</span><span class="mtk1">(</span><span class="mtk7">1</span><span class="mtk1"> </span><span class="mtk8">-</span><span class="mtk1"> q)))</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    data </span><span class="mtk8">=</span><span class="mtk1"> data.</span><span class="mtk3">drop</span><span class="mtk1">([</span><span class="mtk6">&#39;Date&#39;</span><span class="mtk1">, </span><span class="mtk6">&#39;Open&#39;</span><span class="mtk1">, </span><span class="mtk6">&#39;High&#39;</span><span class="mtk1">, </span><span class="mtk6">&#39;Low&#39;</span><span class="mtk1">, </span><span class="mtk6">&#39;Close&#39;</span><span class="mtk1">], </span><span class="mtk4 mtki">axis</span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">1</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    data </span><span class="mtk8">=</span><span class="mtk1"> data.</span><span class="mtk3">fillna</span><span class="mtk1">(</span><span class="mtk4 mtki">method</span><span class="mtk8">=</span><span class="mtk6">&quot;ffill&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    data </span><span class="mtk8">=</span><span class="mtk1"> data.</span><span class="mtk3">fillna</span><span class="mtk1">(</span><span class="mtk4 mtki">method</span><span class="mtk8">=</span><span class="mtk6">&quot;bfill&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5 mtki"># display(data.tail())</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10 mtki">return</span><span class="mtk1"> data</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="16"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk10">def</span><span class="mtk1"> </span><span class="mtk3">mape</span><span class="mtk1">(</span><span class="mtk7 mtki">true_df</span><span class="mtk1">, </span><span class="mtk7 mtki">pred_df_input</span><span class="mtk1">):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk6">&quot;&quot;&quot; grading criteria for public leader board &quot;&quot;&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5 mtki"># extract columns from true_df same as pred_df_input</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    true_df_copy </span><span class="mtk8">=</span><span class="mtk1"> true_df.</span><span class="mtk3">copy</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    true_df_copy </span><span class="mtk8">=</span><span class="mtk1"> true_df_copy.loc[:, pred_df_input.columns]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    true_df_copy </span><span class="mtk8">=</span><span class="mtk1"> true_df_copy.iloc[:</span><span class="mtk7">5</span><span class="mtk1">]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    pred_df_input </span><span class="mtk8">=</span><span class="mtk1"> pred_df_input.iloc[:</span><span class="mtk7">5</span><span class="mtk1">]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10 mtki">return</span><span class="mtk1"> (</span><span class="mtk8">abs</span><span class="mtk1">(true_df_copy </span><span class="mtk8">-</span><span class="mtk1"> pred_df_input) </span><span class="mtk8">/</span><span class="mtk1"> true_df_copy </span><span class="mtk8">*</span><span class="mtk1"> </span><span class="mtk7">100</span><span class="mtk1">).iloc[:</span><span class="mtk7">5</span><span class="mtk1">].values.</span><span class="mtk3">mean</span><span class="mtk1">()</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="17"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk10">def</span><span class="mtk1"> </span><span class="mtk3">sklearn_predict</span><span class="mtk1">(</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7 mtki">pred_df_input</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7 mtki">model</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7 mtki">bool_public</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7 mtki">start_date</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7 mtki">recent_known_date</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7 mtki">clip</span><span class="mtk1">=</span><span class="mtk7">True</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7 mtki">scaler</span><span class="mtk1">=</span><span class="mtk3">RobustScaler</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    ):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk6">&quot;&quot;&quot; make prediction dataframe &quot;&quot;&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10 mtki">if</span><span class="mtk1"> bool_public:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk5 mtki"># get first five rows of pred_df_input</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        pred_df_input </span><span class="mtk8">=</span><span class="mtk1"> pred_df_input.iloc[:</span><span class="mtk7">5</span><span class="mtk1">]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10 mtki">else</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk5 mtki"># dropping first 5 days of public dates from the submission dataframe</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        pred_df_input </span><span class="mtk8">=</span><span class="mtk1"> pred_df_input.iloc[</span><span class="mtk7">5</span><span class="mtk1">:]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10 mtki">for</span><span class="mtk1"> company_code </span><span class="mtk10">in</span><span class="mtk1"> </span><span class="mtk3">tqdm</span><span class="mtk1">(pred_df_input.columns):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk5 mtki"># clear_output()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        data_raw </span><span class="mtk8">=</span><span class="mtk1"> fdr.</span><span class="mtk3">DataReader</span><span class="mtk1">(</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            company_code,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk4 mtki">start</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> start_date,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk4 mtki">end</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> recent_known_date</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            ).</span><span class="mtk3">reset_index</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        data_raw </span><span class="mtk8">=</span><span class="mtk1"> data_raw.</span><span class="mtk3">drop</span><span class="mtk1">(</span><span class="mtk4 mtki">columns</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&#39;Change&#39;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        data_raw </span><span class="mtk8">=</span><span class="mtk1"> data_raw.</span><span class="mtk3">replace</span><span class="mtk1">(</span><span class="mtk7">0</span><span class="mtk1">, np.nan).</span><span class="mtk3">ffill</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        data_raw.index </span><span class="mtk8">=</span><span class="mtk1"> data_raw.Date</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk5 mtki"># clear_output() # clear output for the jupyter notebook</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10 mtki">if</span><span class="mtk1"> bool_public: </span><span class="mtk5 mtki"># if public submission</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># make necessary data for the prediction</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            data </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">makeData</span><span class="mtk1">(data_raw)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># get the last date of the public submission period</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            public_last_close </span><span class="mtk8">=</span><span class="mtk1"> data_raw.loc[recent_known_date].Close</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            public </span><span class="mtk8">=</span><span class="mtk1"> data.loc[[recent_known_date]]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># loc[] is inclusive for the end slicing date, unlike list slicing</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            train_indv_comp </span><span class="mtk8">=</span><span class="mtk1"> data.loc[:recent_known_date]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            Ys </span><span class="mtk8">=</span><span class="mtk1"> train_indv_comp.</span><span class="mtk3">filter</span><span class="mtk1">(</span><span class="mtk4 mtki">like</span><span class="mtk8">=</span><span class="mtk6">&#39;target&#39;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            X </span><span class="mtk8">=</span><span class="mtk1"> train_indv_comp.</span><span class="mtk3">drop</span><span class="mtk1">(Ys.columns, </span><span class="mtk4 mtki">axis</span><span class="mtk8">=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            Ys_public </span><span class="mtk8">=</span><span class="mtk1"> public.</span><span class="mtk3">filter</span><span class="mtk1">(</span><span class="mtk4 mtki">like</span><span class="mtk8">=</span><span class="mtk6">&#39;target&#39;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            X_public </span><span class="mtk8">=</span><span class="mtk1"> public.</span><span class="mtk3">drop</span><span class="mtk1">(Ys_public.columns, </span><span class="mtk4 mtki">axis</span><span class="mtk8">=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            X </span><span class="mtk8">=</span><span class="mtk1"> scaler.</span><span class="mtk3">fit_transform</span><span class="mtk1">(X)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            X_public </span><span class="mtk8">=</span><span class="mtk1"> scaler.</span><span class="mtk3">transform</span><span class="mtk1">(X_public)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            pred_public </span><span class="mtk8">=</span><span class="mtk1"> []</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            public_close </span><span class="mtk8">=</span><span class="mtk1"> public_last_close</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk10 mtki">for</span><span class="mtk1"> y_col </span><span class="mtk10">in</span><span class="mtk1"> Ys.columns:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                model.</span><span class="mtk3">fit</span><span class="mtk1">(X, Ys[y_col])</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                r_pred_public </span><span class="mtk8">=</span><span class="mtk1"> model.</span><span class="mtk3">predict</span><span class="mtk1">(X_public)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                public_close </span><span class="mtk8">=</span><span class="mtk1"> public_close </span><span class="mtk8">*</span><span class="mtk1"> (</span><span class="mtk7">1</span><span class="mtk8">+</span><span class="mtk1">r_pred_public[</span><span class="mtk7">0</span><span class="mtk1">])</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                pred_public.</span><span class="mtk3">append</span><span class="mtk1">(public_close)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># print(pred_df_input.shape)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># display(pred_df_input)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            pred_df_input.loc[:,company_code] </span><span class="mtk8">=</span><span class="mtk1"> pred_public</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10 mtki">else</span><span class="mtk1">: </span><span class="mtk5 mtki"># if private submission</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            data </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">makeData</span><span class="mtk1">(data_raw)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># display(pred_df_input)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            private_last_close </span><span class="mtk8">=</span><span class="mtk1"> data_raw.loc[recent_known_date].Close</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># display(data)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            private </span><span class="mtk8">=</span><span class="mtk1"> data.loc[[recent_known_date]]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># display(private)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            train_indv_comp </span><span class="mtk8">=</span><span class="mtk1"> data.loc[:recent_known_date]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># display(train_indv_comp)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># make train_indv_comp data</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            Ys </span><span class="mtk8">=</span><span class="mtk1"> train_indv_comp.</span><span class="mtk3">filter</span><span class="mtk1">(</span><span class="mtk4 mtki">like</span><span class="mtk8">=</span><span class="mtk6">&#39;target&#39;</span><span class="mtk1">) </span><span class="mtk5 mtki">#Consisted of mon, tue, wed, thur, fri data columns</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            X </span><span class="mtk8">=</span><span class="mtk1"> train_indv_comp.</span><span class="mtk3">drop</span><span class="mtk1">(Ys.columns, </span><span class="mtk4 mtki">axis</span><span class="mtk8">=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># make private data</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            Ys_private </span><span class="mtk8">=</span><span class="mtk1"> private.</span><span class="mtk3">filter</span><span class="mtk1">(</span><span class="mtk4 mtki">like</span><span class="mtk8">=</span><span class="mtk6">&#39;target&#39;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            X_private </span><span class="mtk8">=</span><span class="mtk1"> private.</span><span class="mtk3">drop</span><span class="mtk1">(Ys_private.columns, </span><span class="mtk4 mtki">axis</span><span class="mtk8">=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># fit scaler</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            X </span><span class="mtk8">=</span><span class="mtk1"> scaler.</span><span class="mtk3">fit_transform</span><span class="mtk1">(X)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            X_private </span><span class="mtk8">=</span><span class="mtk1"> scaler.</span><span class="mtk3">transform</span><span class="mtk1">(X_private)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            pred_private </span><span class="mtk8">=</span><span class="mtk1"> []</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            private_close </span><span class="mtk8">=</span><span class="mtk1"> private_last_close</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk10 mtki">for</span><span class="mtk1"> y_col </span><span class="mtk10">in</span><span class="mtk1"> Ys.columns:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                model.</span><span class="mtk3">fit</span><span class="mtk1">(X, Ys[y_col])</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                r_pred_private </span><span class="mtk8">=</span><span class="mtk1"> model.</span><span class="mtk3">predict</span><span class="mtk1">(X_private)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                private_close </span><span class="mtk8">=</span><span class="mtk1"> private_close </span><span class="mtk8">*</span><span class="mtk1"> (</span><span class="mtk7">1</span><span class="mtk8">+</span><span class="mtk1">r_pred_private[</span><span class="mtk7">0</span><span class="mtk1">])</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                pred_private.</span><span class="mtk3">append</span><span class="mtk1">(private_close)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># print(pred_private)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            pred_df_input.loc[:,company_code] </span><span class="mtk8">=</span><span class="mtk1"> pred_private</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk5 mtki"># display(pred_df_input)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10 mtki">return</span><span class="mtk1"> pred_df_input</span></span></span></code></pre>
<h2 id="check-the-performance-for-sampled-20-companies" style="position:relative;"><a href="#check-the-performance-for-sampled-20-companies" aria-label="check the performance for sampled 20 companies permalink" class="toc-header before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Check the performance for sampled 20 companies</h2>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="18"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk6">&quot;&quot;&quot; sample prediction &quot;&quot;&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># Utilizing ElasticnetCV to automatically tune the alpha hyperparameter with cross validation.</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># (rho is left at default value 0.5)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># ElasticnetCV Documentation: https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNetCV.html#sklearn.linear_model.ElasticNetCV</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># Cross Validation documentation: https://scikit-learn.org/stable/modules/cross_validation.html#cross-validation</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># Builtin Cross Validation provided models: https://scikit-learn.org/stable/glossary.html#term-cross-validation-estimator</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk6">&quot;&quot;&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk6">https://stackoverflow.com/questions/12283184/how-is-elastic-net-used</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk6">To automatically tune the value of alpha it is indeed possible to use ElasticNetCV which will spare redundant computation as apposed to using GridSearchCV in the ElasticNet class for tuning alpha.</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk6">In complement, you can use a regular GridSearchCV for finding the optimal value of rho.</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk6">&quot;&quot;&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># name = &quot;ElasticNet_ALL_External_Dataset&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">name </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&quot;ElaticNetCV_private&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># random sample 20 companies</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">PRED_NUM</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">20</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">if</span><span class="mtk1"> </span><span class="mtk7">PRED_NUM</span><span class="mtk1"> </span><span class="mtk8">!=</span><span class="mtk1"> </span><span class="mtk7">None</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    pred_df_sampled </span><span class="mtk8">=</span><span class="mtk1"> pred_df.</span><span class="mtk3">copy</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    pred_df_sampled </span><span class="mtk8">=</span><span class="mtk1"> pred_df_sampled.</span><span class="mtk3">sample</span><span class="mtk1">(</span><span class="mtk7">PRED_NUM</span><span class="mtk1">, </span><span class="mtk4 mtki">axis</span><span class="mtk8">=</span><span class="mtk7">1</span><span class="mtk1">, </span><span class="mtk4 mtki">random_state</span><span class="mtk8">=</span><span class="mtk7">616</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">scaler </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">StandardScaler</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">model </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">ElasticNetCV</span><span class="mtk1">(</span><span class="mtk4 mtki">max_iter</span><span class="mtk8">=</span><span class="mtk7">1000000</span><span class="mtk1">) </span><span class="mtk5 mtki"># default K-Fold is 5 folds</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">df_result_sampled </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">sklearn_predict</span><span class="mtk1">(</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4 mtki">pred_df_input</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> pred_df_sampled,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4 mtki">model</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> model,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4 mtki">bool_public</span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">True</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4 mtki">start_date</span><span class="mtk8">=</span><span class="mtk1">start_date,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4 mtki">recent_known_date</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> check_point,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4 mtki">clip</span><span class="mtk8">=</span><span class="mtk7">True</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4 mtki">scaler</span><span class="mtk8">=</span><span class="mtk1">scaler</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    )</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="19"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">df_result_sampled_copy </span><span class="mtk8">=</span><span class="mtk1"> df_result_sampled.</span><span class="mtk3">copy</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">df_result_sampled_copy</span></span></span></code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre class="grvsc-container one-dark-pro" data-language="" data-index="20"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">.dataframe tbody tr th {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    vertical-align: top;</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">.dataframe thead th {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    text-align: right;</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span></code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>185750</th>
      <th>024110</th>
      <th>206650</th>
      <th>038500</th>
      <th>067630</th>
      <th>241560</th>
      <th>298000</th>
      <th>035900</th>
      <th>005387</th>
      <th>000990</th>
      <th>293490</th>
      <th>078130</th>
      <th>035420</th>
      <th>019170</th>
      <th>217270</th>
      <th>319660</th>
      <th>161390</th>
      <th>035600</th>
      <th>014680</th>
      <th>041510</th>
    </tr>
    <tr>
      <th>Day</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-09-15</th>
      <td>125064.7540</td>
      <td>10254.9362</td>
      <td>42618.1827</td>
      <td>5372.9996</td>
      <td>19360.0847</td>
      <td>42520.2396</td>
      <td>398721.4753</td>
      <td>40413.6252</td>
      <td>99356.3084</td>
      <td>58953.4027</td>
      <td>72497.5907</td>
      <td>5427.5472</td>
      <td>403990.9318</td>
      <td>67500.6979</td>
      <td>18626.1257</td>
      <td>35912.5445</td>
      <td>45053.3026</td>
      <td>18723.2635</td>
      <td>327323.1354</td>
      <td>64794.6523</td>
    </tr>
    <tr>
      <th>2021-09-16</th>
      <td>125139.3222</td>
      <td>10258.2773</td>
      <td>42721.3990</td>
      <td>5372.6779</td>
      <td>19387.2423</td>
      <td>42534.2163</td>
      <td>399329.2842</td>
      <td>40504.0768</td>
      <td>99247.8148</td>
      <td>58987.6293</td>
      <td>72439.7577</td>
      <td>5433.1925</td>
      <td>405246.7272</td>
      <td>67571.6898</td>
      <td>18639.1341</td>
      <td>35965.5198</td>
      <td>45040.3133</td>
      <td>18740.6921</td>
      <td>327575.8054</td>
      <td>64930.5748</td>
    </tr>
    <tr>
      <th>2021-09-17</th>
      <td>125205.0949</td>
      <td>10261.0199</td>
      <td>42818.9030</td>
      <td>5371.4292</td>
      <td>19410.6680</td>
      <td>42545.0733</td>
      <td>399883.2743</td>
      <td>40574.4049</td>
      <td>99185.6754</td>
      <td>59015.3259</td>
      <td>72452.6539</td>
      <td>5438.2213</td>
      <td>406134.5774</td>
      <td>67632.3829</td>
      <td>18649.8843</td>
      <td>36014.5010</td>
      <td>45030.5329</td>
      <td>18759.7012</td>
      <td>327804.9015</td>
      <td>64994.3200</td>
    </tr>
    <tr>
      <th>2021-09-23</th>
      <td>125155.5177</td>
      <td>10263.4246</td>
      <td>42915.5822</td>
      <td>5369.6404</td>
      <td>19432.5767</td>
      <td>42553.3841</td>
      <td>400448.6410</td>
      <td>40646.8703</td>
      <td>99134.4965</td>
      <td>59039.3481</td>
      <td>72379.0831</td>
      <td>5442.9652</td>
      <td>406902.2789</td>
      <td>67687.9173</td>
      <td>18659.4037</td>
      <td>36058.6550</td>
      <td>45023.5971</td>
      <td>18773.1005</td>
      <td>328019.5180</td>
      <td>65052.2335</td>
    </tr>
    <tr>
      <th>2021-09-24</th>
      <td>125093.3296</td>
      <td>10265.6863</td>
      <td>43001.4697</td>
      <td>5367.4838</td>
      <td>19453.5579</td>
      <td>42561.5443</td>
      <td>401019.1642</td>
      <td>40716.1010</td>
      <td>99099.2499</td>
      <td>59061.2745</td>
      <td>72294.9027</td>
      <td>5447.5175</td>
      <td>407592.0695</td>
      <td>67740.2365</td>
      <td>18667.9796</td>
      <td>36102.0524</td>
      <td>45011.9833</td>
      <td>18785.5887</td>
      <td>328226.2354</td>
      <td>65100.9893</td>
    </tr>
  </tbody>
</table>
</div>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="21"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">mape_value </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">mape</span><span class="mtk1">(true_df, df_result_sampled_copy)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">print</span><span class="mtk1">(mape_value)</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="" data-index="22"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">2.9318977420110794</span></span></code></pre>
<h2 id="전체" style="position:relative;"><a href="#%EC%A0%84%EC%B2%B4" aria-label="전체 permalink" class="toc-header before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>전체</h2>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="23"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk6">&quot;&quot;&quot; training time: 3444 second(or 57 minutes) &quot;&quot;&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># name = &quot;ElasticNet_ALL_External_Dataset&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">name </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&quot;ElasticNetCV_private&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># predict for all 376 companies</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">PRED_NUM</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">None</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">scaler </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">StandardScaler</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">model </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">ElasticNetCV</span><span class="mtk1">(</span><span class="mtk4 mtki">max_iter</span><span class="mtk8">=</span><span class="mtk7">1000000</span><span class="mtk1">) </span><span class="mtk5 mtki"># default K-Fold is 5 folds</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">df_result_all </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk3">sklearn_predict</span><span class="mtk1">(</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    pred_df,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    model,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4 mtki">bool_public</span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">BOOL_PUBLIC</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4 mtki">start_date</span><span class="mtk8">=</span><span class="mtk1">start_date,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4 mtki">recent_known_date</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> recent_known_date,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4 mtki">clip</span><span class="mtk8">=</span><span class="mtk7">True</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4 mtki">scaler</span><span class="mtk8">=</span><span class="mtk1">scaler</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    )</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="" data-index="24"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">100%|██████████| 376/376 [1:02:57&lt;00:00, 10.05s/it]</span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="25"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">display</span><span class="mtk1">(df_result_all)</span></span></span></code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre class="grvsc-container one-dark-pro" data-language="" data-index="26"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">.dataframe tbody tr th {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    vertical-align: top;</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">.dataframe thead th {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    text-align: right;</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span></code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>000060</th>
      <th>000080</th>
      <th>000100</th>
      <th>000120</th>
      <th>000150</th>
      <th>000240</th>
      <th>000250</th>
      <th>000270</th>
      <th>000660</th>
      <th>000670</th>
      <th>000720</th>
      <th>000810</th>
      <th>000880</th>
      <th>000990</th>
      <th>001230</th>
      <th>001440</th>
      <th>001450</th>
      <th>001740</th>
      <th>002380</th>
      <th>002790</th>
      <th>003000</th>
      <th>003090</th>
      <th>003380</th>
      <th>003410</th>
      <th>003490</th>
      <th>003670</th>
      <th>003800</th>
      <th>004000</th>
      <th>004020</th>
      <th>004170</th>
      <th>004370</th>
      <th>004490</th>
      <th>004800</th>
      <th>004990</th>
      <th>005250</th>
      <th>005290</th>
      <th>005300</th>
      <th>005380</th>
      <th>005385</th>
      <th>005387</th>
      <th>005490</th>
      <th>005830</th>
      <th>005850</th>
      <th>005930</th>
      <th>005935</th>
      <th>005940</th>
      <th>006260</th>
      <th>006280</th>
      <th>006360</th>
      <th>006400</th>
      <th>...</th>
      <th>253450</th>
      <th>256840</th>
      <th>263720</th>
      <th>263750</th>
      <th>267250</th>
      <th>267980</th>
      <th>268600</th>
      <th>271560</th>
      <th>272210</th>
      <th>272290</th>
      <th>273130</th>
      <th>278280</th>
      <th>278530</th>
      <th>282330</th>
      <th>285130</th>
      <th>287410</th>
      <th>290510</th>
      <th>290650</th>
      <th>292150</th>
      <th>293490</th>
      <th>293780</th>
      <th>294090</th>
      <th>294870</th>
      <th>298000</th>
      <th>298020</th>
      <th>298050</th>
      <th>298380</th>
      <th>298540</th>
      <th>299030</th>
      <th>299660</th>
      <th>299900</th>
      <th>307950</th>
      <th>314130</th>
      <th>316140</th>
      <th>319400</th>
      <th>319660</th>
      <th>321550</th>
      <th>323990</th>
      <th>326030</th>
      <th>330590</th>
      <th>330860</th>
      <th>336260</th>
      <th>336370</th>
      <th>347860</th>
      <th>348150</th>
      <th>348210</th>
      <th>352820</th>
      <th>357780</th>
      <th>363280</th>
      <th>950130</th>
    </tr>
    <tr>
      <th>Day</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-09-27</th>
      <td>29619.9213</td>
      <td>33404.8682</td>
      <td>62934.1627</td>
      <td>166627.0991</td>
      <td>96951.3550</td>
      <td>16318.2245</td>
      <td>51157.0890</td>
      <td>82640.1175</td>
      <td>104056.0722</td>
      <td>696633.1831</td>
      <td>53210.2029</td>
      <td>228543.4327</td>
      <td>34616.2408</td>
      <td>56750.9950</td>
      <td>18713.0184</td>
      <td>2525.4144</td>
      <td>25020.4805</td>
      <td>5300.8629</td>
      <td>455412.5823</td>
      <td>50759.8474</td>
      <td>20476.7460</td>
      <td>34335.2240</td>
      <td>9536.7369</td>
      <td>8255.9627</td>
      <td>34271.9425</td>
      <td>162211.5139</td>
      <td>49392.2069</td>
      <td>92991.9337</td>
      <td>48689.8328</td>
      <td>272236.9822</td>
      <td>289666.8211</td>
      <td>85478.4144</td>
      <td>122615.8457</td>
      <td>34643.0840</td>
      <td>31984.6833</td>
      <td>31032.8182</td>
      <td>149020.7516</td>
      <td>206984.5334</td>
      <td>99366.3220</td>
      <td>98193.8653</td>
      <td>345410.9456</td>
      <td>62765.9660</td>
      <td>27726.3380</td>
      <td>77250.9716</td>
      <td>71617.0677</td>
      <td>13158.5612</td>
      <td>66146.4555</td>
      <td>344804.7013</td>
      <td>44426.1867</td>
      <td>726008.7348</td>
      <td>...</td>
      <td>85134.8412</td>
      <td>55242.7675</td>
      <td>41037.1551</td>
      <td>87580.0575</td>
      <td>64106.1314</td>
      <td>72915.4644</td>
      <td>59209.0412</td>
      <td>122193.8499</td>
      <td>18533.3206</td>
      <td>41371.7568</td>
      <td>108823.5392</td>
      <td>273798.8944</td>
      <td>13438.8918</td>
      <td>172536.5767</td>
      <td>282948.8369</td>
      <td>7795.4170</td>
      <td>7536.9262</td>
      <td>39055.3084</td>
      <td>13833.1392</td>
      <td>68344.4815</td>
      <td>45389.0326</td>
      <td>51583.5746</td>
      <td>27979.6905</td>
      <td>400906.3756</td>
      <td>710964.3401</td>
      <td>871526.8897</td>
      <td>19831.0911</td>
      <td>31559.7435</td>
      <td>60848.2452</td>
      <td>111160.9148</td>
      <td>16692.1713</td>
      <td>105428.1348</td>
      <td>45187.3560</td>
      <td>11146.7696</td>
      <td>3438.2884</td>
      <td>36965.8713</td>
      <td>18833.2831</td>
      <td>76519.7910</td>
      <td>106993.1205</td>
      <td>5528.7665</td>
      <td>46765.8625</td>
      <td>49179.3201</td>
      <td>67486.5771</td>
      <td>31774.1941</td>
      <td>29074.3546</td>
      <td>56910.9233</td>
      <td>268362.2621</td>
      <td>290074.0721</td>
      <td>28644.1991</td>
      <td>20074.8843</td>
    </tr>
    <tr>
      <th>2021-09-28</th>
      <td>29641.2372</td>
      <td>33410.9766</td>
      <td>62996.9338</td>
      <td>166704.4970</td>
      <td>97004.0898</td>
      <td>16335.1979</td>
      <td>51198.9499</td>
      <td>82659.9783</td>
      <td>104066.5543</td>
      <td>697048.4354</td>
      <td>53154.2625</td>
      <td>228638.8170</td>
      <td>34595.6852</td>
      <td>56783.5609</td>
      <td>18720.7457</td>
      <td>2524.9961</td>
      <td>25035.1632</td>
      <td>5299.6526</td>
      <td>455698.5859</td>
      <td>50696.7335</td>
      <td>20497.6473</td>
      <td>34358.2641</td>
      <td>9531.8428</td>
      <td>8259.1139</td>
      <td>34295.1064</td>
      <td>162433.0638</td>
      <td>49423.3173</td>
      <td>92950.0978</td>
      <td>48739.4518</td>
      <td>272558.1387</td>
      <td>289818.6419</td>
      <td>85665.7054</td>
      <td>122699.8400</td>
      <td>34683.6341</td>
      <td>32012.5879</td>
      <td>31013.3876</td>
      <td>149093.8104</td>
      <td>207123.2654</td>
      <td>99285.9642</td>
      <td>98222.7768</td>
      <td>345734.1227</td>
      <td>62823.5848</td>
      <td>27745.6550</td>
      <td>77270.0037</td>
      <td>71642.3679</td>
      <td>13163.4640</td>
      <td>66179.3712</td>
      <td>344998.0796</td>
      <td>44450.9740</td>
      <td>726398.5421</td>
      <td>...</td>
      <td>85150.5989</td>
      <td>55572.7020</td>
      <td>41155.7774</td>
      <td>87730.7834</td>
      <td>64107.7192</td>
      <td>72911.9722</td>
      <td>59367.1055</td>
      <td>122342.1253</td>
      <td>18561.5405</td>
      <td>41391.4693</td>
      <td>108832.3748</td>
      <td>274609.9104</td>
      <td>13443.2515</td>
      <td>172502.3226</td>
      <td>282953.2805</td>
      <td>7811.3651</td>
      <td>7541.5022</td>
      <td>39147.3212</td>
      <td>13840.5457</td>
      <td>68263.6724</td>
      <td>45478.3515</td>
      <td>51629.3426</td>
      <td>27953.9254</td>
      <td>400845.8235</td>
      <td>710307.6560</td>
      <td>880941.8171</td>
      <td>19848.3055</td>
      <td>31603.2093</td>
      <td>60986.5374</td>
      <td>111366.8870</td>
      <td>16730.7055</td>
      <td>105360.5544</td>
      <td>45304.5754</td>
      <td>11141.9899</td>
      <td>3440.4603</td>
      <td>37020.5905</td>
      <td>18850.3581</td>
      <td>76408.3022</td>
      <td>106751.9680</td>
      <td>5527.3493</td>
      <td>46823.7669</td>
      <td>49393.8403</td>
      <td>67488.7739</td>
      <td>31799.0865</td>
      <td>29069.9619</td>
      <td>56848.9364</td>
      <td>269112.6391</td>
      <td>289045.8422</td>
      <td>28671.6626</td>
      <td>20092.6880</td>
    </tr>
    <tr>
      <th>2021-09-29</th>
      <td>29659.9998</td>
      <td>33414.0403</td>
      <td>63060.8037</td>
      <td>166766.6097</td>
      <td>97047.5968</td>
      <td>16350.5709</td>
      <td>51235.1900</td>
      <td>82672.4479</td>
      <td>104029.4717</td>
      <td>697398.8750</td>
      <td>53127.4203</td>
      <td>228808.0665</td>
      <td>34591.6177</td>
      <td>56809.9294</td>
      <td>18726.6707</td>
      <td>2524.2865</td>
      <td>25047.6200</td>
      <td>5297.8121</td>
      <td>455953.6829</td>
      <td>50647.3469</td>
      <td>20511.6095</td>
      <td>34379.0331</td>
      <td>9526.7009</td>
      <td>8261.3723</td>
      <td>34311.4601</td>
      <td>162599.8111</td>
      <td>49450.8603</td>
      <td>92915.7797</td>
      <td>48838.7770</td>
      <td>272890.9565</td>
      <td>289973.1638</td>
      <td>85718.1060</td>
      <td>122772.9330</td>
      <td>34729.9229</td>
      <td>32037.7311</td>
      <td>31013.6800</td>
      <td>149205.9845</td>
      <td>207299.9896</td>
      <td>99307.0351</td>
      <td>98257.5142</td>
      <td>346058.4688</td>
      <td>62874.2882</td>
      <td>27762.7063</td>
      <td>77304.3423</td>
      <td>71660.5777</td>
      <td>13166.8532</td>
      <td>66207.6025</td>
      <td>345139.2794</td>
      <td>44471.1243</td>
      <td>726786.1160</td>
      <td>...</td>
      <td>85155.3182</td>
      <td>55919.4128</td>
      <td>41232.5346</td>
      <td>87873.5729</td>
      <td>64103.3814</td>
      <td>72905.3485</td>
      <td>59515.5655</td>
      <td>122422.1061</td>
      <td>18588.3547</td>
      <td>41409.0996</td>
      <td>108841.1698</td>
      <td>275375.6071</td>
      <td>13447.6955</td>
      <td>172457.9531</td>
      <td>282988.4423</td>
      <td>7825.7740</td>
      <td>7545.5702</td>
      <td>39236.0164</td>
      <td>13847.9131</td>
      <td>68146.6331</td>
      <td>45566.7920</td>
      <td>51948.7495</td>
      <td>27927.4594</td>
      <td>401388.8262</td>
      <td>710597.3525</td>
      <td>891051.5782</td>
      <td>19860.8061</td>
      <td>31642.8484</td>
      <td>61120.5119</td>
      <td>111560.2977</td>
      <td>16767.3728</td>
      <td>105286.1974</td>
      <td>45412.5893</td>
      <td>11136.9467</td>
      <td>3442.4249</td>
      <td>37077.8781</td>
      <td>18866.4524</td>
      <td>75868.4705</td>
      <td>106511.4224</td>
      <td>5526.0227</td>
      <td>46879.8267</td>
      <td>49616.5520</td>
      <td>67502.8980</td>
      <td>31817.8737</td>
      <td>29062.0097</td>
      <td>56912.9122</td>
      <td>269886.0036</td>
      <td>289047.2415</td>
      <td>28689.7233</td>
      <td>20106.9512</td>
    </tr>
    <tr>
      <th>2021-09-30</th>
      <td>29677.6329</td>
      <td>33418.5014</td>
      <td>63124.2603</td>
      <td>166819.7420</td>
      <td>97087.3846</td>
      <td>16363.0247</td>
      <td>51268.0538</td>
      <td>82681.2358</td>
      <td>104028.8458</td>
      <td>697716.3061</td>
      <td>53120.1486</td>
      <td>228978.3769</td>
      <td>34592.4368</td>
      <td>56832.7125</td>
      <td>18735.2131</td>
      <td>2523.4326</td>
      <td>25058.8927</td>
      <td>5295.6598</td>
      <td>456193.9527</td>
      <td>50600.5772</td>
      <td>20524.5186</td>
      <td>34398.6680</td>
      <td>9521.3283</td>
      <td>8263.1191</td>
      <td>34326.0686</td>
      <td>162741.3691</td>
      <td>49476.8197</td>
      <td>92945.8520</td>
      <td>48980.0360</td>
      <td>273205.5961</td>
      <td>290114.5844</td>
      <td>85767.4181</td>
      <td>122840.7642</td>
      <td>34760.9855</td>
      <td>32059.8130</td>
      <td>31001.9968</td>
      <td>149288.2221</td>
      <td>207442.3514</td>
      <td>99319.4612</td>
      <td>98298.1543</td>
      <td>346370.0238</td>
      <td>62921.4168</td>
      <td>27792.9857</td>
      <td>77346.4759</td>
      <td>71697.8110</td>
      <td>13161.0052</td>
      <td>66233.6612</td>
      <td>345259.8600</td>
      <td>44489.0416</td>
      <td>727210.4963</td>
      <td>...</td>
      <td>85183.3230</td>
      <td>56093.8298</td>
      <td>41308.5059</td>
      <td>88007.7671</td>
      <td>64100.4969</td>
      <td>72897.1765</td>
      <td>59654.9000</td>
      <td>122468.4388</td>
      <td>18614.0005</td>
      <td>41424.6338</td>
      <td>108850.1303</td>
      <td>276138.1048</td>
      <td>13451.9330</td>
      <td>172398.1197</td>
      <td>283351.6078</td>
      <td>7842.5450</td>
      <td>7548.6130</td>
      <td>39325.1257</td>
      <td>13855.0212</td>
      <td>68041.5214</td>
      <td>45651.3523</td>
      <td>52262.2849</td>
      <td>27902.0970</td>
      <td>401944.6413</td>
      <td>711507.5729</td>
      <td>899799.3356</td>
      <td>19871.2709</td>
      <td>31679.9238</td>
      <td>61253.1297</td>
      <td>111754.5069</td>
      <td>16804.7915</td>
      <td>105233.4033</td>
      <td>45517.8564</td>
      <td>11131.7003</td>
      <td>3444.3205</td>
      <td>37129.6121</td>
      <td>18875.7521</td>
      <td>75596.5935</td>
      <td>106310.3201</td>
      <td>5524.5951</td>
      <td>46926.6664</td>
      <td>49832.2755</td>
      <td>67486.1650</td>
      <td>31820.3359</td>
      <td>29041.0651</td>
      <td>57020.0201</td>
      <td>271019.1920</td>
      <td>287825.4264</td>
      <td>28709.3131</td>
      <td>20119.0428</td>
    </tr>
    <tr>
      <th>2021-10-01</th>
      <td>29694.6207</td>
      <td>33423.9375</td>
      <td>63193.3635</td>
      <td>166868.1106</td>
      <td>97124.4400</td>
      <td>16345.2020</td>
      <td>51298.7895</td>
      <td>82687.5453</td>
      <td>104023.7073</td>
      <td>698015.0172</td>
      <td>53134.0349</td>
      <td>229134.0139</td>
      <td>34598.0681</td>
      <td>56853.3770</td>
      <td>18742.5141</td>
      <td>2522.5170</td>
      <td>25069.4874</td>
      <td>5293.3238</td>
      <td>456423.1230</td>
      <td>50563.0390</td>
      <td>20536.8711</td>
      <td>34415.6411</td>
      <td>9515.8036</td>
      <td>8264.5175</td>
      <td>34326.4535</td>
      <td>162881.1631</td>
      <td>49475.1053</td>
      <td>92973.7446</td>
      <td>49028.6449</td>
      <td>273507.2655</td>
      <td>290222.1305</td>
      <td>85814.4315</td>
      <td>122867.5208</td>
      <td>34787.7937</td>
      <td>32081.1379</td>
      <td>30982.2917</td>
      <td>149367.6134</td>
      <td>207596.9442</td>
      <td>99316.1011</td>
      <td>98349.8378</td>
      <td>346657.8080</td>
      <td>62966.5126</td>
      <td>27821.7097</td>
      <td>77389.4860</td>
      <td>71756.7589</td>
      <td>13156.2628</td>
      <td>66258.1970</td>
      <td>345369.7252</td>
      <td>44505.3942</td>
      <td>727541.8449</td>
      <td>...</td>
      <td>85210.5932</td>
      <td>56443.1028</td>
      <td>41380.6160</td>
      <td>88139.9194</td>
      <td>64095.7902</td>
      <td>72888.7033</td>
      <td>59793.2597</td>
      <td>122519.5538</td>
      <td>18640.2923</td>
      <td>41437.6867</td>
      <td>108859.2157</td>
      <td>276890.2609</td>
      <td>13456.2170</td>
      <td>172334.4949</td>
      <td>283873.0039</td>
      <td>7889.8827</td>
      <td>7550.9179</td>
      <td>39412.9016</td>
      <td>13862.0739</td>
      <td>67979.0034</td>
      <td>45735.5675</td>
      <td>52611.6164</td>
      <td>27877.6216</td>
      <td>402492.1156</td>
      <td>712434.5186</td>
      <td>908492.8089</td>
      <td>19880.8972</td>
      <td>31718.5363</td>
      <td>61385.7797</td>
      <td>111941.7628</td>
      <td>16845.4909</td>
      <td>105197.0065</td>
      <td>45590.5963</td>
      <td>11126.2165</td>
      <td>3446.0998</td>
      <td>37179.4420</td>
      <td>18881.2332</td>
      <td>75544.5761</td>
      <td>106053.9055</td>
      <td>5522.9875</td>
      <td>46959.3655</td>
      <td>50044.8621</td>
      <td>67442.7575</td>
      <td>31815.1584</td>
      <td>29013.0873</td>
      <td>57201.4429</td>
      <td>272120.7188</td>
      <td>287296.5950</td>
      <td>28730.4632</td>
      <td>20130.6205</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 376 columns</p>
</div>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="27"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">name </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&quot;ElasticNetCV_private_last&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">df_result_all.</span><span class="mtk3">to_csv</span><span class="mtk1">(</span><span class="mtk10">f</span><span class="mtk6">&#39;predict/</span><span class="mtk7">{</span><span class="mtk1">name</span><span class="mtk7">}</span><span class="mtk6">.csv&#39;</span><span class="mtk1">)</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="28"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># load result from csv</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">df_result_all </span><span class="mtk8">=</span><span class="mtk1"> pd.</span><span class="mtk3">read_csv</span><span class="mtk1">(</span><span class="mtk10">f</span><span class="mtk6">&#39;predict/</span><span class="mtk7">{</span><span class="mtk1">name</span><span class="mtk7">}</span><span class="mtk6">.csv&#39;</span><span class="mtk1">)</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="29"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># apply retina display for clearer visualization</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">%</span><span class="mtk1">config InlineBackend.figure_format </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&#39;retina&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># Korean font path designation</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">import</span><span class="mtk1"> matplotlib.font_manager </span><span class="mtk10 mtki">as</span><span class="mtk1"> fm</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">fontpath </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk6">&#39;./font/NanumBarunGothic.ttf&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">font </span><span class="mtk8">=</span><span class="mtk1"> fm.</span><span class="mtk3">FontProperties</span><span class="mtk1">(</span><span class="mtk4 mtki">fname</span><span class="mtk8">=</span><span class="mtk1">fontpath, </span><span class="mtk4 mtki">size</span><span class="mtk8">=</span><span class="mtk7">14</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># sample 9 companies from stock_list</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">SAMPLE_NUM</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">16</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">sampled_data </span><span class="mtk8">=</span><span class="mtk1"> stock_list.</span><span class="mtk3">sample</span><span class="mtk1">(</span><span class="mtk7">SAMPLE_NUM</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># visualize 16 companies subplots from df_result_all</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">fig, ax </span><span class="mtk8">=</span><span class="mtk1"> plt.</span><span class="mtk3">subplots</span><span class="mtk1">(</span><span class="mtk4 mtki">nrows</span><span class="mtk8">=</span><span class="mtk7">4</span><span class="mtk1">, </span><span class="mtk4 mtki">ncols</span><span class="mtk8">=</span><span class="mtk7">4</span><span class="mtk1">, </span><span class="mtk4 mtki">figsize</span><span class="mtk8">=</span><span class="mtk1">(</span><span class="mtk7">16</span><span class="mtk1">,</span><span class="mtk7">16</span><span class="mtk1">))</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># make margin between figures</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">plt.</span><span class="mtk3">subplots_adjust</span><span class="mtk1">(</span><span class="mtk4 mtki">hspace</span><span class="mtk8">=</span><span class="mtk7">0.5</span><span class="mtk1">, </span><span class="mtk4 mtki">wspace</span><span class="mtk8">=</span><span class="mtk7">0.5</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># visualize df_result_all</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10 mtki">for</span><span class="mtk1"> i, code </span><span class="mtk10">in</span><span class="mtk1"> </span><span class="mtk8">enumerate</span><span class="mtk1">(sampled_data[</span><span class="mtk6">&quot;종목코드&quot;</span><span class="mtk1">]):</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    ax[i</span><span class="mtk8">//</span><span class="mtk7">4</span><span class="mtk1">, i</span><span class="mtk8">%</span><span class="mtk7">4</span><span class="mtk1">].</span><span class="mtk3">plot</span><span class="mtk1">(df_result_all.loc[:,code])</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk5 mtki"># find the matching row of sampled_data from code</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    company_name </span><span class="mtk8">=</span><span class="mtk1"> stock_list[stock_list[</span><span class="mtk6">&quot;종목코드&quot;</span><span class="mtk1">] </span><span class="mtk8">==</span><span class="mtk1"> code][</span><span class="mtk6">&quot;종목명&quot;</span><span class="mtk1">].values[</span><span class="mtk7">0</span><span class="mtk1">]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    ax[i</span><span class="mtk8">//</span><span class="mtk7">4</span><span class="mtk1">, i</span><span class="mtk8">%</span><span class="mtk7">4</span><span class="mtk1">].</span><span class="mtk3">set_title</span><span class="mtk1">(company_name, </span><span class="mtk4 mtki">fontproperties</span><span class="mtk8">=</span><span class="mtk1">font)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    ax[i</span><span class="mtk8">//</span><span class="mtk7">4</span><span class="mtk1">, i</span><span class="mtk8">%</span><span class="mtk7">4</span><span class="mtk1">].</span><span class="mtk3">set_xlabel</span><span class="mtk1">(</span><span class="mtk6">&#39;Date&#39;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    ax[i</span><span class="mtk8">//</span><span class="mtk7">4</span><span class="mtk1">, i</span><span class="mtk8">%</span><span class="mtk7">4</span><span class="mtk1">].</span><span class="mtk3">set_ylabel</span><span class="mtk1">(</span><span class="mtk6">&#39;Close Price&#39;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    ax[i</span><span class="mtk8">//</span><span class="mtk7">4</span><span class="mtk1">, i</span><span class="mtk8">%</span><span class="mtk7">4</span><span class="mtk1">].</span><span class="mtk3">grid</span><span class="mtk1">()</span></span></span></code></pre>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 97.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAAEEElEQVQ4y4VUW28bRRReuzZSCSlCleAv8NznVkiIKg9IgZJCIoF4AJUShOCBS29qFQkUyiUlPFFoSExbCuLSlrQlCikFiVKg0Fi2HNuNbVrf1l7vend2d3ZmL3aWc3ZtZPEAK420++05Z8583/lGEARhs6KSNLNd3/M83zCMk77vC5qmXfc6Hd+wuE908zvEavXGZUK5z7jtW5ReQ0yW5U87EGdxx1eJkYd6wt2cs2uO1/GZgwX1ExhoGOYVCzZxHFi2/RViVVH61oU4xBljK8HGqnqcux3fdj2M+xML3kEIWXYcxzIo8yRFOxZ002hdsDh3YDPHMM0EYuVq7YzNOTeo5bba2jnE/irXZinjrm1zquvGj4IQiQrLy9/HxsfHh9/c9/LQ/EIihoGvHJqKTzzx+PDY7t3D507PxXDnb+Y+iD371MRdY4+ODj//2pH4/iNvCAfemo1N7t0zNDr6yJbzZxLxoENJknaurWWfS2bye0RF29aBgs1m88HV1RsvrSaTLxbLtR24Sel2dfvvyfTeVCr1AqXmA4ipqrotn89PplOpyYoojWDBLapGMhRI5bbjQ9uBKETT/kCyTWb7xAhFqTeaK0g+RVEsqy/KyW43FEXTzbwAPW5tqeQ3D8je6HZ94HMOA01Kr6BILijPLOtsKJRxdmOj63MUj7LLvQ4HRbmBHW4WJXmJ2zYB5Rh0+A4G3qrWFy3GTOiEwiafBB3W66cgxECsKatfI3a7Jr5LLc5ALE3X9RXh/vvuFPAHPJtgRfB99vSFQSyK71NTU5EeFkW8996PE/px+MRFUXwsm80eKBSL+0RZ3Y4/Crcqo5lM5lAumz0IHT7UO97OYqGwP5PNHay32g8jBrk7yuXy66VS6dWmou0KRIFW013gD4UBARYwUJKV68Fgu65PKb0UukddQv4QBzquItZoNE5hrhXm5rDgVhiBINkOXME/wkBdJz+jKwzLRlcEojRbyiKDmC6oD0b4ocfrAmI4IWCCpBARhCGw1KJpsQZnrK1pZDpIlqQvgWhZN0xFbCnHAwGq4gko3oKlgHs+Qyy7XnwPchXIFcH/l0CGeEDsv1Zk8NuDNfPhfPT/4vqibALSn65Vq0cbTWla1oyRgENJehKOcxTWNIzIrt6IjOF3pVJ5Gy6PieDITWkkVyjNrN+8OQMdPoMF7yFES+NgoyvANYmQQ/3XUKjAKRdDodpLeM2hM+COuNpzT4IC1jPAGha8VyNkFRVG0ND1+cB6hPyCZDPAgcvzvTvyIjoiENC2f0JMUeR5r9MNMc5TWHCoUm9+DpdmDnYtgSiHg3FotecoswuQWADLHQuTlfcdx16H66oIdv04pKZ12HWdEjGtnNTWvhic9n+cMoBFBx3wH5jQd8/fCXtiluvbMPcAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="output_21_0"
        title="output_21_0"
        src="/static/5cbf5c783b4d2d56d8137ba1d5d5483c/c1b63/output_21_0.png"
        srcset="/static/5cbf5c783b4d2d56d8137ba1d5d5483c/5a46d/output_21_0.png 300w,
/static/5cbf5c783b4d2d56d8137ba1d5d5483c/0a47e/output_21_0.png 600w,
/static/5cbf5c783b4d2d56d8137ba1d5d5483c/c1b63/output_21_0.png 1200w,
/static/5cbf5c783b4d2d56d8137ba1d5d5483c/d61c2/output_21_0.png 1800w,
/static/5cbf5c783b4d2d56d8137ba1d5d5483c/7ebf9/output_21_0.png 1919w"
        sizes="(max-width: 1200px) 100vw, 1200px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<pre class="grvsc-container one-dark-pro" data-language="python" data-index="30"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># check submission&#39;s validity</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">submission_last </span><span class="mtk8">=</span><span class="mtk1"> pd.</span><span class="mtk3">read_csv</span><span class="mtk1">(</span><span class="mtk6">&quot;./predict/ElasticNetCV_2021-09-26.csv&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk5 mtki"># show information of the submission</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">submission_last.</span><span class="mtk3">info</span><span class="mtk1">()</span></span></span></code></pre>
<pre class="grvsc-container one-dark-pro" data-language="" data-index="31"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">RangeIndex: 10 entries, 0 to 9</span></span>
<span class="grvsc-line"><span class="grvsc-source">Columns: 377 entries, Day to 950130</span></span>
<span class="grvsc-line"><span class="grvsc-source">dtypes: float64(376), object(1)</span></span>
<span class="grvsc-line"><span class="grvsc-source">memory usage: 29.6+ KB</span></span></code></pre>
<style class="grvsc-styles">
  .grvsc-container {
    overflow: auto;
    position: relative;
    -webkit-overflow-scrolling: touch;
    padding-top: 1rem;
    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));
    padding-bottom: 1rem;
    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));
    border-radius: 8px;
    border-radius: var(--grvsc-border-radius, 8px);
    font-feature-settings: normal;
    line-height: 1.4;
  }
  
  .grvsc-code {
    display: table;
  }
  
  .grvsc-line {
    display: table-row;
    box-sizing: border-box;
    width: 100%;
    position: relative;
  }
  
  .grvsc-line > * {
    position: relative;
  }
  
  .grvsc-gutter-pad {
    display: table-cell;
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  .grvsc-gutter {
    display: table-cell;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter::before {
    content: attr(data-content);
  }
  
  .grvsc-source {
    display: table-cell;
    padding-left: 1.5rem;
    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));
    padding-right: 1.5rem;
    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));
  }
  
  .grvsc-source:empty::after {
    content: ' ';
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter + .grvsc-source {
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  /* Line transformer styles */
  
  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {
    content: ' ';
    position: absolute;
    width: 100%;
  }
  
  .grvsc-line-diff-add::before {
    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));
  }
  
  .grvsc-line-diff-del::before {
    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));
  }
  
  .grvsc-line-number {
    padding: 0 2px;
    text-align: right;
    opacity: 0.7;
  }
  
  .one-dark-pro {
    background-color: #282c34;
    color: #abb2bf;
  }
  .one-dark-pro .mtki { font-style: italic; }
  .one-dark-pro .mtk10 { color: #C678DD; }
  .one-dark-pro .mtk1 { color: #ABB2BF; }
  .one-dark-pro .mtk3 { color: #61AFEF; }
  .one-dark-pro .mtk7 { color: #D19A66; }
  .one-dark-pro .mtk6 { color: #98C379; }
  .one-dark-pro .mtk8 { color: #56B6C2; }
  .one-dark-pro .mtk5 { color: #7F848E; }
  .one-dark-pro .mtk4 { color: #E06C75; }
  .one-dark-pro .grvsc-line-highlighted::before {
    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));
    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));
  }
</style></div></div></div></div><div class="css-1bdwg0l eyldt480"><div><style data-emotion-css="17t5ffy">.css-17t5ffy{margin-top:1rem;margin-bottom:1rem;}</style><div class="css-17t5ffy"><div class="css-1l4w6pd"><div class="css-yapsbb"></div></div></div><style data-emotion-css="i1cgbm">.css-i1cgbm{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;margin-top:1rem;padding-left:0.5rem;padding-right:0.5rem;}</style><div class="css-i1cgbm"><style data-emotion-css="9nr5sz">.css-9nr5sz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding-left:0.75rem;padding-right:0.75rem;padding-top:0.25rem;padding-bottom:0.25rem;margin-top:0.5rem;margin-bottom:0.5rem;margin-left:0.5rem;border-radius:0.25rem;--text-opacity:1;color:rgba(255,255,255,var(--text-opacity));background-color:#1CA1F2;}</style><button class="css-9nr5sz"><style data-emotion-css="u7tj59">.css-u7tj59{fill:currentColor;margin-top:auto;margin-bottom:auto;margin-right:0.25rem;}</style><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="css-u7tj59" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg>Share with <!-- -->Twitter</button><style data-emotion-css="rk0yc0">.css-rk0yc0{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding-left:0.75rem;padding-right:0.75rem;padding-top:0.25rem;padding-bottom:0.25rem;margin-top:0.5rem;margin-bottom:0.5rem;margin-left:0.5rem;border-radius:0.25rem;--text-opacity:1;color:rgba(255,255,255,var(--text-opacity));background-color:#6E7783;}</style><button class="css-rk0yc0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="css-u7tj59" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg>Share with <!-- -->URL</button></div></div></div></div></div><div class="css-1bdwg0l eyldt480"><style data-emotion-css="17t1oy1">.css-17t1oy1{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap-reverse;-ms-flex-wrap:wrap-reverse;flex-wrap:wrap-reverse;margin-left:0.5rem;margin-right:0.5rem;margin-top:1rem;}@media (min-width:768px){.css-17t1oy1{-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}}</style><div class="css-17t1oy1 e816y8n0"><style data-emotion-css="1pwr1ry">.css-1pwr1ry{width:100%;margin:0.5rem;}@media (min-width:768px){.css-1pwr1ry{width:50%;margin:1rem;}}</style><div class="css-1pwr1ry e816y8n1"><style data-emotion-css="vl2eok">.css-vl2eok{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-transition:all 300ms cubic-bezier(0.4,0,0.2,1);transition:all 300ms cubic-bezier(0.4,0,0.2,1);text-align:left;width:100%;height:100%;padding:0.5rem;background-color:#eee;border-radius:0.25rem;border-left-width:4px;border-color:#86a8e7;}.css-vl2eok:hover{background-color:#ddd;}</style><a rel="prev" class="css-vl2eok" href="/DL&amp;ML/NLP-Clipboard/"><style data-emotion-css="19o7xeo">.css-19o7xeo{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-content:center;-ms-flex-line-pack:center;align-content:center;margin-right:1rem;margin-left:0.5rem;height:100%;}</style><div class="css-19o7xeo"><style data-emotion-css="11za1ik">.css-11za1ik{width:2rem;height:2rem;margin-top:auto;margin-bottom:auto;}</style><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="css-11za1ik" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 0 0 0 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"></path></svg></div><style data-emotion-css="v38or">.css-v38or{display:inline-block;margin-top:0.5rem;margin-bottom:0.5rem;}</style><div class="css-v38or"><style data-emotion-css="2m7hin">.css-2m7hin{color:#3737B9;}</style><p class="css-2m7hin">Previous Post</p><p>NLP Clipboard</p></div></a></div><div class="css-1pwr1ry e816y8n1"><style data-emotion-css="xhvfnc">.css-xhvfnc{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;-webkit-transition:all 300ms cubic-bezier(0.4,0,0.2,1);transition:all 300ms cubic-bezier(0.4,0,0.2,1);text-align:right;width:100%;height:100%;padding:0.5rem;background-color:#eee;border-radius:0.25rem;border-right-width:4px;border-color:#86a8e7;}.css-xhvfnc:hover{background-color:#ddd;}</style><a rel="next" class="css-xhvfnc" href="/Configs/VSCode-Configuration/"><div class="css-v38or"><p class="css-2m7hin">Next Post</p><p>My VSCode editor settings in JSON format</p></div><div class="css-19o7xeo"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="css-11za1ik" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 0 0 0-48.4z"></path></svg></div></a></div></div><style data-emotion-css="14yohw7">.css-14yohw7{width:100%;max-width:768px;padding-left:1rem;padding-right:1rem;margin-left:auto;margin-right:auto;padding-top:2rem;margin-top:0.5rem;margin-bottom:1rem;}@media (min-width:768px){.css-14yohw7{padding-left:0;padding-right:0;padding-top:3rem;}}</style><div class="css-14yohw7 e16bs3iv0"><style data-emotion-css="180ky7f">.css-180ky7f{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:0.5rem;padding-right:0.5rem;}@media (min-width:768px){.css-180ky7f{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><div class="css-180ky7f e16bs3iv1"><style data-emotion-css="p5b1u1">.css-p5b1u1{border-radius:9999px;border-width:1px;--border-opacity:1;border-color:rgba(214,188,250,var(--border-opacity));margin-right:2rem;margin-bottom:0.5rem;}@media (min-width:768px){.css-p5b1u1{margin-bottom:1rem;}}</style><div class="css-p5b1u1 gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:128px;height:128px"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQBBf/EABYBAQEBAAAAAAAAAAAAAAAAAAECA//aAAwDAQACEAMQAAABynZIqtSk4c5qdwD/AP/EABgQAAMBAQAAAAAAAAAAAAAAAAABAgMR/9oACAEBAAEFApTIkuNHXZgjWK2bZvTM6b1P/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAEQEf/aAAgBAwEBPwFiK//EABURAQEAAAAAAAAAAAAAAAAAAAEg/9oACAECAQE/ASP/xAAdEAACAQQDAAAAAAAAAAAAAAAAASECEBFRIjGB/9oACAEBAAY/AvCZ2QoMsw5TOJ2Up7t//8QAHRAAAgICAwEAAAAAAAAAAAAAAAERIUFhMVFxkf/aAAgBAQABPyGQ1UIIVo1dtoaHoXgWF10MklGMEvhCEYta+DAJgvw//9oADAMBAAIAAwAAABBYODz/xAAYEQEBAQEBAAAAAAAAAAAAAAABABEhQf/aAAgBAwEBPxB279ksrt//xAAXEQEBAQEAAAAAAAAAAAAAAAABABAx/9oACAECAQE/EI9kM//EAB4QAQEAAgICAwAAAAAAAAAAAAERACFRYTFBoeHw/9oACAEBAAE/ENiSENW+VTiZpVWrCLvvKMeEnTGARaXZevjBBRTTtdPnjWuccCRSa1+JjqKA/TCoCwoW324ixDPbn//Z" alt="profileImg" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/584d7a912ca03da16698aea724815677/6dc0c/profile.jpg 1x,
/static/584d7a912ca03da16698aea724815677/cc017/profile.jpg 1.5x,
/static/584d7a912ca03da16698aea724815677/0c30b/profile.jpg 2x" /><img loading="lazy" width="128" height="128" srcset="/static/584d7a912ca03da16698aea724815677/6dc0c/profile.jpg 1x,
/static/584d7a912ca03da16698aea724815677/cc017/profile.jpg 1.5x,
/static/584d7a912ca03da16698aea724815677/0c30b/profile.jpg 2x" src="/static/584d7a912ca03da16698aea724815677/6dc0c/profile.jpg" alt="profileImg" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><div><span>Written by </span><style data-emotion-css="1t4jyca">.css-1t4jyca{display:inline-block;font-size:1.25rem;font-weight:700;border-radius:9999px;margin-bottom:0.5rem;padding-left:0.75rem;padding-right:0.75rem;--bg-opacity:1;background-color:rgba(237,242,247,var(--bg-opacity));color:#3737B9;}</style><p class="css-1t4jyca"><a class="author-name-content" href="/about"><span>@<!-- -->Young Jin Ahn</span></a></p><style data-emotion-css="vg2p6i">.css-vg2p6i{font-size:0.875rem;font-weight:400;margin-bottom:0.5rem;}</style><div class="css-vg2p6i">break, compose, display</div></div></div><style data-emotion-css="1air669">.css-1air669{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-left:0.5rem;margin-right:0.5rem;}</style><div class="css-1air669"><div class="css-yapsbb"></div></div><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><a title="github Link" href="https://github.com/snoop2head" class="css-1baulvz"><style data-emotion-css="vnd1fq">.css-vnd1fq{width:2rem;height:2rem;margin-top:1rem;margin-left:1rem;-webkit-transition:all 300ms cubic-bezier(0,0,0.2,1);transition:all 300ms cubic-bezier(0,0,0.2,1);color:#888;}.css-vnd1fq:hover{color:#000;}</style><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" class="css-vnd1fq" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a title="facebook Link" href="https://www.facebook.com/profile.php?id=100009133042568" class="css-1baulvz"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="css-vnd1fq" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"></path></svg></a></div><style data-emotion-css="18jj1tc">.css-18jj1tc{margin-top:1.25rem;margin-left:0.5rem;margin-right:0.5rem;}</style><div class="css-18jj1tc"><div class="utterances"></div></div></div></div><style data-emotion-css="xgi74q">.css-xgi74q{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:fixed;bottom:0;right:0;padding-right:1.5rem;padding-bottom:1.5rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}</style><div class="css-xgi74q e8huvi00"><style data-emotion-css="1a68u">.css-1a68u{box-shadow:0 2px 2px 0 rgba(0,0,0,0.15);-webkit-transition:all 300ms cubic-bezier(0.4,0,0.2,1);transition:all 300ms cubic-bezier(0.4,0,0.2,1);background-color:#FFFFFF;color:#636363;font-size:0.75rem;padding-left:0.5rem;padding-right:0.5rem;padding-top:0.5rem;padding-bottom:0.5rem;border-radius:9999px;--transform-translate-x:0;--transform-translate-y:0;--transform-rotate:0;--transform-skew-x:0;--transform-skew-y:0;--transform-scale-x:1;--transform-scale-y:1;-webkit-transform:translateX(var(--transform-translate-x)) translateY(var(--transform-translate-y)) rotate(var(--transform-rotate)) skewX(var(--transform-skew-x)) skewY(var(--transform-skew-y)) scaleX(var(--transform-scale-x)) scaleY(var(--transform-scale-y));-ms-transform:translateX(var(--transform-translate-x)) translateY(var(--transform-translate-y)) rotate(var(--transform-rotate)) skewX(var(--transform-skew-x)) skewY(var(--transform-skew-y)) scaleX(var(--transform-scale-x)) scaleY(var(--transform-scale-y));transform:translateX(var(--transform-translate-x)) translateY(var(--transform-translate-y)) rotate(var(--transform-rotate)) skewX(var(--transform-skew-x)) skewY(var(--transform-skew-y)) scaleX(var(--transform-scale-x)) scaleY(var(--transform-scale-y));cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-content:flex-end;-ms-flex-line-pack:end;align-content:flex-end;z-index:100;}.css-1a68u:hover{background-color:#404040;color:#FFFFFF;}.css-1a68u:hover{--transform-scale-x:1.05;--transform-scale-y:1.05;}</style><button title="change to darkmode" class="css-1a68u"><style data-emotion-css="1alqh2e">.css-1alqh2e{fill:currentColor;--text-opacity:1;color:rgba(246,224,94,var(--text-opacity));width:1rem;height:1rem;margin-top:auto;margin-bottom:auto;margin-left:0;margin-right:0;}@media (min-width:768px){.css-1alqh2e{display:inline-block;margin-left:0.25rem;margin-right:0.25rem;}}</style><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="css-1alqh2e" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg><style data-emotion-css="flxr9x">.css-flxr9x{display:none;margin-right:0;}@media (min-width:768px){.css-flxr9x{display:inline-block;margin-right:0.25rem;}}</style><span class="css-flxr9x">Use Dark Mode</span></button><style data-emotion-css="15afv4q">.css-15afv4q{box-shadow:0 2px 2px 0 rgba(0,0,0,0.15);-webkit-transition:all 300ms cubic-bezier(0.4,0,0.2,1);transition:all 300ms cubic-bezier(0.4,0,0.2,1);background-color:#FFFFFF;color:#636363;font-size:0.75rem;padding-left:0.5rem;padding-right:0.5rem;padding-top:0.5rem;padding-bottom:0.5rem;border-radius:9999px;--transform-translate-x:0;--transform-translate-y:0;--transform-rotate:0;--transform-skew-x:0;--transform-skew-y:0;--transform-scale-x:1;--transform-scale-y:1;-webkit-transform:translateX(var(--transform-translate-x)) translateY(var(--transform-translate-y)) rotate(var(--transform-rotate)) skewX(var(--transform-skew-x)) skewY(var(--transform-skew-y)) scaleX(var(--transform-scale-x)) scaleY(var(--transform-scale-y));-ms-transform:translateX(var(--transform-translate-x)) translateY(var(--transform-translate-y)) rotate(var(--transform-rotate)) skewX(var(--transform-skew-x)) skewY(var(--transform-skew-y)) scaleX(var(--transform-scale-x)) scaleY(var(--transform-scale-y));transform:translateX(var(--transform-translate-x)) translateY(var(--transform-translate-y)) rotate(var(--transform-rotate)) skewX(var(--transform-skew-x)) skewY(var(--transform-skew-y)) scaleX(var(--transform-scale-x)) scaleY(var(--transform-scale-y));cursor:pointer;margin-left:0.5rem;margin-top:auto;margin-bottom:auto;z-index:100;}.css-15afv4q:hover{background-color:#404040;color:#FFFFFF;}.css-15afv4q:hover{--transform-scale-x:1.05;--transform-scale-y:1.05;}</style><button title="top page" class="css-15afv4q"><style data-emotion-css="13htjwu">.css-13htjwu{width:1rem;height:1rem;}</style><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="css-13htjwu" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M868 545.5L536.1 163a31.96 31.96 0 0 0-48.3 0L156 545.5a7.97 7.97 0 0 0 6 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"></path></svg></button></div><style data-emotion-css="1k8xcyw">.css-1k8xcyw{text-align:center;padding-top:2rem;padding-bottom:2rem;bottom:0;}</style><footer class="css-1k8xcyw"><style data-emotion-css="1xju3od">.css-1xju3od{font-size:0.75rem;font-weight:700;}</style><a href="https://github.com/snoop2head" class="css-1xju3od">©snoop2head</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-186254784-2', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/DL&ML/Dacon-Stock-Price-Competition/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-efbe87ab08854460e1b4.js"],"app":["/app-6b37a0275bc86b56e034.js"],"component---src-pages-404-js":["/component---src-pages-404-js-23314e5a1122284127b1.js"],"component---src-pages-about-js":["/component---src-pages-about-js-3c0cba9242c81692c359.js"],"component---src-pages-index-js":["/component---src-pages-index-js-81659046284b3feb90f5.js"],"component---src-pages-search-js":["/component---src-pages-search-js-6bfc09fa0dcf8ea3b63d.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-5f317a7779dd1baa19f9.js"],"component---src-templates-category-js":["/component---src-templates-category-js-5fbfac713624a9c1ac35.js"]};/*]]>*/</script><script src="/polyfill-efbe87ab08854460e1b4.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-5f317a7779dd1baa19f9.js" async=""></script><script src="/7a297f752dcfe258c0b0106d89edb3a916af916e-d921dc7587d10ed55da7.js" async=""></script><script src="/b1bda0e5b3305dd279ac60c39e10b0f82af56c10-cca622a04473b7e5e8b2.js" async=""></script><script src="/commons-33df4d3f9aa201d0ec4c.js" async=""></script><script src="/1bfc9850-103202d7f810115a42e7.js" async=""></script><script src="/5e2a4920-da90abce4a08c86a094c.js" async=""></script><script src="/d7eeaac4-dcbe97e7a5aa158c9d08.js" async=""></script><script src="/app-6b37a0275bc86b56e034.js" async=""></script><script src="/dc6a8720040df98778fe970bf6c000a41750d3ae-4121d07143daec1f6e61.js" async=""></script><script src="/styles-e8fd4555a67a3390b64e.js" async=""></script><script src="/framework-c8d3a5345e3f321d7da5.js" async=""></script><script src="/webpack-runtime-a15e1610686fb2064048.js" async=""></script></body></html>