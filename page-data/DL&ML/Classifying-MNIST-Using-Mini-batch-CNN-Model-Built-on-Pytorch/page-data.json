{"componentChunkName":"component---src-templates-blog-post-js","path":"/DL&ML/Classifying-MNIST-Using-Mini-batch-CNN-Model-Built-on-Pytorch/","result":{"data":{"site":{"siteMetadata":{"author":"Young Jin Ahn","comment":{"utterances":"snoop2head/snoop2head.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"excerpt":"ðŸ”— Google Colab Notebook","html":"<p><a href=\"https://colab.research.google.com/github/snoop2head/DL-Study/blob/main/mnist_example.ipynb\">ðŸ”— Google Colab Notebook</a></p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> torch</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># import basic components</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> torch.nn </span><span class=\"mtk10 mtki\">as</span><span class=\"mtk1\"> nn</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># import functions</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> torch.nn.functional </span><span class=\"mtk10 mtki\">as</span><span class=\"mtk1\"> F</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># bring optimizers from torch</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> torch.optim </span><span class=\"mtk10 mtki\">as</span><span class=\"mtk1\"> optim</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># import dataset structuring and image transformation modules</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">from</span><span class=\"mtk1\"> torchvision </span><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> datasets, transforms</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">from</span><span class=\"mtk1\"> matplotlib </span><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> pyplot </span><span class=\"mtk10 mtki\">as</span><span class=\"mtk1\"> plt</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">%</span><span class=\"mtk1\">matplotlib inline </span><span class=\"mtk5 mtki\"># matplotlib config for jupyter notebook</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Setting device</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">is_cuda </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> torch.cuda.</span><span class=\"mtk3\">is_available</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">device </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> torch.</span><span class=\"mtk3\">device</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;cuda&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk10 mtki\">if</span><span class=\"mtk1\"> is_cuda </span><span class=\"mtk10 mtki\">else</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;cpu&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\"> (</span><span class=\"mtk6\">&#39;Current cuda device is&#39;</span><span class=\"mtk1\">, device)</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Current cuda device is cpu</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Hyperparameter Setting</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">MINI_BATCH_SIZE</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">50</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtki\"># numbers of images in a mini-batch</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">LEARNING_RATE</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">0.0001</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">EPOCHS</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">15</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Load dataset</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">train_data </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> datasets.</span><span class=\"mtk3\">MNIST</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">root</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;./data&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">train</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">True</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">download</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">False</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">transform</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> transforms.</span><span class=\"mtk3\">ToTensor</span><span class=\"mtk1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">test_data </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> datasets.</span><span class=\"mtk3\">MNIST</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">root</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;./data&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">train</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">False</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">transform</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> transforms.</span><span class=\"mtk3\">ToTensor</span><span class=\"mtk1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;number of training data: &#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">len</span><span class=\"mtk1\">(train_data))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;number of test data: &#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">len</span><span class=\"mtk1\">(test_data))</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">number of training data:  60000</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">number of test data:  10000</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># get image data and label</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">img_3d_channel, label </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> train_data[</span><span class=\"mtk7\">4</span><span class=\"mtk1\">]</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># show image from training data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">plt.</span><span class=\"mtk3\">imshow</span><span class=\"mtk1\">(img_3d_channel.</span><span class=\"mtk3\">squeeze</span><span class=\"mtk1\">().</span><span class=\"mtk3\">numpy</span><span class=\"mtk1\">(), </span><span class=\"mtk4 mtki\">cmap</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;gray&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">plt.</span><span class=\"mtk3\">title</span><span class=\"mtk1\">(</span><span class=\"mtk10\">f</span><span class=\"mtk6\">&#39;label is </span><span class=\"mtk7\">{</span><span class=\"mtk1\">label</span><span class=\"mtk7\">}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">plt.</span><span class=\"mtk3\">show</span><span class=\"mtk1\">()</span></span></span></code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 251px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.17928286852589%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACTUlEQVQ4y42VzaoaMRSAHZ3qVG2L9gdpFy21IiiXWsGC0CKlf9biRgQXVgRB7tauW7lrQR/AB3CnoBs3PoHgyhYRKi4EfQDxB+qdOT0JicS5Y3XgYzIx83lOTpIxmU5fEvIEuY/YEMc5L9xB3iBfkE/IZ8YHJI18Ry6Rb0jOYBxpf0WeixH8QeAI6n9+E7niUcrIkHXumICjsX5NkiSNPas6/rIxP7jQhfxmndfspT2C6Bg79u5PnvJjnXCfBsr2bZfLBQ6HQ5/mDSG5bhkJzWYzvUejUWi1WjAej6HX60GtVoNyuQx2u91QaEHuIr+MIgyFQrBYLGA4HEIqlaIicg0GA3A6nXxuD4QPkWdCUfYVTSQSMJ/PodPpgNvtpn31ep0K8/k8nxLDlG08ZRxAI0wmk7BaraDZbO6jzeVysFwuoVqtnpxDp17YaDRgMpmAz+ejona7Daqq0lQ9Ho9YsBvCR8hTnjIOoimXSiUazXQ6hX6/D91uF7bbLVQqlYOCHYtQ0VfZarVCLBaDeDxOJ59MwWazgXQ6rV9OR1M2rDKHiIgwEAicFJJTxC8IVXEdyrJM24VCAdbrNQSDwbMivH1qpxSLRRqh3+8/S6gc28t8H3u9Xm02m2nZbNZof+/Ew8GNvBAW9rXwz5qweDVS+dFopEUikYN+vdAsrkMDNPE5k8lAOBzmWw6EI4/cyzxlIo0ir5AQ8g55yYgjESzQBTudXyNBi8XyEe9vkQDyHokhD0ShTfgsyELbRc84STIpiuIU+u+h1MzaduYw/QOTV5u4sRlUbwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"output_5_0\"\n        title=\"output_5_0\"\n        src=\"/static/80e9292a9428a82bd713918b7d1f758f/26abe/output_5_0.png\"\n        srcset=\"/static/80e9292a9428a82bd713918b7d1f758f/26abe/output_5_0.png 251w\"\n        sizes=\"(max-width: 251px) 100vw, 251px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># (channel, height, width) = (1, 28, 28)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># channel is 1 because MNIST is grayscale image</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(img_3d_channel.shape)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># change (1, 28, 28) tensor to (28, 28) tensor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># (channel, height, width) -&gt; (height, width)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">img_2d_channel </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> img_3d_channel.</span><span class=\"mtk3\">squeeze</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># transform tensor format to numpy format</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">array_sample_image </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> img_2d_channel.</span><span class=\"mtk3\">numpy</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Check shape of the mnist image which is 28 x 28</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">array_sample_image.shape</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">torch.Size([1, 28, 28])</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">(28, 28)</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> numpy </span><span class=\"mtk10 mtki\">as</span><span class=\"mtk1\"> np</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># check distribution of values in numpy array</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk10\">f</span><span class=\"mtk6\">&quot;Min: </span><span class=\"mtk7\">{</span><span class=\"mtk1\">np.</span><span class=\"mtk3\">min</span><span class=\"mtk1\">(array_sample_image)</span><span class=\"mtk7\">}</span><span class=\"mtk6\">, Mean:</span><span class=\"mtk7\">{</span><span class=\"mtk1\">np.</span><span class=\"mtk3\">mean</span><span class=\"mtk1\">(array_sample_image)</span><span class=\"mtk7\">}</span><span class=\"mtk6\">, Max: </span><span class=\"mtk7\">{</span><span class=\"mtk1\">np.</span><span class=\"mtk3\">max</span><span class=\"mtk1\">(array_sample_image)</span><span class=\"mtk7\">}</span><span class=\"mtk6\">&quot;</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Min: 0.0, Mean:0.11611644923686981, Max: 1.0</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># show (maximum - minimum) values along an axis across an array.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># https://www.sharpsightlabs.com/blog/numpy-axes-explained/</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">COLUMN_AXIS</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">ROW_AXIS</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">range_pixels </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> np.</span><span class=\"mtk3\">ptp</span><span class=\"mtk1\">(array_image, </span><span class=\"mtk4 mtki\">axis</span><span class=\"mtk8\">=</span><span class=\"mtk7\">COLUMN_AXIS</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># sort range pixels array</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># https://rfriend.tistory.com/357</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(np.</span><span class=\"mtk3\">sort</span><span class=\"mtk1\">(range_pixels))</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">[0.         0.         0.         0.         0.         0.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"> 0.         0.         0.         0.         0.         0.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"> 0.         0.08627451 0.65882355 0.9882353  0.9882353  0.9882353</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"> 0.9882353  0.9882353  0.9882353  0.99215686 0.99215686 0.99215686</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"> 0.99215686 0.99215686 0.99215686 1.        ]</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># using torch dataloader to divide dataset into mini-batch</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># https://pytorch.org/docs/stable/data.html</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">train_loader </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> torch.utils.data.</span><span class=\"mtk3\">DataLoader</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4 mtki\">dataset</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> train_data,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4 mtki\">batch_size</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">MINI_BATCH_SIZE</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4 mtki\">shuffle</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">True</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">test_loader  </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> torch.utils.data.</span><span class=\"mtk3\">DataLoader</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4 mtki\">dataset</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> test_data,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4 mtki\">batch_size</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">MINI_BATCH_SIZE</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4 mtki\">shuffle</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">True</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">first_batch </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> train_loader.</span><span class=\"mtk8\">__iter__</span><span class=\"mtk1\">().</span><span class=\"mtk8\">__next__</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># 50 is mini-batch size</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;</span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;21s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;25s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk3\">format</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;name&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk6\">&#39;type&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk6\">&#39;size&#39;</span><span class=\"mtk1\">)) </span><span class=\"mtk5 mtki\"># 21s and 25s is character spaces of string</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;</span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;21s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;25s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk3\">format</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;Number of Mini-Batchs&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk6\">&#39;&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">len</span><span class=\"mtk1\">(train_loader)))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;</span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;21s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;25s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk3\">format</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;first_batch&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">str</span><span class=\"mtk1\">(</span><span class=\"mtk8\">type</span><span class=\"mtk1\">(first_batch)), </span><span class=\"mtk8\">len</span><span class=\"mtk1\">(first_batch)))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;</span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;21s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;25s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk3\">format</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;first_batch[0]&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">str</span><span class=\"mtk1\">(</span><span class=\"mtk8\">type</span><span class=\"mtk1\">(first_batch[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">])), first_batch[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].shape))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;</span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;21s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;25s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk3\">format</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;first_batch[1]&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">str</span><span class=\"mtk1\">(</span><span class=\"mtk8\">type</span><span class=\"mtk1\">(first_batch[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">])), first_batch[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">].shape))</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">name                  | type                      | size</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Number of Mini-Batchs |                           | 1200</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">first_batch           | &lt;class &#39;list&#39;&gt;            | 2</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">first_batch[0]        | &lt;class &#39;torch.Tensor&#39;&gt;    | torch.Size([50, 1, 28, 28])</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">first_batch[1]        | &lt;class &#39;torch.Tensor&#39;&gt;    | torch.Size([50])</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Basic Convolutional Neural Network (ConvolutionalNeuralNetwork) Class</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">class</span><span class=\"mtk1\"> </span><span class=\"mtk11\">ConvolutionalNeuralNetwork</span><span class=\"mtk1\">(</span><span class=\"mtk11\">nn</span><span class=\"mtk1\">.</span><span class=\"mtk11\">Module</span><span class=\"mtk1\">): </span><span class=\"mtk5 mtki\"># extending from nn.Module class</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">    Source: https://github.com/pytorch/examples/blob/master/mnist/main.py</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">    &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">def</span><span class=\"mtk1\"> </span><span class=\"mtk8\">__init__</span><span class=\"mtk1\">(</span><span class=\"mtk11 mtki\">self</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk6\">&quot;&quot;&quot; Configuration for the model &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># Initializing weights for the sake of weights&#39; randomness</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># https://stats.stackexchange.com/questions/45087/why-doesnt-backpropagation-work-when-you-initialize-the-weights-the-same-value</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">super</span><span class=\"mtk1\">(ConvolutionalNeuralNetwork, </span><span class=\"mtk11\">self</span><span class=\"mtk1\">).</span><span class=\"mtk8\">__init__</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># Convolutional Layer configuration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv1 </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">32</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">3</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv2 </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">32</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">64</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">3</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># Designating dropout configuration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.dropout1 </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">Dropout2d</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0.25</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.dropout2 </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">Dropout2d</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0.5</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># Fully Connected Layers configuration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.fc1 </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">Linear</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4 mtki\">in_features</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">9216</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4 mtki\">out_features</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">128</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.fc2 </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">Linear</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4 mtki\">in_features</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">128</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4 mtki\">out_features</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">10</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtki\"># MNIST labels 0 ~ 9</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">def</span><span class=\"mtk1\"> </span><span class=\"mtk3\">forward</span><span class=\"mtk1\">(</span><span class=\"mtk11 mtki\">self</span><span class=\"mtk1\">, </span><span class=\"mtk7 mtki\">x</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk6\">&quot;&quot;&quot; Forward pass of the model using predefined configuration settings on ConvolutionalNeuralNetwork &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># Stack Convolutional layers</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        x </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.</span><span class=\"mtk3\">conv1</span><span class=\"mtk1\">(x) </span><span class=\"mtk5 mtki\"># using class&#39; own function</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        x </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> F.</span><span class=\"mtk3\">relu</span><span class=\"mtk1\">(x) </span><span class=\"mtk5 mtki\"># using torch.nn.functional function</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        x </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.</span><span class=\"mtk3\">conv2</span><span class=\"mtk1\">(x)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        x </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> F.</span><span class=\"mtk3\">relu</span><span class=\"mtk1\">(x)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        x </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> F.</span><span class=\"mtk3\">max_pool2d</span><span class=\"mtk1\">(x, </span><span class=\"mtk7\">2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        x </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.</span><span class=\"mtk3\">dropout1</span><span class=\"mtk1\">(x)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># Flattens input by reshaping it into a one-dimensional tensor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        x </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> torch.</span><span class=\"mtk3\">flatten</span><span class=\"mtk1\">(x, </span><span class=\"mtk4 mtki\">start_dim</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1</span><span class=\"mtk1\">) </span><span class=\"mtk5 mtki\"># using torch&#39;s function: https://pytorch.org/docs/stable/generated/torch.flatten.html</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># Go through Fully Connected Layers</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        x </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.</span><span class=\"mtk3\">fc1</span><span class=\"mtk1\">(x)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        x </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> F.</span><span class=\"mtk3\">relu</span><span class=\"mtk1\">(x)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        x </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.</span><span class=\"mtk3\">dropout2</span><span class=\"mtk1\">(x)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        x </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.</span><span class=\"mtk3\">fc2</span><span class=\"mtk1\">(x)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        output </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> F.</span><span class=\"mtk3\">log_softmax</span><span class=\"mtk1\">(x, </span><span class=\"mtk4 mtki\">dim</span><span class=\"mtk8\">=</span><span class=\"mtk7\">1</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">return</span><span class=\"mtk1\"> output</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Creating Model instance with preconfigured class</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">model </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">ConvolutionalNeuralNetwork</span><span class=\"mtk1\">().</span><span class=\"mtk3\">to</span><span class=\"mtk1\">(device)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Defining optimizer</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">optimizer </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> optim.</span><span class=\"mtk3\">Adam</span><span class=\"mtk1\">(model.</span><span class=\"mtk3\">parameters</span><span class=\"mtk1\">(), </span><span class=\"mtk4 mtki\">lr</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">LEARNING_RATE</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Using Cross entropy loss function</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">criterion </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">CrossEntropyLoss</span><span class=\"mtk1\">()</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"18\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Print model&#39;s architecture</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(model)</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"19\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">ConvolutionalNeuralNetwork(</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  (conv1): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  (conv2): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  (dropout1): Dropout2d(p=0.25, inplace=False)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  (dropout2): Dropout2d(p=0.5, inplace=False)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  (fc1): Linear(in_features=9216, out_features=128, bias=True)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  (fc2): Linear(in_features=128, out_features=10, bias=True)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">)</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"20\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&quot;&quot;&quot; Training the model &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Change the model to training mode</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">model.</span><span class=\"mtk3\">train</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># A training step is one gradient update. In one step batch_size many examples are processed.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># training step = dataset size / mini-batch size</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># https://stackoverflow.com/questions/38340311/what-is-the-difference-between-steps-and-epochs-in-tensorflow</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">int_training_step </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Updating Gradient in each training steps</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">for</span><span class=\"mtk1\"> epoch </span><span class=\"mtk10\">in</span><span class=\"mtk1\"> </span><span class=\"mtk8\">range</span><span class=\"mtk1\">(</span><span class=\"mtk7\">EPOCHS</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10 mtki\">for</span><span class=\"mtk1\"> data, target_tensor </span><span class=\"mtk10\">in</span><span class=\"mtk1\"> train_loader: </span><span class=\"mtk5 mtki\"># bringing dataset from train_loader() function</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># data is [Batch Size = 50, Channel Size = 1, Height = 28, Width = 28] tensor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        data </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> data.</span><span class=\"mtk3\">to</span><span class=\"mtk1\">(device)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># Tagets is label [Labels = 50] tensor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        target_tensor </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> target_tensor.</span><span class=\"mtk3\">to</span><span class=\"mtk1\">(device)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># Gradient Descent process</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        optimizer.</span><span class=\"mtk3\">zero_grad</span><span class=\"mtk1\">() </span><span class=\"mtk5 mtki\"># initializing previously saved gradient&#39;s value to zero</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        output </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">model</span><span class=\"mtk1\">(data) </span><span class=\"mtk5 mtki\"># feed forward to get one-hot-encoded output probabilities</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        loss </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">criterion</span><span class=\"mtk1\">(output, target_tensor) </span><span class=\"mtk5 mtki\"># comparing prediction and ground truth to get loss</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        loss.</span><span class=\"mtk3\">backward</span><span class=\"mtk1\">() </span><span class=\"mtk5 mtki\"># backpropagating loss</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        optimizer.</span><span class=\"mtk3\">step</span><span class=\"mtk1\">() </span><span class=\"mtk5 mtki\"># updating weights with single optimization step</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># print status every 1000 training steps</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">if</span><span class=\"mtk1\"> int_training_step </span><span class=\"mtk8\">%</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1000</span><span class=\"mtk1\"> </span><span class=\"mtk8\">==</span><span class=\"mtk1\"> </span><span class=\"mtk7\">0</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            loss_rounded_to_3 </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">round</span><span class=\"mtk1\">(loss.</span><span class=\"mtk3\">item</span><span class=\"mtk1\">() </span><span class=\"mtk8\">*</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1000</span><span class=\"mtk1\">) </span><span class=\"mtk8\">/</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1000</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtki\"># loss is a single value, so we need to round it to 3 digits</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk10\">f</span><span class=\"mtk6\">&#39;Train Step: </span><span class=\"mtk7\">{</span><span class=\"mtk1\">int_training_step</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> </span><span class=\"mtk8\">\\t</span><span class=\"mtk6\"> Loss: </span><span class=\"mtk7\">{</span><span class=\"mtk1\">loss_rounded_to_3</span><span class=\"mtk7\">}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        int_training_step </span><span class=\"mtk8\">+=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"21\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 1000 \t Loss: 0.573</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 2000 \t Loss: 0.239</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 3000 \t Loss: 0.197</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 4000 \t Loss: 0.062</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 5000 \t Loss: 0.21</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 6000 \t Loss: 0.039</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 7000 \t Loss: 0.016</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 8000 \t Loss: 0.084</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 9000 \t Loss: 0.008</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 10000 \t Loss: 0.05</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 11000 \t Loss: 0.062</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 12000 \t Loss: 0.042</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 13000 \t Loss: 0.066</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 14000 \t Loss: 0.077</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 15000 \t Loss: 0.129</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 16000 \t Loss: 0.007</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 17000 \t Loss: 0.015</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 18000 \t Loss: 0.07</span></span></code></pre>\n<pre><code class=\"language-python\"></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"22\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&quot;&quot;&quot; Evaluating the model &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Switching to evaluation mode</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">model.</span><span class=\"mtk3\">eval</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">correct </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">for</span><span class=\"mtk1\"> data, target_labels </span><span class=\"mtk10\">in</span><span class=\"mtk1\"> test_loader:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5 mtki\"># data is [Batch Size = 50, Channel Size = 1, Height = 28, Width = 28] tensor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    data </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> data.</span><span class=\"mtk3\">to</span><span class=\"mtk1\">(device)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5 mtki\"># Tagets is label [Labels = 50] tensor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    target_labels </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> target_labels.</span><span class=\"mtk3\">to</span><span class=\"mtk1\">(device)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5 mtki\"># getting predicted output label out of maximum probabilities&#39; output in the tensor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    output </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">model</span><span class=\"mtk1\">(data)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    predicted_output_labels </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> output.data.</span><span class=\"mtk3\">max</span><span class=\"mtk1\">(</span><span class=\"mtk7\">1</span><span class=\"mtk1\">)[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5 mtki\"># add numbers of correct predictions</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    correct </span><span class=\"mtk8\">+=</span><span class=\"mtk1\"> predicted_output_labels.</span><span class=\"mtk3\">eq</span><span class=\"mtk1\">(target_labels.data).</span><span class=\"mtk3\">sum</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;Test set: Accuracy: </span><span class=\"mtk7\">{</span><span class=\"mtk10\">:.2f</span><span class=\"mtk7\">}</span><span class=\"mtk6\">%&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk3\">format</span><span class=\"mtk1\">(</span><span class=\"mtk7\">100</span><span class=\"mtk1\">. </span><span class=\"mtk8\">*</span><span class=\"mtk1\"> correct </span><span class=\"mtk8\">/</span><span class=\"mtk1\"> </span><span class=\"mtk8\">len</span><span class=\"mtk1\">(test_loader.dataset)))</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"23\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Test set: Accuracy: 98.91%</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"24\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">correct</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"25\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">tensor(9891)</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"26\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">prediction.</span><span class=\"mtk3\">eq</span><span class=\"mtk1\">(target.data)</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"27\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">tensor([True, True, True, True, True, True, True, True, True, True, True, True,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        True, True, True, True, True, True, True, True, True, True, True, True,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        True, True, True, True, True, True, True, True, True, True, True, True,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        True, True, True, True, True, True, True, True, True, True, True, True,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        True, True])</span></span></code></pre>\n<pre><code class=\"language-python\"></code></pre>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .one-dark-pro {\n    background-color: #282c34;\n    color: #abb2bf;\n  }\n  .one-dark-pro .mtki { font-style: italic; }\n  .one-dark-pro .mtk10 { color: #C678DD; }\n  .one-dark-pro .mtk1 { color: #ABB2BF; }\n  .one-dark-pro .mtk5 { color: #7F848E; }\n  .one-dark-pro .mtk8 { color: #56B6C2; }\n  .one-dark-pro .mtk3 { color: #61AFEF; }\n  .one-dark-pro .mtk6 { color: #98C379; }\n  .one-dark-pro .mtk7 { color: #D19A66; }\n  .one-dark-pro .mtk4 { color: #E06C75; }\n  .one-dark-pro .mtk11 { color: #E5C07B; }\n  .one-dark-pro .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","tableOfContents":"","frontmatter":{"date":"2021-08-11","title":"Classifying MNIST Using Mini-batch CNN Model Built on Pytorch","tags":["ComputerVision","Pytorch"]}}},"pageContext":{"slug":"/DL&ML/Classifying-MNIST-Using-Mini-batch-CNN-Model-Built-on-Pytorch/","previous":{"fields":{"slug":"/DL&ML/Deep-Learning-Concepts/"},"frontmatter":{"title":"Deep Learning Concepts"}},"next":{"fields":{"slug":"/Configs/Github-Authentication-Breaking-Change/"},"frontmatter":{"title":"Github-Authentication-Breaking-Change.md"}}}},"staticQueryHashes":["1081905842","3911196313"]}