{"componentChunkName":"component---src-templates-blog-post-js","path":"/Researching/Friendly-VGG-Implementation/","result":{"data":{"site":{"siteMetadata":{"author":"Young Jin Ahn","comment":{"utterances":"snoop2head/snoop2head.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"excerpt":"Personal Tips for Reading Paper Read Tables and Figures first: Most of the papers summarizes important findings on the tables and figures. Often times, most of the text on the papers are peripheral eâ€¦","html":"<h2 id=\"personal-tips-for-reading-paper\" style=\"position:relative;\"><a href=\"#personal-tips-for-reading-paper\" aria-label=\"personal tips for reading paper permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Personal Tips for Reading Paper</h2>\n<ul>\n<li><strong>Read Tables and Figures first</strong>: Most of the papers summarizes important findings on the tables and figures. Often times, most of the text on the papers are peripheral explication of such tables and figures.</li>\n<li><strong>Read Methodology or Architecture before the Introduction</strong>: introduction 1) is either relatively repetetive or 2) summary of preceding research.</li>\n<li><strong>Prior to reading the paper thoroughly, find which research are crucial to understand in the ongoing discourse in the Introduction part.</strong></li>\n</ul>\n<h2 id=\"personal-tips-for-implementing-papers-into-code\" style=\"position:relative;\"><a href=\"#personal-tips-for-implementing-papers-into-code\" aria-label=\"personal tips for implementing papers into code permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Personal Tips for Implementing Papers into Code</h2>\n<ul>\n<li><strong>Implement an experiment what seems to represent the novel findings of the paper.</strong> Implementing all of the experiments in the paper is nearly impossible without the help of the others.</li>\n<li><strong>Open-source the code if and only if the paper is already open to the public.</strong> Most of the code requires refactoring. Being aware of the audience, public code under the personal authorship is more likely to be proofreaded again even without feedbacks from the others.</li>\n<li><strong>Develop the official implementations or other people's implementations which are likely to be imperfect.</strong> Surprisingly, many of the official implementations lack details. This is probably because of lack of time for version management where private code remains covert.</li>\n</ul>\n<h2 id=\"review-on-very-deep-convolutional-networks-for-large-scale-image-recognition\" style=\"position:relative;\"><a href=\"#review-on-very-deep-convolutional-networks-for-large-scale-image-recognition\" aria-label=\"review on very deep convolutional networks for large scale image recognition permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Review on <a href=\"https://arxiv.org/pdf/1409.1556.pdf\">Very Deep Convolutional Networks for Large-Scale Image Recognition</a></h2>\n<p>Convolutional neural network's purpose is to extract representative features from the given input.</p>\n<p>Historically, simply stacking up multiple blocks of [3 x 3 convolution, activation, max-pooling] to achieve desired performance was gargantuan contribution.</p>\n<ol>\n<li><strong>Compared to prior neural networks, numbers of layers in VGG was considered to be \"very deep\".</strong> Convolutional layers + fully connected layers totaled 19 layers for VGG19. However, in the following year, numbers of layers shoots up to 152 layers in ResNet architecture.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0klEQVQoz02SW2/TQBBG+8+REC8gqBDlCcQDlIcC7Q9AwBNITSnhopI0cS4ktuM4cezYjhPi2x7G6zR0rd2xv/EefzPeA6WAMkOVBTcjCAIWiwXL5RLf9wnDkCiKiCTGcYzSm0CtV6heB+VORKv3H1TLh/MhPTOgLDImzow0TcnzXM/qPk0zsqyelabKUkNVnlHOLFQS7T+igQ9Puly0fRwv4f7rligFm3jJVl68Pao9GiSz1FHA+qpz1aKBT88Mml0fa77m3qvrqgdMLJso8Cm2CXHgSVe2O6jauZEoFamiuKXtHD45NfjW8bEr4MuWThyddvluBKhsg+NMKdONgOdsVyH5dk28XJCuY3GKdlu5UzfAo7OeOAxqoHYIj94YXA1C/jgrDt92tWZaU5JVQvp3je860vNct4eq9NpgDTw8ueay7WHPEu48/6UTD45/c9UP6FsRd1/U2uPjJr2xaCOPZ+9+aq31Y0wcbvbt0MBGs49puniez+fzNrmU17g0sO0Z06nHl0aHXHr4qTHEnkqvpyEfv8rfLVLeX5hYbvgfWJ2vQd9gPB4J0GNim6ykrMGgx8x1WcqZtMwRqyTBdSx5FqA5ptdtyVn1GQ8NifM98B+MiaPa+r90WQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20221004030750679\"\n        title=\"image-20221004030750679\"\n        src=\"/static/d6f6cb2e837b9faf23af74076f4de40d/c1b63/image-20221004030750679.png\"\n        srcset=\"/static/d6f6cb2e837b9faf23af74076f4de40d/5a46d/image-20221004030750679.png 300w,\n/static/d6f6cb2e837b9faf23af74076f4de40d/0a47e/image-20221004030750679.png 600w,\n/static/d6f6cb2e837b9faf23af74076f4de40d/c1b63/image-20221004030750679.png 1200w,\n/static/d6f6cb2e837b9faf23af74076f4de40d/d61c2/image-20221004030750679.png 1800w,\n/static/d6f6cb2e837b9faf23af74076f4de40d/3c2d4/image-20221004030750679.png 2092w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></li>\n<li>\n<p>Compared to GoogleNet, VGG's architecture was simple. Googlenet which acheived SOTA performance consisted of 1) inception modules and 2) intermediate classifier branches in the middle of the architecture.</p>\n<p>Inception modules illustrated below uses heterogeneous sizes of convolutional layers, ranging from 1x1 to 5x5, which are concatenated at the end.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACCklEQVQ4y21T2ZLaMBDk/78nP7B5DNSGbF7CesEcvm9bkmXLR2dGrFkgUdWUBDPT02q1V0VRQgiBvu9hjME8z5imCbySOEZVlvbM/y+5JcZxtMHnJbdyHAfrH2tst1vweWkWYYhot0Pw9hum6zFwI8X8CfawPsG4b1XXNX6+viIIAlRVhZnyNbHKfd/WFq4L0TRotUZDN1mgfM+D6x5xOBygaSAvy7CkZo+SbdsiiiJ0XQdNZ5mmME0NScA8ZCZ22fmM8uIhOgeI0hINkRFSom1KdKKwoKuGpidJAt4v1DAMg030NHW9/oUsr+1vHqCzDMFuj/MpQZS4wHjB1J2ROt+gitMVkK+cUjEz3ZFmfW+gpMDJi3D0MjhuaAtbyjPL1I8Rhjn84EhS+OhViPjjBUMvWEqsWDeXdGINGZyDV1kpFJVGGFfoyAGdUpB5jiYmdmGMoqwxkqBCSLp686WhokLWkG3DK88LSNlgGioE/jtNzqA1WUsqEr+DYn1JN1KVdFekub6B2Vf+enn22QQzTIhDB0a7GExE+x5augRq6LEUmADX8iNq/QhmGd4bdUlo3RIQXSXak/fMzW5LDYNxPINZwGf3s3FHEtd7f0MdfFgLta22zBiE9/8xu135/pO67uNVS/8A7/AHGVmFP8n7z+we7L73AfA5OQwGm80GLy/fbw/27/DpAYzjL//m7BG0y3GVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20221004032254634\"\n        title=\"image-20221004032254634\"\n        src=\"/static/e71e2007ca4b9a5602ab0af045b4c832/c1b63/image-20221004032254634.png\"\n        srcset=\"/static/e71e2007ca4b9a5602ab0af045b4c832/5a46d/image-20221004032254634.png 300w,\n/static/e71e2007ca4b9a5602ab0af045b4c832/0a47e/image-20221004032254634.png 600w,\n/static/e71e2007ca4b9a5602ab0af045b4c832/c1b63/image-20221004032254634.png 1200w,\n/static/e71e2007ca4b9a5602ab0af045b4c832/1d499/image-20221004032254634.png 1632w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Moreover, GoogleNet had intermediate auxiliary classifier, represented as the yellow block in the diagram below, used during the training. The architecture was computationally efficient but the structure was less intuitive.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA6ElEQVQY042P20rDUBBF8/9/0gdBRFQUfNGCMdWqTXpoY02bq03SNCUx95xl7IPgmwPDwGb22myFf0zbwVcFSS5Jh91EEuEkGFbGtdhzKw74tkWVblC6TlKUBVndUdUFwq1ZbiuWQcnuUDFzau7NnLNpyOl0y8lTyOjRZ2zYvGkrrjSPG83F9xzKH2C8q5kLnbGdoQ/3/C4YDC4Xz2smqsnoweFSdXk1XPRFxIsRINQZ84+GPDQHSEqV179tlD/d+hbXioicmHAIyuOUz3XIavKOHea0yfz41iR7vLilyDyQzVGTfY+Ukm89Kyp4/jNY1QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-20221004032046216\"\n        title=\"image-20221004032046216\"\n        src=\"/static/ac17bfafdd00df3ecc0ec4772e40d0ee/c1b63/image-20221004032046216.png\"\n        srcset=\"/static/ac17bfafdd00df3ecc0ec4772e40d0ee/5a46d/image-20221004032046216.png 300w,\n/static/ac17bfafdd00df3ecc0ec4772e40d0ee/0a47e/image-20221004032046216.png 600w,\n/static/ac17bfafdd00df3ecc0ec4772e40d0ee/c1b63/image-20221004032046216.png 1200w,\n/static/ac17bfafdd00df3ecc0ec4772e40d0ee/d61c2/image-20221004032046216.png 1800w,\n/static/ac17bfafdd00df3ecc0ec4772e40d0ee/97a96/image-20221004032046216.png 2400w,\n/static/ac17bfafdd00df3ecc0ec4772e40d0ee/3a4f1/image-20221004032046216.png 2588w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><strong>On the other hand, VGG is monotonous repetition of [3 x 3 convolution, activation, max-pooling] before the classifier.</strong></p>\n<p><img src=\"https://miro.medium.com/max/1400/1*NNifzsJ7tD2kAfBXt3AzEg.png\" alt=\"An overview of VGG16 and NiN models | by Khuyen Le | MLearning.ai | Medium\"></p>\n</li>\n</ol>\n<h2 id=\"implementing-vgg-on-imagenet-subset\" style=\"position:relative;\"><a href=\"#implementing-vgg-on-imagenet-subset\" aria-label=\"implementing vgg on imagenet subset permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Implementing VGG on ImageNet Subset</h2>\n<p>In order to replicate the experiment, <a href=\"https://huggingface.co/datasets/imagenet-1k\">ImageNet1K dataset</a> should be used. However, ImageNet training dataset takes up more than 130GB of storage which makes it a great benchmark to compare between the models but a bad testing bed for trial and errors.</p>\n<p>Thus for this blog post, 10 subset classes of ImageNet is used as the dataset. <a href=\"https://github.com/fastai/imagenette\">Imagenette Dataset by FastAI</a> allows us to test the models on easy classification task(Imagenette) and difficult classification task(imagewoof). Former one is classifying distinctive classes of objects/animals and the latter one is classifying species of dog.</p>\n<ol>\n<li>\n<p>3 x 3 convolution is relatively small-sized filter.</p>\n<ul>\n<li>Small is good enough</li>\n<li>Better to stack up 3 x (3 x 3) than 1 x (7 x 7)</li>\n</ul>\n</li>\n<li>Consequent max-pooling operations reduces resolution into half. e.g (224 x 224) -> (112 x 112)</li>\n</ol>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># unzip .tgz file</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Subset of ImageNet: 1000 class -&gt; 10 class and 130GB -&gt; 300MB: https://github.com/fastai/imagenette</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># !tar -xvzf /home/ubuntu/imagenet/imagenette2-320.tgz # easy classification task for 10 classes</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># !tar -xvzf /home/ubuntu/imagenet/imagewoof2-320.tgz # hard classification task for 10 classes</span></span></span></code></pre>\n<h3 id=\"trouble-encountered\" style=\"position:relative;\"><a href=\"#trouble-encountered\" aria-label=\"trouble encountered permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Trouble Encountered</h3>\n<ul>\n<li>\n<p>Implemented VGG16 underperforms torchvision vgg16</p>\n<ul>\n<li>Top1 Acc 44% vs 9.7%</li>\n<li>Loss 2.3 vs 6.8</li>\n</ul>\n</li>\n<li>Loss is reluctant to be updated as training progresses</li>\n</ul>\n<h3 id=\"adaptiveavgpool\" style=\"position:relative;\"><a href=\"#adaptiveavgpool\" aria-label=\"adaptiveavgpool permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AdaptiveAvgPool</h3>\n<ul>\n<li>Why is there AdaptiveAvgPool at the torchvision implementation whereas none-existent in paper?</li>\n</ul>\n<h3 id=\"weight-initialization\" style=\"position:relative;\"><a href=\"#weight-initialization\" aria-label=\"weight initialization permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Weight Initialization</h3>\n<ul>\n<li>Why initialization increases performance?</li>\n<li>Difference between each Weight Initialization methods</li>\n<li>\n<p>How to initialize weights in Pytorch</p>\n<ul>\n<li><a href=\"https://jh-bk.tistory.com/10\">Loss Intialization</a></li>\n<li><a href=\"https://pytorch.org/docs/stable/nn.init.html\">torch.nn.init documentation</a></li>\n<li><a href=\"https://wandb.ai/wandb_fc/tips/reports/How-to-Initialize-Weights-in-PyTorch--VmlldzoxNjcwOTg1\">How to Initialize Weights in PyTorch</a></li>\n</ul>\n</li>\n</ul>\n<p>-> Slight performance increase to 10%</p>\n<h3 id=\"batch-normalization\" style=\"position:relative;\"><a href=\"#batch-normalization\" aria-label=\"batch normalization permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Batch normalization</h3>\n<ul>\n<li>location of batch normalization?</li>\n<li>function of batch normalization?</li>\n<li>Why does batch normalization does not appear in torch summary?</li>\n<li>Why does batch normalization increase memory space of the model?</li>\n</ul>\n<p>-> Batch normalization didn't make any differences</p>\n<h3 id=\"weight-vs-bias\" style=\"position:relative;\"><a href=\"#weight-vs-bias\" aria-label=\"weight vs bias permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Weight vs Bias</h3>\n<ul>\n<li>Difference between weight and bias</li>\n</ul>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> torch</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> torch.nn </span><span class=\"mtk10 mtki\">as</span><span class=\"mtk1\"> nn </span><span class=\"mtk5 mtki\"># import basic components</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> torch.nn.functional </span><span class=\"mtk10 mtki\">as</span><span class=\"mtk1\"> F </span><span class=\"mtk5 mtki\"># import functions</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">from</span><span class=\"mtk1\"> torchsummary </span><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> summary</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># VGG16, Configuration D</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">class</span><span class=\"mtk1\"> </span><span class=\"mtk11\">VGG16</span><span class=\"mtk1\">(</span><span class=\"mtk11\">nn</span><span class=\"mtk1\">.</span><span class=\"mtk11\">Module</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">def</span><span class=\"mtk1\"> </span><span class=\"mtk8\">__init__</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11 mtki\">self</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7 mtki\">dropout_ratio</span><span class=\"mtk1\">=</span><span class=\"mtk7\">0.5</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7 mtki\">input_channels</span><span class=\"mtk1\">=</span><span class=\"mtk7\">3</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7 mtki\">input_resolution</span><span class=\"mtk1\">=</span><span class=\"mtk7\">224</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7 mtki\">num_classes</span><span class=\"mtk1\">=</span><span class=\"mtk7\">1000</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk6\">&quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">        VERY DEEP CONVOLUTIONAL NETWORKS FOR LARGE-SCALE IMAGE RECOGNITION</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">        https://arxiv.org/pdf/1409.1556.pdf</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">        - Implemented by @snoop2head and @lylajeon</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">        - Implementation of Table 1&#39;s ConvNet D Configuration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">        - Each of the layers&#39; output notated as channel@heightxwidth on the comments</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">        &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">super</span><span class=\"mtk1\">(</span><span class=\"mtk7\">VGG16</span><span class=\"mtk1\">, </span><span class=\"mtk11\">self</span><span class=\"mtk1\">).</span><span class=\"mtk8\">__init__</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.</span><span class=\"mtk3\">apply</span><span class=\"mtk1\">(</span><span class=\"mtk11\">self</span><span class=\"mtk1\">._initialize_weights)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># instantiate input variables as class attributes</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.dropout_ratio </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> dropout_ratio</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.input_channels </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> input_channels</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.input_resolution </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> input_resolution</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.num_classes </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> num_classes</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># convolutional layers configuration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> (</span><span class=\"mtk7\">3</span><span class=\"mtk1\">, </span><span class=\"mtk7\">3</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># max-pooling operations configuration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.pool_size </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> (</span><span class=\"mtk7\">2</span><span class=\"mtk1\">, </span><span class=\"mtk7\">2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.pool_stride </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">2</span><span class=\"mtk1\">  </span><span class=\"mtk5 mtki\"># max pooling halves the image&#39;s resolution</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.num_pooling </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">5</span><span class=\"mtk1\">  </span><span class=\"mtk5 mtki\"># number of max-pooling operations</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># fully-connected layers configuration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.final_conv_output_resolution </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.input_resolution </span><span class=\"mtk8\">//</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.pool_stride </span><span class=\"mtk8\">**</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.num_pooling</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.fc_size </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">4096</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv1 </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">Sequential</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.input_channels,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">64</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">padding</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),  </span><span class=\"mtk5 mtki\"># 64@224x224</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">64</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">64</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">padding</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),  </span><span class=\"mtk5 mtki\"># 64@224x224</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">MaxPool2d</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.pool_size, </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.pool_stride),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )  </span><span class=\"mtk5 mtki\"># 64@112x112</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv2 </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">Sequential</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">64</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">128</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">padding</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),  </span><span class=\"mtk5 mtki\"># 128@112x112</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">128</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">128</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">padding</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),  </span><span class=\"mtk5 mtki\"># 128@112x112</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">MaxPool2d</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.pool_size, </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.pool_stride),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )  </span><span class=\"mtk5 mtki\"># 128@56x56</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv3 </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">Sequential</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">128</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">256</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">padding</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),  </span><span class=\"mtk5 mtki\"># 256@56x56</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">256</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">256</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">padding</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),  </span><span class=\"mtk5 mtki\"># 256@56x56</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">256</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">256</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">padding</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),  </span><span class=\"mtk5 mtki\"># 256@56x56</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">MaxPool2d</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.pool_size, </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.pool_stride),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )  </span><span class=\"mtk5 mtki\"># 256@28x28</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv4 </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">Sequential</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">256</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">512</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">padding</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),  </span><span class=\"mtk5 mtki\"># 512@28x28</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">512</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">512</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">padding</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),  </span><span class=\"mtk5 mtki\"># 512@28x28</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">512</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">512</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">padding</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),  </span><span class=\"mtk5 mtki\"># 512@28x28</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">MaxPool2d</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.pool_size, </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.pool_stride),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )  </span><span class=\"mtk5 mtki\"># 512@14x14</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv5 </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">Sequential</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">512</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">512</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">padding</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),  </span><span class=\"mtk5 mtki\"># 512@14x14</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">512</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">512</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">padding</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),  </span><span class=\"mtk5 mtki\"># 512@14x14</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Conv2d</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">in_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">512</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">out_channels</span><span class=\"mtk8\">=</span><span class=\"mtk7\">512</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_size,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_stride,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4 mtki\">padding</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.conv_padding,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            ),  </span><span class=\"mtk5 mtki\"># 512@14x14</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">MaxPool2d</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">kernel_size</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.pool_size, </span><span class=\"mtk4 mtki\">stride</span><span class=\"mtk8\">=</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.pool_stride),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )  </span><span class=\"mtk5 mtki\"># 512@7x7</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># count number of nn.maxpool2d layers</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.fc_module </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">Sequential</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Linear</span><span class=\"mtk1\">(</span><span class=\"mtk7\">512</span><span class=\"mtk1\"> </span><span class=\"mtk8\">*</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.final_conv_output_resolution </span><span class=\"mtk8\">**</span><span class=\"mtk1\"> </span><span class=\"mtk7\">2</span><span class=\"mtk1\">, </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.fc_size),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Dropout</span><span class=\"mtk1\">(</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.dropout_ratio),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Linear</span><span class=\"mtk1\">(</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.fc_size, </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.fc_size),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Dropout</span><span class=\"mtk1\">(</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.dropout_ratio),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">ReLU</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.</span><span class=\"mtk3\">Linear</span><span class=\"mtk1\">(</span><span class=\"mtk11\">self</span><span class=\"mtk1\">.fc_size, </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.num_classes),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">def</span><span class=\"mtk1\"> </span><span class=\"mtk3\">forward</span><span class=\"mtk1\">(</span><span class=\"mtk11 mtki\">self</span><span class=\"mtk1\">, </span><span class=\"mtk7 mtki\">x</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># forward pass through convolutional layers</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        out </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.</span><span class=\"mtk3\">conv1</span><span class=\"mtk1\">(x)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        out </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.</span><span class=\"mtk3\">conv2</span><span class=\"mtk1\">(out)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        out </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.</span><span class=\"mtk3\">conv3</span><span class=\"mtk1\">(out)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        out </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.</span><span class=\"mtk3\">conv4</span><span class=\"mtk1\">(out)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        out </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.</span><span class=\"mtk3\">conv5</span><span class=\"mtk1\">(out)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># flatten the output</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        out </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> out.</span><span class=\"mtk3\">flatten</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">start_dim</span><span class=\"mtk8\">=</span><span class=\"mtk7\">1</span><span class=\"mtk1\">)  </span><span class=\"mtk5 mtki\"># assuming batch size is first dimension</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># forward pass through fully connected layers</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        out </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">self</span><span class=\"mtk1\">.</span><span class=\"mtk3\">fc_module</span><span class=\"mtk1\">(out)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># yield prediction probabilities for each class using softmax</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">return</span><span class=\"mtk1\"> F.</span><span class=\"mtk3\">softmax</span><span class=\"mtk1\">(out, </span><span class=\"mtk4 mtki\">dim</span><span class=\"mtk8\">=</span><span class=\"mtk7\">1</span><span class=\"mtk1\">)  </span><span class=\"mtk5 mtki\"># assuming batch size is first dimension</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">def</span><span class=\"mtk1\"> </span><span class=\"mtk3\">_initialize_weights</span><span class=\"mtk1\">(</span><span class=\"mtk11 mtki\">self</span><span class=\"mtk1\">, </span><span class=\"mtk7 mtki\">module</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">if</span><span class=\"mtk1\"> </span><span class=\"mtk8\">isinstance</span><span class=\"mtk1\">(module, nn.Conv2d):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.init.</span><span class=\"mtk3\">kaiming_normal_</span><span class=\"mtk1\">(module.weight, </span><span class=\"mtk4 mtki\">mode</span><span class=\"mtk8\">=</span><span class=\"mtk6\">&quot;fan_out&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">nonlinearity</span><span class=\"mtk8\">=</span><span class=\"mtk6\">&quot;relu&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10 mtki\">if</span><span class=\"mtk1\"> module.bias </span><span class=\"mtk10\">is</span><span class=\"mtk1\"> </span><span class=\"mtk10\">not</span><span class=\"mtk1\"> </span><span class=\"mtk7\">None</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                nn.init.</span><span class=\"mtk3\">constant_</span><span class=\"mtk1\">(module.bias, </span><span class=\"mtk7\">0</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">elif</span><span class=\"mtk1\"> </span><span class=\"mtk8\">isinstance</span><span class=\"mtk1\">(module, nn.Linear):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.init.</span><span class=\"mtk3\">normal_</span><span class=\"mtk1\">(module.weight, </span><span class=\"mtk7\">0</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.01</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            nn.init.</span><span class=\"mtk3\">constant_</span><span class=\"mtk1\">(module.bias, </span><span class=\"mtk7\">0</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">from</span><span class=\"mtk1\"> torchvision.models </span><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> vgg16</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Setting device</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">is_cuda </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> torch.cuda.</span><span class=\"mtk3\">is_available</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">device </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> torch.</span><span class=\"mtk3\">device</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;cuda:0&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk10 mtki\">if</span><span class=\"mtk1\"> is_cuda </span><span class=\"mtk10 mtki\">else</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;cpu&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\"> (</span><span class=\"mtk6\">&#39;Current cuda device is&#39;</span><span class=\"mtk1\">, device)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Both are VGG16, Configuration D</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">custom_vgg_model </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">VGG16</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">torch_vgg_model </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">vgg16</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">pretrained</span><span class=\"mtk8\">=</span><span class=\"mtk7\">False</span><span class=\"mtk1\">) </span><span class=\"mtk5 mtki\"># pretrained=False for random initialization</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;--------------------Custom VGG16--------------------&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk3\">summary</span><span class=\"mtk1\">(custom_vgg_model.</span><span class=\"mtk3\">to</span><span class=\"mtk1\">(device), (</span><span class=\"mtk7\">3</span><span class=\"mtk1\">, </span><span class=\"mtk7\">224</span><span class=\"mtk1\">, </span><span class=\"mtk7\">224</span><span class=\"mtk1\">)))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;--------------------Torch VGG16--------------------&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk3\">summary</span><span class=\"mtk1\">(torch_vgg_model.</span><span class=\"mtk3\">to</span><span class=\"mtk1\">(device), (</span><span class=\"mtk7\">3</span><span class=\"mtk1\">, </span><span class=\"mtk7\">224</span><span class=\"mtk1\">, </span><span class=\"mtk7\">224</span><span class=\"mtk1\">)))</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Current cuda device is cuda:0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">--------------------Custom VGG16--------------------</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">----------------------------------------------------------------</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        Layer (type)               Output Shape         Param #</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">================================================================</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            Conv2d-1         [-1, 64, 224, 224]           1,792</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">              ReLU-2         [-1, 64, 224, 224]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            Conv2d-3         [-1, 64, 224, 224]          36,928</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">              ReLU-4         [-1, 64, 224, 224]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">         MaxPool2d-5         [-1, 64, 112, 112]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            Conv2d-6        [-1, 128, 112, 112]          73,856</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">              ReLU-7        [-1, 128, 112, 112]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            Conv2d-8        [-1, 128, 112, 112]         147,584</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">              ReLU-9        [-1, 128, 112, 112]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        MaxPool2d-10          [-1, 128, 56, 56]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">           Conv2d-11          [-1, 256, 56, 56]         295,168</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">             ReLU-12          [-1, 256, 56, 56]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">           Conv2d-13          [-1, 256, 56, 56]         590,080</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">             ReLU-14          [-1, 256, 56, 56]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">           Conv2d-15          [-1, 256, 56, 56]         590,080</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">             ReLU-16          [-1, 256, 56, 56]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        MaxPool2d-17          [-1, 256, 28, 28]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">           Conv2d-18          [-1, 512, 28, 28]       1,180,160</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">             ReLU-19          [-1, 512, 28, 28]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">           Conv2d-20          [-1, 512, 28, 28]       2,359,808</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">             ReLU-21          [-1, 512, 28, 28]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">           Conv2d-22          [-1, 512, 28, 28]       2,359,808</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">             ReLU-23          [-1, 512, 28, 28]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        MaxPool2d-24          [-1, 512, 14, 14]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">           Conv2d-25          [-1, 512, 14, 14]       2,359,808</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">             ReLU-26          [-1, 512, 14, 14]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">           Conv2d-27          [-1, 512, 14, 14]       2,359,808</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">             ReLU-28          [-1, 512, 14, 14]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">           Conv2d-29          [-1, 512, 14, 14]       2,359,808</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">             ReLU-30          [-1, 512, 14, 14]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        MaxPool2d-31            [-1, 512, 7, 7]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">           Linear-32                 [-1, 4096]     102,764,544</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">          Dropout-33                 [-1, 4096]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">             ReLU-34                 [-1, 4096]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">           Linear-35                 [-1, 4096]      16,781,312</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">          Dropout-36                 [-1, 4096]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">             ReLU-37                 [-1, 4096]               0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">           Linear-38                 [-1, 1000]       4,097,000</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">================================================================</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Total params: 138,357,544</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Trainable params: 138,357,544</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Non-trainable params: 0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">----------------------------------------------------------------</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Input size (MB): 0.57</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Forward/backward pass size (MB): 218.59</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Params size (MB): 527.79</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Estimated Total Size (MB): 746.96</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">----------------------------------------------------------------</span></span></code></pre>\n<p>â€‹<br>\n--------------------Torch VGG16--------------------</p>\n<hr>\n<h1 id=\"layer-type-output-shape-param\" style=\"position:relative;\"><a href=\"#layer-type-output-shape-param\" aria-label=\"layer type output shape param permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Layer (type) Output Shape Param</h1>\n<p>Conv2d-1 [-1, 64, 224, 224] 1,792\nReLU-2 [-1, 64, 224, 224] 0\nConv2d-3 [-1, 64, 224, 224] 36,928\nReLU-4 [-1, 64, 224, 224] 0\nMaxPool2d-5 [-1, 64, 112, 112] 0\nConv2d-6 [-1, 128, 112, 112] 73,856\nReLU-7 [-1, 128, 112, 112] 0\nConv2d-8 [-1, 128, 112, 112] 147,584\nReLU-9 [-1, 128, 112, 112] 0\nMaxPool2d-10 [-1, 128, 56, 56] 0\nConv2d-11 [-1, 256, 56, 56] 295,168\nReLU-12 [-1, 256, 56, 56] 0\nConv2d-13 [-1, 256, 56, 56] 590,080\nReLU-14 [-1, 256, 56, 56] 0\nConv2d-15 [-1, 256, 56, 56] 590,080\nReLU-16 [-1, 256, 56, 56] 0\nMaxPool2d-17 [-1, 256, 28, 28] 0\nConv2d-18 [-1, 512, 28, 28] 1,180,160\nReLU-19 [-1, 512, 28, 28] 0\nConv2d-20 [-1, 512, 28, 28] 2,359,808\nReLU-21 [-1, 512, 28, 28] 0\nConv2d-22 [-1, 512, 28, 28] 2,359,808\nReLU-23 [-1, 512, 28, 28] 0\nMaxPool2d-24 [-1, 512, 14, 14] 0\nConv2d-25 [-1, 512, 14, 14] 2,359,808\nReLU-26 [-1, 512, 14, 14] 0\nConv2d-27 [-1, 512, 14, 14] 2,359,808\nReLU-28 [-1, 512, 14, 14] 0\nConv2d-29 [-1, 512, 14, 14] 2,359,808\nReLU-30 [-1, 512, 14, 14] 0\nMaxPool2d-31 [-1, 512, 7, 7] 0\nAdaptiveAvgPool2d-32 [-1, 512, 7, 7] 0\nLinear-33 [-1, 4096] 102,764,544\nReLU-34 [-1, 4096] 0\nDropout-35 [-1, 4096] 0\nLinear-36 [-1, 4096] 16,781,312\nReLU-37 [-1, 4096] 0\nDropout-38 [-1, 4096] 0\nLinear-39 [-1, 1000] 4,097,000\n================================================================\nTotal params: 138,357,544\nTrainable params: 138,357,544\nNon-trainable params: 0</p>\n<hr>\n<p>Input size (MB): 0.57\nForward/backward pass size (MB): 218.78\nParams size (MB): 527.79\nEstimated Total Size (MB): 747.15</p>\n<hr>\n<p>None</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">MINI_BATCH_SIZE</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">256</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtki\"># numbers of images in a mini-batch</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">VALID_BATCH_SIZE</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">64</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtki\"># numbers of images in a mini-batch</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">LEARNING_RATE</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1e-4</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">EPOCHS</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">100</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">RESOLUTION</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> (</span><span class=\"mtk7\">224</span><span class=\"mtk1\">, </span><span class=\"mtk7\">224</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># import dataset structuring and image transformation modules</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">from</span><span class=\"mtk1\"> torchvision.datasets </span><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> ImageFolder </span><span class=\"mtk5 mtki\"># Load dataset</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">from</span><span class=\"mtk1\"> torchvision </span><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> transforms</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">DATA_PATH</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;imagenette2-320&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">imagenet_transforms </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> transforms.</span><span class=\"mtk3\">Compose</span><span class=\"mtk1\">([</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    transforms.</span><span class=\"mtk3\">Resize</span><span class=\"mtk1\">(</span><span class=\"mtk7\">RESOLUTION</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    transforms.</span><span class=\"mtk3\">ToTensor</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    transforms.</span><span class=\"mtk3\">Normalize</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">mean</span><span class=\"mtk8\">=</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0.485</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.456</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.406</span><span class=\"mtk1\">], </span><span class=\"mtk4 mtki\">std</span><span class=\"mtk8\">=</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0.229</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.224</span><span class=\"mtk1\">, </span><span class=\"mtk7\">0.225</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">train_data </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">ImageFolder</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">root</span><span class=\"mtk8\">=</span><span class=\"mtk10\">f</span><span class=\"mtk6\">&#39;./</span><span class=\"mtk7\">{DATA_PATH}</span><span class=\"mtk6\">/train&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">transform</span><span class=\"mtk8\">=</span><span class=\"mtk1\">imagenet_transforms)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;number of training data: &#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">len</span><span class=\"mtk1\">(train_data))</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">number of training data:  9469</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">valid_data </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">ImageFolder</span><span class=\"mtk1\">(</span><span class=\"mtk4 mtki\">root</span><span class=\"mtk8\">=</span><span class=\"mtk10\">f</span><span class=\"mtk6\">&#39;./</span><span class=\"mtk7\">{DATA_PATH}</span><span class=\"mtk6\">/val&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk4 mtki\">transform</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> imagenet_transforms)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;number of test data: &#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">len</span><span class=\"mtk1\">(valid_data))</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">number of test data:  3925</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">sample_idx </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1001</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">sample_img, sample_label </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> train_data[sample_idx]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;sample image shape: &#39;</span><span class=\"mtk1\">, sample_img.</span><span class=\"mtk3\">size</span><span class=\"mtk1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;sample image label: &#39;</span><span class=\"mtk1\">, sample_label)</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sample image shape:  torch.Size([3, 224, 224])</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">sample image label:  1</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">from</span><span class=\"mtk1\"> matplotlib </span><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> pyplot </span><span class=\"mtk10 mtki\">as</span><span class=\"mtk1\"> plt</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># show image from training data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">plt.</span><span class=\"mtk3\">imshow</span><span class=\"mtk1\">(sample_img.</span><span class=\"mtk3\">numpy</span><span class=\"mtk1\">().</span><span class=\"mtk3\">transpose</span><span class=\"mtk1\">(</span><span class=\"mtk7\">1</span><span class=\"mtk1\">,</span><span class=\"mtk7\">2</span><span class=\"mtk1\">,</span><span class=\"mtk7\">0</span><span class=\"mtk1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">plt.</span><span class=\"mtk3\">title</span><span class=\"mtk1\">(</span><span class=\"mtk10\">f</span><span class=\"mtk6\">&#39;label is </span><span class=\"mtk7\">{</span><span class=\"mtk1\">sample_label</span><span class=\"mtk7\">}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">plt.</span><span class=\"mtk3\">show</span><span class=\"mtk1\">()</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).</span></span></code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 257px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 102.7237354085603%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFW0lEQVQ4y0WVeUxUVxSHz9tmH2DYZpxBGPZVhhnKIhVlZBAQi4oLAgFsQXFBLEZrrdZYSVxSaaUmbkgiBUvrvktLq0ldusbqn7VNW1pbWyVGCMwMznBP79zB9ibnnfPuu/d7v3PeuXkAdEzJ04H1YhKYTtgg8iIPmV8kQUyXFUzbZL7HCmomagHUfBNCm6cX9uJaKLmvgdrrtdD0fQ7UD2RC8icG33qQgi2BEZbuVLvxkMUR8aFYmH46zhH1rsURtU9pt+yOqgqrD1sf/rr0auyWyCrb8fzFbe7js1v/qnTYr6od5cdfcSy7YClc3JdenNQZEQzyDfSVxZCbeD1yIuNeGZpvxWDM7WhMvJGClv4UDO0KxPhLUd78B3FY/EcVJhyowIzaY1h68BqmHm3Akl9LsOZxIc67G4+GUzCHClQFqStghnVA50z91ojGrw0T+v5oEnYlnOTdiydpl7NIRNc01PVoMH3vHAIQT81IZpX3EUnZTjT1dmLqM3gCP5Ihvx8cFGjnuDbInDYQ5NKfl6F8P0wEHuQI1PMkoEtLEu4kkcSbcUTKV1AQT3gOqAeyZPUlYoyppnEQgRjRA2sApRquCFixG/hC6STvFPo4jO9QkPRdKtSuDMfk0yloPRuPUiUgL3BI1yIvCswvrNuJ0WmLfDHhgPdCHiBXC0UwFSNBWCJkyTo5p7JXjrMGY4l+ZwDOPJOPzbeqsPOHDgS1jEGApwZ+sC50KsplCuSAKfbyNgHFLTxTGASJkA8rwMlv5TH0lJrEn4vDqP4IXHp3Bm4/VuFXxvlBwCmZ5yQd9UwtAwrZEspr1EWg3qEFyS6zSjNFN1fOodDIEfU7KpT2hWNiTzYWNub5Afxkyhwwv6ejD1e17mJAHjgvBNK9xXKmMFowQIG8VO+UWuVYeKOaVLSvwRBrKnK6BJRUZr+yyVR5XsQVm3uxZ2AML9wZQnNCGlMoRggYsFFWBGW4CUQQbFAB7vL+Wpy7qIFIoJiE+I2jqkSRZ/G8eYuwt/sKisaVOL3kPZy/YKkfaOFRuUcqAg4kM61ijmq+yZ1ZuOFFTegHoIo4niryQX0wf+3OX/oOW6paWWyOzsWq2q0MGLtAi0n7VL6U1RwFWukJdLONrM+4/5T5fEFJEza1tGFNUwuWLOvC2aU72XxYRDY2busj+iS911adimAEVsMYannUXJMA8n+6gRiX6sCHT56jbzx1TeCqd3oxxJyDSm0A5tjtWLpuOcltTPHmrQvB5LV+IBXEZdCrexJEeN7fvPbi13B4FNEzQXDwyTgOO5/j4IgL3z93A7/66Qnef3AZGzYYyexKnbfmDROu3JHLgCZB0uSqAk3uyVQJL/iBZQtrmDL3uAcpk41Hwx7824n4cBjx2cPreKQ7h7x99GVve89cbDu0yQdU8RwPNm2YwaUJZS0yIQgCO6/rN+/1YYjX6yWPn42x+Ld/RsjvQy4WbzuxheRsNJDKWwWe+vsJWHc7nymM08zi7epMcMnUISgq5KyGQcF6/PPREFM1NDaKTq+HxSOjY/hgcBQP//wxBp+KQtOhEAzo0ExEnlVh9k169KLm5IB1TWWaYlqAGyTauEqRqaxb/RZLcsw1jiPjY96DX3aTk9eu4Tc/PiWHz3zuDV1mRnG7gPL1AlE3B7jNHelo6IwrgtS8hRCTURCmnqrPAi2k8RoxmQKLquqWT7/66WfJ+z84YG1Z11ymtOlyIUSV3Ly9PXt6YcFcusbGJfEpQoKYReNy5UzVS5UX31TD5FD+glSYhnaiSgSFUqH1/TuOdHYC+uYBwqiJEKJ5cR/KdsWyqyAAbwjqmgIzd1fDv8uVfsXn1i89AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"output_8_1\"\n        title=\"output_8_1\"\n        src=\"/static/af4e3cb524c3d3840498a3d4e936c8b7/96e35/output_8_1.png\"\n        srcset=\"/static/af4e3cb524c3d3840498a3d4e936c8b7/96e35/output_8_1.png 257w\"\n        sizes=\"(max-width: 257px) 100vw, 257px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># using torch dataloader to divide dataset into mini-batch</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># https://pytorch.org/docs/stable/data.html</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">train_loader </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> torch.utils.data.</span><span class=\"mtk3\">DataLoader</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4 mtki\">dataset</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> train_data,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4 mtki\">batch_size</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">MINI_BATCH_SIZE</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4 mtki\">shuffle</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">True</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">eval_loader  </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> torch.utils.data.</span><span class=\"mtk3\">DataLoader</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4 mtki\">dataset</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> valid_data,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4 mtki\">batch_size</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">VALID_BATCH_SIZE</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4 mtki\">shuffle</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">True</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">first_batch </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> train_loader.</span><span class=\"mtk8\">__iter__</span><span class=\"mtk1\">().</span><span class=\"mtk8\">__next__</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;</span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;21s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;25s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk3\">format</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;name&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk6\">&#39;type&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk6\">&#39;size&#39;</span><span class=\"mtk1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;</span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;21s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;25s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk3\">format</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;Number of Mini-Batchs&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk6\">&#39;&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">len</span><span class=\"mtk1\">(train_loader)))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;</span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;21s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;25s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk3\">format</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;first_batch&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">str</span><span class=\"mtk1\">(</span><span class=\"mtk8\">type</span><span class=\"mtk1\">(first_batch)), </span><span class=\"mtk8\">len</span><span class=\"mtk1\">(first_batch)))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;</span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;21s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;25s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk3\">format</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;first_batch[0]&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">str</span><span class=\"mtk1\">(</span><span class=\"mtk8\">type</span><span class=\"mtk1\">(first_batch[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">])), first_batch[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].shape))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;</span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;21s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{</span><span class=\"mtk10\">:&lt;25s</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> | </span><span class=\"mtk7\">{}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk3\">format</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;first_batch[1]&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">str</span><span class=\"mtk1\">(</span><span class=\"mtk8\">type</span><span class=\"mtk1\">(first_batch[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">])), first_batch[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">].shape))</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">name                  | type                      | size</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Number of Mini-Batchs |                           | 37</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">first_batch           | &lt;class &#39;list&#39;&gt;            | 2</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">first_batch[0]        | &lt;class &#39;torch.Tensor&#39;&gt;    | torch.Size([256, 3, 224, 224])</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">first_batch[1]        | &lt;class &#39;torch.Tensor&#39;&gt;    | torch.Size([256])</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># bring optimizers from torch</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> torch.optim </span><span class=\"mtk10 mtki\">as</span><span class=\"mtk1\"> optim</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Hyperparameter Setting</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">model </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> custom_vgg_model.</span><span class=\"mtk3\">to</span><span class=\"mtk1\">(device)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Defining optimizer</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">optimizer </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> optim.</span><span class=\"mtk3\">Adam</span><span class=\"mtk1\">(model.</span><span class=\"mtk3\">parameters</span><span class=\"mtk1\">(), </span><span class=\"mtk4 mtki\">lr</span><span class=\"mtk1\"> </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">LEARNING_RATE</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Using Cross entropy loss function</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">criterion </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> nn.</span><span class=\"mtk3\">CrossEntropyLoss</span><span class=\"mtk1\">()</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Print model&#39;s architecture</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(model)</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">VGG16(</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  (conv1): Sequential(</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (1): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (3): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (4): MaxPool2d(kernel_size=(2, 2), stride=2, padding=0, dilation=1, ceil_mode=False)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  )</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  (conv2): Sequential(</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (0): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (1): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (3): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (4): MaxPool2d(kernel_size=(2, 2), stride=2, padding=0, dilation=1, ceil_mode=False)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  )</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  (conv3): Sequential(</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (0): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (1): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (3): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (5): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (6): MaxPool2d(kernel_size=(2, 2), stride=2, padding=0, dilation=1, ceil_mode=False)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  )</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  (conv4): Sequential(</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (0): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (1): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (3): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (4): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (5): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (6): MaxPool2d(kernel_size=(2, 2), stride=2, padding=0, dilation=1, ceil_mode=False)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  )</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  (conv5): Sequential(</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (1): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (3): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (4): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (5): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (6): MaxPool2d(kernel_size=(2, 2), stride=2, padding=0, dilation=1, ceil_mode=False)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  )</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  (fc_module): Sequential(</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (0): Linear(in_features=25088, out_features=4096, bias=True)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (1): Dropout(p=0.5, inplace=False)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (2): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (3): Linear(in_features=4096, out_features=4096, bias=True)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (4): Dropout(p=0.5, inplace=False)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (5): ReLU()</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (6): Linear(in_features=4096, out_features=1000, bias=True)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  )</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">)</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"18\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">from</span><span class=\"mtk1\"> tqdm </span><span class=\"mtk10 mtki\">import</span><span class=\"mtk1\"> tqdm</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&quot;&quot;&quot; Training the model &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Change the model to training mode</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">model.</span><span class=\"mtk3\">train</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># A training step is one gradient update. In one step batch_size many examples are processed.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># training step = dataset size / mini-batch size</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># https://stackoverflow.com/questions/38340311/what-is-the-difference-between-steps-and-epochs-in-tensorflow</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Updating Gradient in each training steps</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">for</span><span class=\"mtk1\"> epoch </span><span class=\"mtk10\">in</span><span class=\"mtk1\"> </span><span class=\"mtk8\">range</span><span class=\"mtk1\">(</span><span class=\"mtk7\">EPOCHS</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10 mtki\">for</span><span class=\"mtk1\"> training_step, (data, target_tensor) </span><span class=\"mtk10\">in</span><span class=\"mtk1\"> </span><span class=\"mtk8\">enumerate</span><span class=\"mtk1\">(</span><span class=\"mtk3\">tqdm</span><span class=\"mtk1\">(train_loader)): </span><span class=\"mtk5 mtki\"># bringing dataset from train_loader() function</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># data is [Batch Size = 50, Channel Size = 1, Height = 28, Width = 28] tensor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        data </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> data.</span><span class=\"mtk3\">to</span><span class=\"mtk1\">(device)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># Tagets is label [Labels = 50] tensor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        target_tensor </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> target_tensor.</span><span class=\"mtk3\">to</span><span class=\"mtk1\">(device)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># Gradient Descent process</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        optimizer.</span><span class=\"mtk3\">zero_grad</span><span class=\"mtk1\">() </span><span class=\"mtk5 mtki\"># initializing previously saved gradient&#39;s value to zero # https://jaeyung1001.tistory.com/115</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        output </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">model</span><span class=\"mtk1\">(data) </span><span class=\"mtk5 mtki\"># feed forward to get one-hot-encoded output probabilities</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        loss </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">criterion</span><span class=\"mtk1\">(output, target_tensor) </span><span class=\"mtk5 mtki\"># comparing prediction and ground truth to get loss</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        loss.</span><span class=\"mtk3\">backward</span><span class=\"mtk1\">() </span><span class=\"mtk5 mtki\"># backpropagating loss</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        optimizer.</span><span class=\"mtk3\">step</span><span class=\"mtk1\">() </span><span class=\"mtk5 mtki\"># updating weights with single optimization step</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5 mtki\"># print status every 1000 training steps</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">if</span><span class=\"mtk1\"> training_step </span><span class=\"mtk8\">%</span><span class=\"mtk1\"> </span><span class=\"mtk7\">500</span><span class=\"mtk1\"> </span><span class=\"mtk8\">==</span><span class=\"mtk1\"> </span><span class=\"mtk7\">0</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            loss_rounded_to_3 </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk8\">round</span><span class=\"mtk1\">(loss.</span><span class=\"mtk3\">item</span><span class=\"mtk1\">() </span><span class=\"mtk8\">*</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1000</span><span class=\"mtk1\">) </span><span class=\"mtk8\">/</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1000</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtki\"># loss is a single value, so we need to round it to 3 digits</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk10\">f</span><span class=\"mtk6\">&#39;Train Step: </span><span class=\"mtk7\">{</span><span class=\"mtk1\">training_step</span><span class=\"mtk7\">}</span><span class=\"mtk6\"> </span><span class=\"mtk8\">\\t</span><span class=\"mtk6\"> Loss: </span><span class=\"mtk7\">{</span><span class=\"mtk1\">loss_rounded_to_3</span><span class=\"mtk7\">}</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"19\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">  3%|â–Ž         | 1/37 [00:03&lt;01:49,  3.03s/it]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 0 \t Loss: 6.908</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:56&lt;00:00,  1.53s/it]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  3%|â–Ž         | 1/37 [00:02&lt;01:26,  2.40s/it]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 0 \t Loss: 6.792</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:53&lt;00:00,  1.46s/it]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  3%|â–Ž         | 1/37 [00:02&lt;01:29,  2.50s/it]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 0 \t Loss: 6.8</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:53&lt;00:00,  1.45s/it]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  3%|â–Ž         | 1/37 [00:02&lt;01:29,  2.48s/it]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Train Step: 0 \t Loss: 6.773</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"> 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 29/37 [00:42&lt;00:11,  1.44s/it]</span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"python\" data-index=\"20\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&quot;&quot;&quot; Evaluating the model &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5 mtki\"># Switching to evaluation mode</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">model.</span><span class=\"mtk3\">eval</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">correct </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10 mtki\">for</span><span class=\"mtk1\"> data, target_labels </span><span class=\"mtk10\">in</span><span class=\"mtk1\"> </span><span class=\"mtk3\">tqdm</span><span class=\"mtk1\">(eval_loader):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5 mtki\"># data is [Batch Size = 50, Channel Size = 1, Height = 28, Width = 28] tensor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    data </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> data.</span><span class=\"mtk3\">to</span><span class=\"mtk1\">(device)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5 mtki\"># Tagets is label [Labels = 50] tensor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    target_labels </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> target_labels.</span><span class=\"mtk3\">to</span><span class=\"mtk1\">(device)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5 mtki\"># getting predicted output label out of maximum probabilities&#39; output in the tensor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    output </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> </span><span class=\"mtk3\">model</span><span class=\"mtk1\">(data)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    predicted_output_labels </span><span class=\"mtk8\">=</span><span class=\"mtk1\"> output.data.</span><span class=\"mtk3\">max</span><span class=\"mtk1\">(</span><span class=\"mtk7\">1</span><span class=\"mtk1\">)[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5 mtki\"># add numbers of correct predictions</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    correct </span><span class=\"mtk8\">+=</span><span class=\"mtk1\"> predicted_output_labels.</span><span class=\"mtk3\">eq</span><span class=\"mtk1\">(target_labels.data).</span><span class=\"mtk3\">sum</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">print</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;Test set: Accuracy: </span><span class=\"mtk7\">{</span><span class=\"mtk10\">:.2f</span><span class=\"mtk7\">}</span><span class=\"mtk6\">%&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk3\">format</span><span class=\"mtk1\">(</span><span class=\"mtk7\">100</span><span class=\"mtk1\">. </span><span class=\"mtk8\">*</span><span class=\"mtk1\"> correct </span><span class=\"mtk8\">/</span><span class=\"mtk1\"> </span><span class=\"mtk8\">len</span><span class=\"mtk1\">(eval_loader.dataset)))</span></span></span></code></pre>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"\" data-index=\"21\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 62/62 [00:21&lt;00:00,  2.84it/s]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Test set: Accuracy: 9.91%</span></span></code></pre>\n<h3 id=\"references\" style=\"position:relative;\"><a href=\"#references\" aria-label=\"references permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>References</h3>\n<p><a href=\"https://www.geeksforgeeks.org/understanding-googlenet-model-cnn-architecture/\">https://www.geeksforgeeks.org/understanding-googlenet-model-cnn-architecture/</a></p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .one-dark-pro {\n    background-color: #282c34;\n    color: #abb2bf;\n  }\n  .one-dark-pro .mtki { font-style: italic; }\n  .one-dark-pro .mtk5 { color: #7F848E; }\n  .one-dark-pro .mtk10 { color: #C678DD; }\n  .one-dark-pro .mtk1 { color: #ABB2BF; }\n  .one-dark-pro .mtk11 { color: #E5C07B; }\n  .one-dark-pro .mtk8 { color: #56B6C2; }\n  .one-dark-pro .mtk7 { color: #D19A66; }\n  .one-dark-pro .mtk6 { color: #98C379; }\n  .one-dark-pro .mtk3 { color: #61AFEF; }\n  .one-dark-pro .mtk4 { color: #E06C75; }\n  .one-dark-pro .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","tableOfContents":"<ul>\n<li>\n<ul>\n<li><a href=\"/Researching/Friendly-VGG-Implementation/#personal-tips-for-reading-paper\">Personal Tips for Reading Paper</a></li>\n<li><a href=\"/Researching/Friendly-VGG-Implementation/#personal-tips-for-implementing-papers-into-code\">Personal Tips for Implementing Papers into Code</a></li>\n<li><a href=\"/Researching/Friendly-VGG-Implementation/#review-on-very-deep-convolutional-networks-for-large-scale-image-recognition\">Review on Very Deep Convolutional Networks for Large-Scale Image Recognition</a></li>\n<li>\n<p><a href=\"/Researching/Friendly-VGG-Implementation/#implementing-vgg-on-imagenet-subset\">Implementing VGG on ImageNet Subset</a></p>\n<ul>\n<li><a href=\"/Researching/Friendly-VGG-Implementation/#trouble-encountered\">Trouble Encountered</a></li>\n<li><a href=\"/Researching/Friendly-VGG-Implementation/#adaptiveavgpool\">AdaptiveAvgPool</a></li>\n<li><a href=\"/Researching/Friendly-VGG-Implementation/#weight-initialization\">Weight Initialization</a></li>\n<li><a href=\"/Researching/Friendly-VGG-Implementation/#batch-normalization\">Batch normalization</a></li>\n<li><a href=\"/Researching/Friendly-VGG-Implementation/#weight-vs-bias\">Weight vs Bias</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/Researching/Friendly-VGG-Implementation/#layer-type-output-shape-param\">Layer (type) Output Shape Param</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/Researching/Friendly-VGG-Implementation/#references\">References</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","frontmatter":{"date":"2022-10-03","title":"VGG Implementation with Trial and Error","tags":["ComputerVision","Pytorch","VGG"]}}},"pageContext":{"slug":"/Researching/Friendly-VGG-Implementation/","previous":{"fields":{"slug":"/Researching/Python-language-structure/"},"frontmatter":{"title":"Python Language Structure"}},"next":null}},"staticQueryHashes":["1081905842","3911196313"]}